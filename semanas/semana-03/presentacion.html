<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Protocolos y Formatos en Sistemas Distribuidos</title>
    <link rel="icon"
        href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>‚óâ</text></svg>">
    <link rel="stylesheet" href="css/presentacion.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js"></script>
    <script>
        mermaid.initialize({
            startOnLoad: false, theme: 'dark', securityLevel: 'loose',
            themeVariables: {
                darkMode: true, primaryColor: '#E9AB21', primaryTextColor: '#ffffff',
                primaryBorderColor: '#ffffff', lineColor: '#ffffff', secondaryColor: '#23356E',
                tertiaryColor: '#910048', background: '#0f1419', mainBkg: '#0f1419', secondBkg: '#1a1f2e'
            },
            flowchart: { useMaxWidth: true, htmlLabels: false, curve: 'basis' }
        });
    </script>

    <!-- Prism.js para Syntax Highlighting -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-javascript.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-protobuf.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-json.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-bash.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-xml-doc.min.js"></script>
    <script
        src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/line-numbers/prism-line-numbers.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/toolbar/prism-toolbar.min.js"></script>
    <script
        src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/copy-to-clipboard/prism-copy-to-clipboard.min.js"></script>
    <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/toolbar/prism-toolbar.min.css">
    <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/line-numbers/prism-line-numbers.min.css">
</head>

<body>
    <div class="uide-logo">
        <img src="../../Logo%20UIDE.png" alt="UIDE Logo">
    </div>
    <div class="presentation-container">
        <!-- Slide 1: Title -->
        <div class="slide active title-slide">
            <div style="text-align: center; margin-bottom: 2rem;">
                <h3 style="color: #e2e8f0; font-size: 1.3rem; font-weight: 700; margin-bottom: 1rem;">
                    Presentaci√≥n Semana 3
                </h3>
                <h2 style="color: var(--uide-accent); font-size: 2.2rem; font-weight: 600; margin-bottom: 0.5rem;">
                    Protocolos y Formatos en Sistemas Distribuidos
                </h2>
                <p style="color: #ffffff; font-size: 1.4rem; font-weight: 500;">
                    LTI_05A_458 PMSBD ‚Ä¢ Cuarto Nivel
                </p>
                <p style="color: #e2e8f0; font-size: 1.2rem; margin-top: 0.5rem;">
                    Programaci√≥n Middleware y Sistemas Basados en Datos
                </p>
            </div>
            <div style="text-align: center; margin: 2rem 0;">
                <p style="color: #ffffff; font-size: 1.3rem; font-weight: 600;">
                    Mgs. Charlie C√°rdenas Toledo
                </p>
                <p style="color: var(--uide-primary); font-size: 1.2rem; font-weight: 500; margin-top: 0.5rem;">
                    Universidad Internacional del Ecuador ‚Ä¢ Octubre 2025 ‚Äì Febrero 2026
                </p>
            </div>
            <div
                style="text-align: center; margin-top: 2.5rem; padding: 25px; background: rgba(15, 20, 25, 0.6); border-radius: 15px; border: 1px solid rgba(255, 255, 255, 0.1);">
                <h3 style="color: var(--uide-accent); font-size: 1.4rem; margin-bottom: 1rem;">
                    <i class="fas fa-network-wired"></i> Comunicaci√≥n de Alto Rendimiento y Serializaci√≥n
                </h3>
                <p style="color: #e2e8f0; font-size: 1.1rem; line-height: 1.4; margin: 0.5rem 0;">
                    <strong>Semana 3</strong> ‚Ä¢ HTTP/2 ‚Ä¢ WebSockets ‚Ä¢ gRPC ‚Ä¢ JSON ‚Ä¢ Protobuf ‚Ä¢ MessagePack ‚Ä¢ XML
                </p>
                <p style="color: #cbd5e1; font-size: 1rem; margin-top: 1rem; font-style: italic;">
                    Dominar protocolos modernos y formatos de serializaci√≥n para sistemas distribuidos eficientes
                </p>
            </div>
        </div>

        <!-- Slide 2: Objetivos -->
        <div class="slide">
            <h2><i class="fas fa-bullseye"></i> Objetivos de la Presentaci√≥n</h2>
            <ul>
                <li>Dominar <span class="highlight">protocolos de comunicaci√≥n de alto rendimiento</span> (HTTP/2,
                    WebSockets, gRPC)</li>
                <li>Analizar <span class="highlight">formatos de serializaci√≥n</span> modernos (JSON, Protobuf,
                    MessagePack)</li>
                <li>Comprender el <span class="highlight">rol b√°sico y empresarial de XML</span></li>
                <li>Evaluar <span class="highlight">ventajas y limitaciones</span> de cada tecnolog√≠a</li>
                <li>Aplicar criterios de <span class="highlight">selecci√≥n tecnol√≥gica</span> seg√∫n contexto</li>
            </ul>
        </div>

        <!-- Slide 3: Agenda -->
        <div class="slide">
            <h2><i class="fas fa-list-check"></i> Agenda</h2>
            <div class="content-grid">
                <div class="feature-card">
                    <h3><i class="fas fa-bolt"></i> 1. HTTP/2</h3>
                    <p>Protocolo moderno de transporte</p>
                </div>
                <div class="feature-card">
                    <h3><i class="fas fa-plug"></i> 2. WebSockets</h3>
                    <p>Conexi√≥n persistente bidireccional</p>
                </div>
                <div class="feature-card">
                    <h3><i class="fas fa-rocket"></i> 3. gRPC</h3>
                    <p>RPC moderno de alto rendimiento</p>
                </div>
                <div class="feature-card">
                    <h3><i class="fas fa-file-code"></i> 4. Serializaci√≥n</h3>
                    <p>JSON, Protobuf, MessagePack</p>
                </div>
                <div class="feature-card">
                    <h3><i class="fas fa-code"></i> 5. XML</h3>
                    <p>Rol b√°sico y empresarial</p>
                </div>
            </div>
        </div>

        <!-- Slide DEMO: Ejemplo de Bloques de C√≥digo -->
        <div class="slide">
            <h2><i class="fas fa-code"></i> Ejemplo: Sistema de C√≥digo Integrado</h2>

            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem; height: calc(100vh - 200px);">
                <!-- Bloque de c√≥digo simple -->
                <div>
                    <h3 style="font-size: 1.1rem; margin-bottom: 1rem; color: var(--uide-accent);">
                        <i class="fas fa-terminal"></i> Bloque de C√≥digo Simple
                    </h3>

                    <div class="code-container">
                        <div class="code-header">
                            <div class="code-title">
                                <i class="fas fa-file-code"></i>
                                Cliente WebSocket
                            </div>
                            <span class="code-language">JavaScript</span>
                        </div>
                        <div class="code-content">
                            <pre class="line-numbers"><code class="language-javascript">// Cliente WebSocket b√°sico
const ws = new WebSocket('ws://localhost:8080');

ws.onopen = () => {
  console.log('Conectado al servidor');
  ws.send('Hola desde el Banco de Loja');
};

ws.onmessage = (event) => {
  console.log('Mensaje recibido:', event.data);
};

ws.onerror = (error) => {
  console.error('Error WebSocket:', error);
};

ws.onclose = () => {
  console.log('Conexi√≥n cerrada');
};</code></pre>
                        </div>
                    </div>
                </div>

                <!-- Sistema de tabs -->
                <div>
                    <h3 style="font-size: 1.1rem; margin-bottom: 1rem; color: var(--uide-accent);">
                        <i class="fas fa-layer-group"></i> Tabs Multi-C√≥digo
                    </h3>

                    <div class="code-tabs-container">
                        <div class="code-tabs-header">
                            <button class="code-tab-btn active" data-tab="cliente">
                                <i class="fas fa-desktop"></i> Cliente
                            </button>
                            <button class="code-tab-btn" data-tab="servidor">
                                <i class="fas fa-server"></i> Servidor
                            </button>
                            <button class="code-tab-btn" data-tab="proto">
                                <i class="fas fa-file-contract"></i> .proto
                            </button>
                        </div>

                        <!-- Tab Cliente -->
                        <div class="code-tab-content active" data-tab="cliente">
                            <div class="code-container" style="margin: 0; border: none; border-radius: 0;">
                                <div class="code-header">
                                    <div class="code-title">
                                        <i class="fas fa-desktop"></i> cliente.js
                                    </div>
                                    <span class="code-language">Node.js</span>
                                </div>
                                <div class="code-content">
                                    <pre class="line-numbers"><code class="language-javascript">const WebSocket = require('ws');

const cliente = new WebSocket('ws://localhost:8080');

cliente.on('open', () => {
  console.log('‚úì Conectado');
  cliente.send(JSON.stringify({
    tipo: 'transferencia',
    monto: 1500.00,
    destino: 'CTA-001'
  }));
});

cliente.on('message', (data) => {
  const respuesta = JSON.parse(data);
  console.log('Respuesta:', respuesta);
});</code></pre>
                                </div>
                            </div>
                        </div>

                        <!-- Tab Servidor -->
                        <div class="code-tab-content" data-tab="servidor">
                            <div class="code-container" style="margin: 0; border: none; border-radius: 0;">
                                <div class="code-header">
                                    <div class="code-title">
                                        <i class="fas fa-server"></i> servidor.js
                                    </div>
                                    <span class="code-language">Node.js</span>
                                </div>
                                <div class="code-content">
                                    <pre class="line-numbers"><code class="language-javascript">const WebSocket = require('ws');

const wss = new WebSocket.Server({ port: 8080 });

wss.on('connection', (ws) => {
  console.log('Cliente conectado');

  ws.on('message', (mensaje) => {
    const datos = JSON.parse(mensaje);
    console.log('Recibido:', datos);

    // Procesar transferencia
    ws.send(JSON.stringify({
      estado: 'exitoso',
      id: 'TRX-' + Date.now(),
      monto: datos.monto
    }));
  });
});</code></pre>
                                </div>
                            </div>
                        </div>

                        <!-- Tab Proto -->
                        <div class="code-tab-content" data-tab="proto">
                            <div class="code-container" style="margin: 0; border: none; border-radius: 0;">
                                <div class="code-header">
                                    <div class="code-title">
                                        <i class="fas fa-file-contract"></i> banco.proto
                                    </div>
                                    <span class="code-language">Protocol Buffers</span>
                                </div>
                                <div class="code-content">
                                    <pre class="line-numbers"><code class="language-protobuf">syntax = "proto3";

package banco;

service BancoService {
  rpc Transferir(TransferenciaRequest)
    returns (TransferenciaResponse);
}

message TransferenciaRequest {
  string cuenta_origen = 1;
  string cuenta_destino = 2;
  double monto = 3;
  string concepto = 4;
}

message TransferenciaResponse {
  bool exitoso = 1;
  string transaccion_id = 2;
  double saldo_disponible = 3;
}</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div
                style="text-align: center; margin-top: 1rem; padding: 1rem; background: rgba(233, 171, 33, 0.1); border-radius: 8px;">
                <p style="color: var(--uide-accent); font-size: 0.9rem;">
                    <i class="fas fa-lightbulb"></i>
                    <strong>Sistema modular</strong>: Cada slide puede incluir c√≥digo real con syntax highlighting,
                    tabs interactivos y botones para copiar
                </p>
            </div>
        </div>

        <!-- Slide 4: HTTP/2 Teor√≠a -->
        <div class="slide">
            <h2 style="margin-bottom: 1.5rem;"><i class="fas fa-globe"></i> HTTP/2: Protocolo de Transporte Moderno</h2>

            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem; height: calc(100vh - 250px);">
                <!-- Secci√≥n Izquierda: Contexto y Motivaci√≥n -->
                <div style="display: flex; flex-direction: column; gap: 1.5rem;">
                    <div class="quote"
                        style="font-size: 1rem; padding: 15px; margin: 0; border-left: 4px solid var(--uide-accent);">
                        "La app m√≥vil del Banco de Loja carga 8 recursos simult√°neamente"
                    </div>

                    <div>
                        <h3 style="font-size: 1.2rem; margin-bottom: 1rem; color: var(--uide-accent);">
                            <i class="fas fa-exclamation-circle"></i> El Problema
                        </h3>
                        <ul style="font-size: 0.95rem; line-height: 1.8; margin: 0; padding-left: 20px;">
                            <li><strong>HTTP/1.1</strong>: Una conexi√≥n, una solicitud a la vez</li>
                            <li><strong>Latencia</strong>: 6 conexiones TCP = 6 round-trips</li>
                            <li><strong>Headers grandes</strong>: Se repiten en cada solicitud</li>
                            <li><strong>Ineficiencia</strong>: Mucho tiempo esperando</li>
                        </ul>
                    </div>
                </div>

                <!-- Secci√≥n Derecha: Caracter√≠sticas HTTP/2 -->
                <div style="display: flex; flex-direction: column; gap: 1.5rem;">
                    <div>
                        <h3 style="font-size: 1.2rem; margin-bottom: 1rem; color: var(--uide-accent);">
                            <i class="fas fa-rocket"></i> Soluciones HTTP/2
                        </h3>
                        <div style="display: flex; flex-direction: column; gap: 0.8rem;">
                            <div
                                style="background: rgba(233, 171, 33, 0.15); padding: 1rem; border-radius: 8px; border-left: 4px solid #4ade80;">
                                <strong style="color: #4ade80;">‚úì Multiplexaci√≥n</strong>
                                <p style="margin: 0.5rem 0 0 0; font-size: 0.9rem;">M√∫ltiples streams en una conexi√≥n
                                    TCP</p>
                            </div>
                            <div
                                style="background: rgba(233, 171, 33, 0.15); padding: 1rem; border-radius: 8px; border-left: 4px solid #4ade80;">
                                <strong style="color: #4ade80;">‚úì Binario</strong>
                                <p style="margin: 0.5rem 0 0 0; font-size: 0.9rem;">Formato eficiente y comprimible</p>
                            </div>
                            <div
                                style="background: rgba(233, 171, 33, 0.15); padding: 1rem; border-radius: 8px; border-left: 4px solid #4ade80;">
                                <strong style="color: #4ade80;">‚úì HPACK</strong>
                                <p style="margin: 0.5rem 0 0 0; font-size: 0.9rem;">Compresi√≥n de headers (70-80%
                                    reducci√≥n)</p>
                            </div>
                            <div
                                style="background: rgba(233, 171, 33, 0.15); padding: 1rem; border-radius: 8px; border-left: 4px solid #4ade80;">
                                <strong style="color: #4ade80;">‚úì Server Push</strong>
                                <p style="margin: 0.5rem 0 0 0; font-size: 0.9rem;">Env√≠o proactivo de recursos</p>
                            </div>
                        </div>
                    </div>

                    <div
                        style="background: rgba(100, 150, 255, 0.1); padding: 1rem; border-radius: 8px; border-left: 4px solid #60a5fa;">
                        <p style="margin: 0; font-size: 0.9rem;">
                            <i class="fas fa-info-circle"></i> <strong>Base para gRPC</strong> y aplicaciones m√≥viles de
                            alto rendimiento
                        </p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Slide 5: HTTP/2 Diagrama de Arquitectura -->
        <!-- aqui -->
        <div class="slide">
            <h2 style="margin-bottom: 1.5rem;"><i class="fas fa-sitemap"></i> HTTP/2: Arquitectura y Multiplexing</h2>

            <div style="height: calc(100vh - 200px); display: flex; align-items: center; justify-content: center;">
                <div
                    style="width: 95%; height: 100%; background: rgba(15, 20, 25, 0.6); border-radius: 8px; padding: 10px;">
                    <iframe
                        src="https://mermaid.live/view#pako:eNqVVdtu2zgQ_ZUBsQ8OIKuSHFmOHvqwadHuBUWwSVug1aKgxbHNWCa9JOU4G6Tf3qEuvrRZb-oXifScOWeuemClFshyZvGfGlWJrySfG74qFNBvzY2TpVxz5eCykqgcArdQsP7wEadFoQa_clVqEAh_6lt-VrAf0ddoNmhasH-XQhuPvtblEp1HtJh3mrxqb9pRBC0yhziEt1wJu-BLhLc3N1fwfk1KBfbQDjB8-bKHvHl9Ay_ubGP9Ig5jktphcrjDqW25C3WplcLSSa3yndNCXWM53Ckc_oH3OWy325arZRgSV8ea70ggjmK4vpOuXEg1hyujnS51ZX-GvIvI0D2Y-XSQJFGQpGlAz7P2r9O5SkIgt7glp_skA1rHpxWWUnAYzOqqGop6XeH2rOd7OosP7n5NmgvGa7coWABOL1H5i98_3oRhWLDHPfyJxBzhv-ild1FbNL8Jfxkno_O0cbF3Qo2zazdUG8lhhcryW9yb_I9UW09taeQUPVlJje24v07iKDpPx9nk4kg0tVXfoC2d0k7OZMlLSuAxZxffU-FNeUVj0DCutHI6hzSKogMaVOIwyn35evnvatxwcIYrO0ND00hSBDrqAi74IfSEil66b6hGip3761e41lY6Db_EaXQU_KmCl02xpNg5HsbflernlfyFThrS8XwZc3RfmqTwZkzssxvuGBSA4L4NPlPP_t15OCjJftj8oI0mQRI9b9hGNGwSjUG_AMtu7E4FdllpizCjLYsw8OuXllt0RPZEUKdBB3H8t9APfgxuaQVv2pUIV7qqaEflfrxoHVfctT03-JoOk2jVGFK7DJOUDmcBWKkazwvkwgfrn2gspW5NRRXawj3ghljoTSraNsSnkA4CLZljBbZb_WGhWMDmRgqWO1NjwFZoVtwf2YOPg4q3wBUNk6-j4GbpPxGPhKGvySetVz3M6Hq-YPmMV5ZO9ZpK3H_CdiaUHDSXulaO5WnjgeUPbMvyJM3CUTwZZ8l4ko2TcRawe5afj8OL8UV2kaTjNMvS81H6GLB_G84onGTp4zfXIE52"
                        style="width: 720px; height: 100%; border: 0; border-radius: 8px;"></iframe>
                </div>
            </div>
        </div>

        <!-- Slide 6: HTTP/2 Simulaciones Interactivas -->
        <div class="slide">
            <h2 style="margin-bottom: 1rem;"><i class="fas fa-play-circle"></i> HTTP/2: Simulaciones Interactivas</h2>

            <div style="display: grid; grid-template-columns: 30% 70%; gap: 1.5rem; height: calc(100vh - 180px);">
                <!-- Controles Izquierda -->
                <div style="display: flex; flex-direction: column; gap: 1rem;">
                    <!-- Tabs de Simulaciones -->
                    <div style="display: flex; flex-direction: column; gap: 0.5rem;">
                        <button class="http2-tab active" data-demo="multiplex"
                            style="padding: 10px; background: var(--uide-accent); color: #0f1419; border: none; border-radius: 4px; font-size: 0.9rem; cursor: pointer; font-weight: 600;">
                            <i class="fas fa-arrows-alt-h"></i> Multiplexaci√≥n
                        </button>
                        <button class="http2-tab" data-demo="hpack"
                            style="padding: 10px; background: rgba(255,255,255,0.1); color: #e2e8f0; border: none; border-radius: 4px; font-size: 0.9rem; cursor: pointer; font-weight: 600;">
                            <i class="fas fa-compress-alt"></i> HPACK
                        </button>
                        <button class="http2-tab" data-demo="push"
                            style="padding: 10px; background: rgba(255,255,255,0.1); color: #e2e8f0; border: none; border-radius: 4px; font-size: 0.9rem; cursor: pointer; font-weight: 600;">
                            <i class="fas fa-paper-plane"></i> Server Push
                        </button>
                    </div>

                    <div style="text-align: center;">
                        <button id="startHttp2Demo"
                            style="padding: 12px 16px; background: var(--uide-accent); color: #0f1419; border: none; border-radius: 6px; font-weight: 600; font-size: 1rem; cursor: pointer; transition: all 0.3s; width: 100%;">
                            <i class="fas fa-play"></i> Iniciar Demo
                        </button>
                    </div>

                    <div id="http2Controls" style="margin-top: 1rem; font-size: 0.9rem;">
                        <label style="color: #e2e8f0; display: block; margin-bottom: 0.5rem;">Requests: </label>
                        <input type="number" id="http2Requests" value="6" min="3" max="10"
                            style="width: 100%; padding: 8px; background: rgba(255,255,255,0.1); border: 1px solid var(--uide-accent); color: white; border-radius: 4px; font-size: 0.9rem;">
                    </div>

                    <div
                        style="background: rgba(233, 171, 33, 0.1); padding: 1rem; border-radius: 8px; margin-top: auto;">
                        <p style="font-size: 0.85rem; margin: 0; color: #e2e8f0;">
                            <i class="fas fa-info-circle"></i> <strong>Haz clic en los botones</strong> para explorar
                            cada caracter√≠stica de HTTP/2
                        </p>
                    </div>
                </div>

                <!-- Visualizaci√≥n Derecha -->
                <div id="http2DemoContainer" style="display: flex; flex-direction: column; gap: 1rem; height: 100%;">
                    <!-- Demo Multiplexaci√≥n -->
                    <div id="demoMultiplex" class="http2-demo-content"
                        style="display: flex; flex-direction: column; gap: 1rem; height: 100%;">
                        <!-- HTTP/1.1 -->
                        <div
                            style="background: rgba(15, 20, 25, 0.6); border-radius: 8px; border: 2px solid #f87171; padding: 1rem; flex: 1; display: flex; flex-direction: column; min-height: 0; max-height: 48%;">
                            <h3
                                style="text-align: center; color: #f87171; margin: 0 0 0.8rem 0; font-size: 0.95rem; flex-shrink: 0;">
                                <i class="fas fa-times-circle"></i> HTTP/1.1 - Conexiones Secuenciales
                            </h3>
                            <div
                                style="flex: 1; background: rgba(0,0,0,0.3); border-radius: 6px; padding: 0.8rem; position: relative; overflow: hidden; min-height: 0;">
                                <canvas id="http1Canvas" style="display: block;"></canvas>
                            </div>
                            <div id="http1Time"
                                style="text-align: center; margin-top: 0.6rem; font-size: 0.8rem; font-weight: 600; color: #f87171; flex-shrink: 0;">
                                Tiempo: -</div>
                        </div>

                        <!-- HTTP/2 -->
                        <div
                            style="background: rgba(15, 20, 25, 0.6); border-radius: 8px; border: 2px solid #4ade80; padding: 1rem; flex: 1; display: flex; flex-direction: column; min-height: 0; max-height: 48%;">
                            <h3
                                style="text-align: center; color: #4ade80; margin: 0 0 0.8rem 0; font-size: 0.95rem; flex-shrink: 0;">
                                <i class="fas fa-check-circle"></i> HTTP/2 - Multiplexaci√≥n (Streams Paralelos)
                            </h3>
                            <div
                                style="flex: 1; background: rgba(0,0,0,0.3); border-radius: 6px; padding: 0.8rem; position: relative; overflow: hidden; min-height: 0;">
                                <canvas id="http2Canvas" style="display: block;"></canvas>
                            </div>
                            <div id="http2Time"
                                style="text-align: center; margin-top: 0.6rem; font-size: 0.8rem; font-weight: 600; color: #4ade80; flex-shrink: 0;">
                                Tiempo: -</div>
                        </div>

                        <!-- Comparaci√≥n de mejora -->
                        <div
                            style="text-align: center; padding: 0.8rem; background: rgba(233, 171, 33, 0.1); border-radius: 6px; flex-shrink: 0;">
                            <div id="http2Improvement"
                                style="font-size: 0.9rem; font-weight: 600; color: var(--uide-accent);">
                                Comparaci√≥n de rendimiento HTTP/1.1 vs HTTP/2
                            </div>
                        </div>
                    </div>

                    <!-- Demo HPACK -->
                    <div id="demoHpack" class="http2-demo-content"
                        style="display: none; flex-direction: column; gap: 1rem; height: 100%;">
                        <div
                            style="background: rgba(15, 20, 25, 0.6); border-radius: 8px; border: 2px solid #f87171; padding: 1rem; flex: 1; display: flex; flex-direction: column; max-height: 48%;">
                            <h3 style="text-align: center; color: #f87171; margin: 0 0 0.8rem 0; font-size: 0.95rem;">
                                <i class="fas fa-times-circle"></i> HTTP/1.1 - Headers Sin Comprimir
                            </h3>
                            <div
                                style="flex: 1; background: rgba(0,0,0,0.3); border-radius: 6px; padding: 1rem; overflow-y: auto;">
                                <canvas id="hpackHttp1Canvas" style="display: block;"></canvas>
                            </div>
                            <div id="hpackHttp1Size"
                                style="text-align: center; margin-top: 0.6rem; font-size: 0.8rem; font-weight: 600; color: #f87171;">
                                Tama√±o: -</div>
                        </div>

                        <div
                            style="background: rgba(15, 20, 25, 0.6); border-radius: 8px; border: 2px solid #4ade80; padding: 1rem; flex: 1; display: flex; flex-direction: column; max-height: 48%;">
                            <h3 style="text-align: center; color: #4ade80; margin: 0 0 0.8rem 0; font-size: 0.95rem;">
                                <i class="fas fa-check-circle"></i> HTTP/2 - Headers Comprimidos (HPACK)
                            </h3>
                            <div
                                style="flex: 1; background: rgba(0,0,0,0.3); border-radius: 6px; padding: 1rem; overflow-y: auto;">
                                <canvas id="hpackHttp2Canvas" style="display: block;"></canvas>
                            </div>
                            <div id="hpackHttp2Size"
                                style="text-align: center; margin-top: 0.6rem; font-size: 0.8rem; font-weight: 600; color: #4ade80;">
                                Tama√±o: -</div>
                        </div>

                        <div
                            style="text-align: center; padding: 0.8rem; background: rgba(233, 171, 33, 0.1); border-radius: 6px;">
                            <div id="hpackImprovement"
                                style="font-size: 0.9rem; font-weight: 600; color: var(--uide-accent);">
                                Compresi√≥n de headers con algoritmo HPACK
                            </div>
                        </div>
                    </div>

                    <!-- Demo Server Push -->
                    <div id="demoPush" class="http2-demo-content"
                        style="display: none; flex-direction: column; gap: 1rem; height: 100%;">
                        <div
                            style="background: rgba(15, 20, 25, 0.6); border-radius: 8px; border: 2px solid #f87171; padding: 1rem; flex: 1; display: flex; flex-direction: column; max-height: 48%;">
                            <h3 style="text-align: center; color: #f87171; margin: 0 0 0.8rem 0; font-size: 0.95rem;">
                                <i class="fas fa-times-circle"></i> HTTP/1.1 - Request/Response Tradicional
                            </h3>
                            <div
                                style="flex: 1; background: rgba(0,0,0,0.3); border-radius: 6px; padding: 1rem; position: relative; overflow: hidden;">
                                <canvas id="pushHttp1Canvas" style="display: block;"></canvas>
                            </div>
                            <div id="pushHttp1Time"
                                style="text-align: center; margin-top: 0.6rem; font-size: 0.8rem; font-weight: 600; color: #f87171;">
                                Tiempo: -</div>
                        </div>

                        <div
                            style="background: rgba(15, 20, 25, 0.6); border-radius: 8px; border: 2px solid #4ade80; padding: 1rem; flex: 1; display: flex; flex-direction: column; max-height: 48%;">
                            <h3 style="text-align: center; color: #4ade80; margin: 0 0 0.8rem 0; font-size: 0.95rem;">
                                <i class="fas fa-check-circle"></i> HTTP/2 - Server Push Proactivo
                            </h3>
                            <div
                                style="flex: 1; background: rgba(0,0,0,0.3); border-radius: 6px; padding: 1rem; position: relative; overflow: hidden;">
                                <canvas id="pushHttp2Canvas" style="display: block;"></canvas>
                            </div>
                            <div id="pushHttp2Time"
                                style="text-align: center; margin-top: 0.6rem; font-size: 0.8rem; font-weight: 600; color: #4ade80;">
                                Tiempo: -</div>
                        </div>

                        <div
                            style="text-align: center; padding: 0.8rem; background: rgba(233, 171, 33, 0.1); border-radius: 6px;">
                            <div id="pushImprovement"
                                style="font-size: 0.9rem; font-weight: 600; color: var(--uide-accent);">
                                Env√≠o proactivo de recursos sin solicitud previa
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Slide 7: HTTP/2 C√≥digo -->
        <div class="slide">
            <h2 style="margin-bottom: 1rem;"><i class="fas fa-code"></i> HTTP/2: Ejemplos de C√≥digo</h2>

            <!-- Tabs de c√≥digo -->
            <div class="code-tabs-container" style="margin: 0;">
                <div class="code-tabs-header">
                    <button class="code-tab-btn active" data-tab="http2-server">
                        <i class="fas fa-server"></i> Servidor
                    </button>
                    <button class="code-tab-btn" data-tab="http2-client">
                        <i class="fas fa-desktop"></i> Cliente
                    </button>
                    <button class="code-tab-btn" data-tab="http2-push">
                        <i class="fas fa-rocket"></i> Server Push
                    </button>
                </div>

                <!-- Tab Servidor HTTP/2 -->
                <div class="code-tab-content active" data-tab="http2-server">
                    <div class="code-container" style="margin: 0; border: none; border-radius: 0;">
                        <div class="code-header">
                            <div class="code-title">
                                <i class="fas fa-server"></i> servidor-http2.js
                            </div>
                            <span class="code-language">Node.js ES2025</span>
                        </div>
                        <div class="code-content" style="max-height: 450px;">
                            <pre class="line-numbers"><code class="language-javascript">// Servidor HTTP/2 del Banco de Loja - ES2025
import http2 from 'http2';
import fs from 'fs/promises';
import { createReadStream } from 'fs';
import path from 'path';

class ServidorHTTP2 {
  #server = null;
  #config = {
    port: 8443,
    keyPath: './certs/server.key',
    certPath: './certs/server.crt'
  };

  constructor(config = {}) {
    this.#config = { ...this.#config, ...config };
  }

  async iniciar() {
    // Leer certificados SSL para HTTP/2
    const [key, cert] = await Promise.all([
      fs.readFile(this.#config.keyPath),
      fs.readFile(this.#config.certPath)
    ]);

    // Crear servidor HTTP/2 seguro
    this.#server = http2.createSecureServer({
      key,
      cert,
      allowHTTP1: false // Solo HTTP/2
    });

    this.#server.on('stream', this.#handleStream.bind(this));
    this.#server.on('error', this.#handleError.bind(this));

    return new Promise((resolve) => {
      this.#server.listen(this.#config.port, () => {
        console.log(`Servidor HTTP/2 en puerto ${this.#config.port}`);
        resolve();
      });
    });
  }

  #handleStream(stream, headers) {
    const path = headers[':path'];
    const method = headers[':method'];

    console.log(`${method} ${path}`);

    // Enrutamiento simple
    const routes = {
      '/': () => this.#servirHTML(stream),
      '/api/cuenta': () => this.#servirJSON(stream),
      '/api/transferencias': () => this.#servirTransferencias(stream)
    };

    const handler = routes[path] ?? (() => this.#error404(stream));
    handler();
  }

  async #servirHTML(stream) {
    stream.respond({
      ':status': 200,
      'content-type': 'text/html; charset=utf-8'
    });

    stream.end(`
      <!DOCTYPE html>
      <html>
        <head>

        </head>
        <body>
          <h1>Bienvenido al Banco de Loja</h1>
          <p>Conexi√≥n segura HTTP/2</p>
        </body>
      </html>
    `);
  }

  #servirJSON(stream) {
    stream.respond({
      ':status': 200,
      'content-type': 'application/json'
    });

    stream.end(JSON.stringify({
      cuenta: 'CTA-00123456',
      titular: 'Juan P√©rez',
      saldo: 5000.00,
      tipo: 'Ahorros'
    }));
  }

  async #servirTransferencias(stream) {
    // Simulaci√≥n de consulta a base de datos
    const transferencias = [
      { id: 1, monto: 500, fecha: '2025-01-10', tipo: 'DEBITO' },
      { id: 2, monto: 1500, fecha: '2025-01-09', tipo: 'CREDITO' }
    ];

    stream.respond({
      ':status': 200,
      'content-type': 'application/json'
    });

    stream.end(JSON.stringify(transferencias));
  }

  #error404(stream) {
    stream.respond({ ':status': 404 });
    stream.end('No encontrado');
  }

  #handleError(error) {
    console.error('Error en servidor:', error);
  }

  async detener() {
    return new Promise((resolve) => {
      this.#server?.close(() => {
        console.log('Servidor HTTP/2 detenido');
        resolve();
      });
    });
  }
}

// Uso
const servidor = new ServidorHTTP2();
await servidor.iniciar();</code></pre>
                        </div>
                    </div>
                </div>

                <!-- Tab Cliente HTTP/2 -->
                <div class="code-tab-content" data-tab="http2-client">
                    <div class="code-container" style="margin: 0; border: none; border-radius: 0;">
                        <div class="code-header">
                            <div class="code-title">
                                <i class="fas fa-desktop"></i> cliente-http2.js
                            </div>
                            <span class="code-language">Node.js ES2025</span>
                        </div>
                        <div class="code-content" style="max-height: 450px;">
                            <pre class="line-numbers"><code class="language-javascript">// Cliente HTTP/2 del Banco de Loja - ES2025
import http2 from 'http2';

class ClienteHTTP2 {
  #client = null;
  #config = {
    serverUrl: 'https://localhost:8443'
  };

  constructor(config = {}) {
    this.#config = { ...this.#config, ...config };
  }

  conectar() {
    this.#client = http2.connect(this.#config.serverUrl, {
      rejectUnauthorized: false // Solo para desarrollo
    });

    this.#client.on('error', (error) => {
      console.error('Error de conexi√≥n:', error);
    });
  }

  // Realizar m√∫ltiples requests simult√°neos (Multiplexaci√≥n)
  async requestsMultiples(rutas) {
    console.log('Iniciando requests m√∫ltiples en paralelo...');

    const promises = rutas.map((ruta) => this.#request(ruta));

    const inicio = Date.now();
    const resultados = await Promise.all(promises);
    const duracion = Date.now() - inicio;

    console.log(`Completados ${rutas.length} requests en ${duracion}ms`);

    return resultados;
  }

  #request(path) {
    return new Promise((resolve, reject) => {
      const req = this.#client.request({
        ':path': path,
        ':method': 'GET'
      });

      let data = '';

      req.on('response', (headers) => {
        console.log(`Respuesta de ${path}: ${headers[':status']}`);
      });

      req.on('data', (chunk) => {
        data += chunk;
      });

      req.on('end', () => {
        resolve({
          path,
          data: data.toString()
        });
      });

      req.on('error', reject);
      req.end();
    });
  }

  desconectar() {
    this.#client?.close();
  }
}

// Uso: Multiplexaci√≥n HTTP/2
const cliente = new ClienteHTTP2();
cliente.conectar();

// Realizar 6 requests simult√°neos (Multiplexaci√≥n)
const rutas = [
  '/api/cuenta',
  '/api/transferencias',
  '/api/movimientos',
  '/api/saldo',
  '/api/beneficiarios',
  '/api/notificaciones'
];

const resultados = await cliente.requestsMultiples(rutas);
console.log('Resultados:', resultados);

cliente.desconectar();</code></pre>
                        </div>
                    </div>
                </div>

                <!-- Tab Server Push -->
                <div class="code-tab-content" data-tab="http2-push">
                    <div class="code-container" style="margin: 0; border: none; border-radius: 0;">
                        <div class="code-header">
                            <div class="code-title">
                                <i class="fas fa-rocket"></i> server-push.js
                            </div>
                            <span class="code-language">Node.js ES2025</span>
                        </div>
                        <div class="code-content" style="max-height: 450px;">
                            <pre class="line-numbers"><code class="language-javascript">// Server Push HTTP/2 - ES2025
import http2 from 'http2';
import fs from 'fs/promises';

class ServidorConPush {
  #server = null;

  async iniciar() {
    const [key, cert] = await Promise.all([
      fs.readFile('./certs/server.key'),
      fs.readFile('./certs/server.crt')
    ]);

    this.#server = http2.createSecureServer({ key, cert });

    this.#server.on('stream', (stream, headers) => {
      const path = headers[':path'];

      if (path === '/') {
        this.#servirConPush(stream);
      }
    });

    this.#server.listen(8443);
  }

  #servirConPush(stream) {
    // Server Push: Enviar recursos antes de que el cliente los pida

    // 1. Push de CSS
    stream.pushStream({
      ':path': '/css/styles.css'
    }, (err, pushStream) => {
      if (err) return;

      pushStream.respond({
        ':status': 200,
        'content-type': 'text/css'
      });

      pushStream.end(`
        body {
          font-family: Arial, sans-serif;
          background: #0f1419;
          color: white;
        }
      `);
    });

    // 2. Push de JavaScript
    stream.pushStream({
      ':path': '/js/app.js'
    }, (err, pushStream) => {
      if (err) return;

      pushStream.respond({
        ':status': 200,
        'content-type': 'application/javascript'
      });

      pushStream.end(`
        console.log('App cargada desde Server Push');

        // Inicializar app del Banco de Loja
        document.addEventListener('DOMContentLoaded', () => {
          console.log('DOM Ready - HTTP/2 Server Push activo');
        });
      `);
    });

    // 3. Push de datos JSON
    stream.pushStream({
      ':path': '/api/cuenta'
    }, (err, pushStream) => {
      if (err) return;

      pushStream.respond({
        ':status': 200,
        'content-type': 'application/json'
      });

      pushStream.end(JSON.stringify({
        cuenta: 'CTA-00123456',
        saldo: 5000.00,
        nombre: 'Juan P√©rez'
      }));
    });

    // Enviar HTML principal
    stream.respond({
      ':status': 200,
      'content-type': 'text/html'
    });

    stream.end(`
      <!DOCTYPE html>
      <html>
        <head>
          <title>Banco de Loja</title>
          <link rel="stylesheet" href="/css/styles.css">

        </head>
        <body>
          <h1>Server Push Activo</h1>
          <p>Los recursos fueron enviados proactivamente</p>
        </body>
      </html>
    `);

    console.log('HTML enviado con 3 recursos en Server Push');
  }
}

// Uso
const servidor = new ServidorConPush();
await servidor.iniciar();
console.log('Servidor con Server Push en puerto 8443');</code></pre>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    </div>

    <div
        style="text-align: center; margin-top: 1.5rem; padding: 1rem; background: rgba(233, 171, 33, 0.1); border-radius: 8px;">
        <p style="color: var(--uide-accent); font-size: 0.9rem; margin: 0;">
            <i class="fas fa-bolt"></i>
            <strong>HTTP/2</strong> permite multiplexaci√≥n (m√∫ltiples streams en una conexi√≥n),
            compresi√≥n HPACK de headers y Server Push proactivo de recursos.
        </p>
    </div>
    </div>

    <!-- Scripts externos -->
    <script src="js/helpers.js"></script>
    <script src="js/http2-demos.js"></script>
    <script src="websockets-demos.js"></script>
    <script>
        // Las demos est√°n en archivos separados:
        // - http2-demos.js: Demos de HTTP/2
        // - websockets-demos.js: Demos de WebSockets

        document.addEventListener('DOMContentLoaded', function () {
            // Tabs de demos WebSocket
            const wsTabs = document.querySelectorAll('.ws-tab');
            wsTabs.forEach(tab => {
                tab.addEventListener('click', function () {
                    const demoType = this.getAttribute('data-demo');
                    switchWsDemo(demoType);
                });
            });

            // Bot√≥n iniciar demo WebSocket
            const startWsDemo = document.getElementById('startWsDemo');
            if (startWsDemo) {
                startWsDemo.addEventListener('click', function () {
                    const messages = parseInt(document.getElementById('wsMessages').value) || 5;

                    if (currentWsDemo === 'handshake') {
                        runHandshakeDemo(messages);
                    } else if (currentWsDemo === 'chat') {
                        runChatDemo(messages);
                    } else if (currentWsDemo === 'latency') {
                        runLatencyDemo(messages);
                    }
                });
            }
        });

        function switchWsDemo(demoType) {
            currentWsDemo = demoType;

            // Actualizar tabs
            document.querySelectorAll('.ws-tab').forEach(tab => {
                if (tab.getAttribute('data-demo') === demoType) {
                    tab.style.background = 'var(--uide-accent)';
                    tab.style.color = '#0f1419';
                } else {
                    tab.style.background = 'rgba(255,255,255,0.1)';
                    tab.style.color = '#e2e8f0';
                }
            });

            // Mostrar/ocultar contenido
            document.querySelectorAll('.ws-demo-content').forEach(content => {
                content.style.display = 'none';
            });

            const activeDemo = document.getElementById(`demo${demoType.charAt(0).toUpperCase() + demoType.slice(1)}`);
            if (activeDemo) {
                activeDemo.style.display = 'flex';
            }

            // Mostrar/ocultar controles
            const controlsDiv = document.getElementById('wsControls');
            if (demoType === 'latency') {
                controlsDiv.style.display = 'none';
            } else {
                controlsDiv.style.display = 'block';
            }
        }

        // ===== DEMO 1: HANDSHAKE - HTTP Polling vs WebSocket =====
        function runHandshakeDemo(numMessages) {
            animatePolling(numMessages);
            setTimeout(() => animateWebSocket(numMessages), 100);
        }

        function animatePolling(numMessages) {
            const canvas = document.getElementById('pollingCanvas');
            if (!canvas) return;

            const { width, height } = getCanvasDimensions(canvas, 16);
            const ctx = setupHighDPICanvas(canvas, width, height);
            ctx.clearRect(0, 0, width, height);

            const clientX = 40;
            const serverX = width - 60;

            // Dibujar endpoints
            ctx.fillStyle = '#f87171';
            ctx.fillRect(clientX - 20, 10, 40, 40);
            ctx.fillStyle = '#ffffff';
            ctx.font = 'bold 10px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('‚ñØ', clientX, 28);
            ctx.fillText('Client', clientX, 42);

            ctx.fillStyle = '#f87171';
            ctx.fillRect(serverX - 20, 10, 40, 40);
            ctx.fillStyle = '#ffffff';
            ctx.fillText('‚óâ', serverX, 28);
            ctx.fillText('Server', serverX, 42);

            let connections = 0;
            let currentMsg = 0;

            const interval = setInterval(() => {
                if (currentMsg >= numMessages) {
                    clearInterval(interval);
                    document.getElementById('pollingInfo').textContent =
                        `üî¥ Total: ${connections} conexiones | Overhead alto`;
                    return;
                }

                const y = 70 + (currentMsg % 3) * 40;

                // Nueva conexi√≥n para cada mensaje
                connections++;

                let progress = 0;
                const animInterval = setInterval(() => {
                    progress += 10;
                    if (progress > 200) {
                        clearInterval(animInterval);
                        currentMsg++;
                        return;
                    }

                    ctx.clearRect(0, y - 5, canvas.width, 35);

                    // Handshake + Request
                    if (progress <= 100) {
                        const width = ((serverX - clientX - 40) * progress) / 100;

                        // L√≠nea de conexi√≥n
                        ctx.strokeStyle = '#f87171';
                        ctx.lineWidth = 2;
                        ctx.setLineDash([3, 3]);
                        ctx.beginPath();
                        ctx.moveTo(clientX + 20, y + 10);
                        ctx.lineTo(clientX + 20 + width, y + 10);
                        ctx.stroke();
                        ctx.setLineDash([]);

                        // Paquete
                        ctx.fillStyle = '#f87171';
                        ctx.fillRect(clientX + 20 + width - 10, y + 5, 10, 10);
                        ctx.fillStyle = '#ffffff';
                        ctx.font = '8px Arial';
                        ctx.textAlign = 'center';
                        ctx.fillText('‚óà', clientX + 20 + width - 5, y + 13);
                    }

                    // Response + Close
                    if (progress > 100) {
                        const respProgress = progress - 100;
                        const width = ((serverX - clientX - 40) * respProgress) / 100;

                        // L√≠nea de respuesta
                        ctx.strokeStyle = '#4ade80';
                        ctx.lineWidth = 2;
                        ctx.setLineDash([3, 3]);
                        ctx.beginPath();
                        ctx.moveTo(serverX - 20, y + 20);
                        ctx.lineTo(serverX - 20 - width, y + 20);
                        ctx.stroke();
                        ctx.setLineDash([]);

                        // Paquete
                        ctx.fillStyle = '#4ade80';
                        ctx.fillRect(serverX - 20 - width - 10, y + 15, 10, 10);
                        ctx.fillStyle = '#ffffff';
                        ctx.font = '8px Arial';
                        ctx.textAlign = 'center';
                        ctx.fillText('üì¨', serverX - 20 - width - 5, y + 23);

                        // X de cierre
                        if (respProgress > 80) {
                            ctx.fillStyle = '#f87171';
                            ctx.font = 'bold 12px Arial';
                            ctx.fillText('√ó', width / 2, y + 18);
                        }
                    }

                    // Contador
                    ctx.fillStyle = '#fbbf24';
                    ctx.font = 'bold 9px Arial';
                    ctx.textAlign = 'left';
                    ctx.fillText(`Conn #${connections}`, 10, y + 15);

                    document.getElementById('pollingInfo').textContent =
                        `üî¥ Conexiones: ${connections} | Polling cada request`;
                }, 15);
            }, 300);
        }

        function animateWebSocket(numMessages) {
            const canvas = document.getElementById('wsCanvas');
            if (!canvas) return;

            const { width, height } = getCanvasDimensions(canvas, 16);
            const ctx = setupHighDPICanvas(canvas, width, height);
            ctx.clearRect(0, 0, width, height);

            const clientX = 40;
            const serverX = width - 60;

            // Dibujar endpoints
            ctx.fillStyle = '#4ade80';
            ctx.fillRect(clientX - 20, 10, 40, 40);
            ctx.fillStyle = '#ffffff';
            ctx.font = 'bold 10px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('‚ñØ', clientX, 28);
            ctx.fillText('Client', clientX, 42);

            ctx.fillStyle = '#4ade80';
            ctx.fillRect(serverX - 20, 10, 40, 40);
            ctx.fillStyle = '#ffffff';
            ctx.fillText('‚óâ', serverX, 28);
            ctx.fillText('Server', serverX, 42);

            // Handshake inicial
            let progress = 0;
            const handshakeInterval = setInterval(() => {
                progress += 10;
                if (progress > 100) {
                    clearInterval(handshakeInterval);

                    // Dibujar conexi√≥n persistente
                    ctx.strokeStyle = '#22c55e';
                    ctx.lineWidth = 3;
                    ctx.beginPath();
                    ctx.moveTo(clientX + 20, 30);
                    ctx.lineTo(serverX - 20, 30);
                    ctx.stroke();

                    ctx.fillStyle = '#22c55e';
                    ctx.font = 'bold 9px Arial';
                    ctx.textAlign = 'center';
                    ctx.fillText('‚ö° CONEXION PERSISTENTE', width / 2, 25);

                    // Enviar mensajes por la conexi√≥n persistente
                    let currentMsg = 0;
                    const msgInterval = setInterval(() => {
                        if (currentMsg >= numMessages) {
                            clearInterval(msgInterval);
                            document.getElementById('wsInfo').textContent =
                                `üü¢ Total: 1 conexi√≥n | ${numMessages} mensajes`;

                            const pollingConns = numMessages;
                            const reduction = ((pollingConns - 1) / pollingConns * 100).toFixed(0);
                            document.getElementById('wsHandshakeResult').innerHTML =
                                `<i class="fas fa-bolt"></i> WebSocket reduce <strong>${reduction}% las conexiones</strong> (${pollingConns} ‚Üí 1)`;
                            return;
                        }

                        const y = 60 + (currentMsg % 4) * 30;

                        let msgProgress = 0;
                        const msgAnimInterval = setInterval(() => {
                            msgProgress += 15;
                            if (msgProgress > 100) {
                                clearInterval(msgAnimInterval);
                                currentMsg++;
                                return;
                            }

                            ctx.clearRect(clientX + 25, y - 5, serverX - clientX - 50, 25);

                            // Mensaje viajando
                            const msgX = clientX + 25 + ((serverX - clientX - 50) * msgProgress) / 100;

                            ctx.fillStyle = currentMsg % 2 === 0 ? '#60a5fa' : '#a78bfa';
                            ctx.fillRect(msgX - 8, y, 16, 16);
                            ctx.fillStyle = '#ffffff';
                            ctx.font = '10px Arial';
                            ctx.textAlign = 'center';
                            ctx.fillText('üí¨', msgX, y + 11);

                            // N√∫mero de mensaje
                            ctx.fillStyle = '#fbbf24';
                            ctx.font = 'bold 8px Arial';
                            ctx.fillText(`#${currentMsg + 1}`, msgX, y - 2);

                            document.getElementById('wsInfo').textContent =
                                `üü¢ Conexi√≥n: 1 | Mensaje ${currentMsg + 1}/${numMessages}`;
                        }, 20);
                    }, 250);
                    return;
                }

                ctx.clearRect(0, 55, width, 20);

                // Handshake animation
                const lineWidth = ((serverX - clientX - 40) * progress) / 100;
                ctx.strokeStyle = '#fbbf24';
                ctx.lineWidth = 2;
                ctx.setLineDash([5, 5]);
                ctx.beginPath();
                ctx.moveTo(clientX + 20, 65);
                ctx.lineTo(clientX + 20 + lineWidth, 65);
                ctx.stroke();
                ctx.setLineDash([]);

                ctx.fillStyle = '#fbbf24';
                ctx.font = 'bold 9px Arial';
                ctx.textAlign = 'center';
                ctx.fillText('ü§ù HTTP Upgrade', width / 2, 60);

                document.getElementById('wsInfo').textContent =
                    `üü° Estableciendo conexi√≥n WebSocket...`;
            }, 30);
        }

        // ===== DEMO 2: CHAT EN TIEMPO REAL =====
        function runChatDemo(numMessages) {
            const canvas = document.getElementById('chatCanvas');
            if (!canvas) return;

            const { width, height } = getCanvasDimensions(canvas, 24);
            const ctx = setupHighDPICanvas(canvas, width, height);
            ctx.clearRect(0, 0, width, height);

            const messages = [
                { user: 'Cliente', text: 'Hola, necesito ayuda con una transferencia', color: '#60a5fa' },
                { user: 'Soporte BdL', text: 'Con gusto le ayudo. ¬øQu√© necesita?', color: '#a78bfa' },
                { user: 'Cliente', text: 'No puedo transferir a cuenta del Pichincha', color: '#60a5fa' },
                { user: 'Soporte BdL', text: 'Verifico su cuenta. Un momento por favor', color: '#a78bfa' },
                { user: 'Soporte BdL', text: 'Ya est√° solucionado. Puede intentar de nuevo', color: '#a78bfa' },
                { user: 'Cliente', text: 'Perfecto! Ya funcion√≥. Gracias!', color: '#60a5fa' },
                { user: 'Soporte BdL', text: '¬øNecesita algo m√°s?', color: '#a78bfa' },
                { user: 'Cliente', text: 'No, eso es todo. Excelente servicio!', color: '#60a5fa' },
                { user: 'Soporte BdL', text: 'Gracias por confiar en Banco de Loja ‚ñ†', color: '#a78bfa' },
                { user: 'Cliente', text: 'Hasta luego!', color: '#60a5fa' }
            ];

            const selectedMessages = messages.slice(0, numMessages);
            let currentMsg = 0;
            let yOffset = 20;

            // T√≠tulo
            ctx.fillStyle = '#4ade80';
            ctx.font = 'bold 11px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('üí¨ Chat Room - WebSocket Connection', canvas.width / 2, 15);

            const interval = setInterval(() => {
                if (currentMsg >= selectedMessages.length) {
                    clearInterval(interval);
                    document.getElementById('chatInfo').textContent =
                        `üí¨ ${selectedMessages.length} mensajes enviados | Latencia < 10ms`;
                    document.getElementById('chatResult').innerHTML =
                        `<i class="fas fa-comments"></i> Chat en tiempo real con <strong>comunicaci√≥n bidireccional simult√°nea</strong>`;
                    return;
                }

                const msg = selectedMessages[currentMsg];
                const isAlice = msg.user === 'Alice';
                const x = isAlice ? 20 : canvas.width - 20;
                const align = isAlice ? 'left' : 'right';

                // Burbuja de mensaje
                const textWidth = ctx.measureText(msg.text).width + 20;
                const bubbleX = isAlice ? x : x - textWidth;

                ctx.fillStyle = msg.color + '30';
                ctx.fillRect(bubbleX, yOffset, textWidth, 40);
                ctx.strokeStyle = msg.color;
                ctx.lineWidth = 2;
                ctx.strokeRect(bubbleX, yOffset, textWidth, 40);

                // Usuario
                ctx.fillStyle = msg.color;
                ctx.font = 'bold 10px Arial';
                ctx.textAlign = align;
                ctx.fillText(msg.user, isAlice ? x + 10 : x - 10, yOffset + 15);

                // Mensaje
                ctx.fillStyle = '#ffffff';
                ctx.font = '9px Arial';
                ctx.fillText(msg.text, isAlice ? x + 10 : x - 10, yOffset + 30);

                // Timestamp
                ctx.fillStyle = '#94a3b8';
                ctx.font = '7px Arial';
                ctx.fillText(`${currentMsg * 0.5}s`, isAlice ? x + 10 : x - 10, yOffset + 38);

                yOffset += 45;
                currentMsg++;

                document.getElementById('chatInfo').textContent =
                    `üí¨ Mensajes: ${currentMsg}/${selectedMessages.length} | En tiempo real`;
            }, 500);
        }

        // ===== DEMO 3: COMPARACI√ìN DE LATENCIA =====
        function runLatencyDemo(numTests = 10) {
            const canvas = document.getElementById('latencyCanvas');
            if (!canvas) return;

            const { width, height } = getCanvasDimensions(canvas, 24);
            const ctx = setupHighDPICanvas(canvas, width, height);
            ctx.clearRect(0, 0, width, height);

            // T√≠tulo
            ctx.fillStyle = '#ffffff';
            ctx.font = 'bold 12px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('Latencia: HTTP Polling vs WebSocket', width / 2, 20);

            // Leyenda
            ctx.fillStyle = '#f87171';
            ctx.fillRect(20, 35, 15, 15);
            ctx.fillStyle = '#ffffff';
            ctx.font = '10px Arial';
            ctx.textAlign = 'left';
            ctx.fillText('HTTP Polling', 40, 47);

            ctx.fillStyle = '#4ade80';
            ctx.fillRect(width / 2 + 20, 35, 15, 15);
            ctx.fillText('WebSocket', width / 2 + 40, 47);

            // Ejes
            ctx.strokeStyle = '#94a3b8';
            ctx.lineWidth = 1;
            ctx.beginPath();
            ctx.moveTo(40, 80);
            ctx.lineTo(40, 380);
            ctx.lineTo(width - 40, 380);
            ctx.stroke();

            ctx.fillStyle = '#94a3b8';
            ctx.font = '9px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('Latencia (ms)', 20, 230);
            ctx.fillText('Requests', width / 2, 395);

            // Escala Y
            for (let i = 0; i <= 5; i++) {
                const y = 380 - (i * 60);
                const latency = i * 50;
                ctx.fillStyle = '#94a3b8';
                ctx.font = '8px Arial';
                ctx.textAlign = 'right';
                ctx.fillText(`${latency}`, 35, y + 3);

                ctx.strokeStyle = '#94a3b833';
                ctx.beginPath();
                ctx.moveTo(40, y);
                ctx.lineTo(width - 40, y);
                ctx.stroke();
            }

            let currentTest = 0;
            const pollingLatencies = [];
            const wsLatencies = [];

            const interval = setInterval(() => {
                if (currentTest >= numTests) {
                    clearInterval(interval);

                    const avgPolling = pollingLatencies.reduce((a, b) => a + b, 0) / pollingLatencies.length;
                    const avgWs = wsLatencies.reduce((a, b) => a + b, 0) / wsLatencies.length;
                    const improvement = ((avgPolling - avgWs) / avgPolling * 100).toFixed(0);

                    document.getElementById('latencyInfo').textContent =
                        `‚ñä Polling: ${avgPolling.toFixed(0)}ms | WebSocket: ${avgWs.toFixed(0)}ms`;
                    document.getElementById('latencyResult').innerHTML =
                        `<i class="fas fa-tachometer-alt"></i> WebSocket es <strong>${improvement}% m√°s r√°pido</strong> (${(avgPolling - avgWs).toFixed(0)}ms menos latencia)`;
                    return;
                }

                // Generar latencias simuladas
                const pollingLatency = 150 + Math.random() * 100; // 150-250ms
                const wsLatency = 5 + Math.random() * 15; // 5-20ms

                pollingLatencies.push(pollingLatency);
                wsLatencies.push(wsLatency);

                const x = 50 + (currentTest * ((width - 100) / numTests));

                // Barra HTTP Polling
                const pollingHeight = (pollingLatency / 250) * 300;
                ctx.fillStyle = '#f87171';
                ctx.fillRect(x - 8, 380 - pollingHeight, 8, pollingHeight);

                // Barra WebSocket
                const wsHeight = (wsLatency / 250) * 300;
                ctx.fillStyle = '#4ade80';
                ctx.fillRect(x + 2, 380 - wsHeight, 8, wsHeight);

                // Valores
                ctx.fillStyle = '#f87171';
                ctx.font = '7px Arial';
                ctx.textAlign = 'center';
                ctx.fillText(`${pollingLatency.toFixed(0)}`, x - 4, 380 - pollingHeight - 3);

                ctx.fillStyle = '#4ade80';
                ctx.fillText(`${wsLatency.toFixed(0)}`, x + 6, 380 - wsHeight - 3);

                currentTest++;

                const avgPolling = pollingLatencies.reduce((a, b) => a + b, 0) / pollingLatencies.length;
                const avgWs = wsLatencies.reduce((a, b) => a + b, 0) / wsLatencies.length;

                document.getElementById('latencyInfo').textContent =
                    `‚ñä Test ${currentTest}/${numTests} | Polling: ${avgPolling.toFixed(0)}ms | WS: ${avgWs.toFixed(0)}ms`;
            }, 400);
        }
    </script>

    <!-- Slide 8: WebSockets Teor√≠a -->
    <div class="slide">
        <h2 style="margin-bottom: 1.5rem;"><i class="fas fa-plug"></i> WebSockets: Conexi√≥n Persistente Bidireccional
        </h2>

        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem; height: calc(100vh - 250px);">
            <!-- Secci√≥n Izquierda: Contexto y Problema -->
            <div style="display: flex; flex-direction: column; gap: 1.5rem;">
                <div class="quote"
                    style="font-size: 1rem; padding: 15px; margin: 0; border-left: 4px solid var(--uide-accent);">
                    "Notificaciones en tiempo real cuando llega una transferencia"
                </div>

                <div>
                    <h3 style="font-size: 1.2rem; margin-bottom: 1rem; color: var(--uide-accent);">
                        <i class="fas fa-exclamation-circle"></i> El Problema con HTTP Polling
                    </h3>
                    <ul style="font-size: 0.95rem; line-height: 1.8; margin: 0; padding-left: 20px;">
                        <li><strong>Polling constante</strong>: Cliente pregunta cada X segundos</li>
                        <li><strong>Latencia alta</strong>: Espera hasta el siguiente poll</li>
                        <li><strong>Overhead de headers</strong>: Se repiten en cada solicitud</li>
                        <li><strong>Desperdicio de ancho de banda</strong>: Muchas respuestas vac√≠as</li>
                    </ul>
                </div>
            </div>

            <!-- Secci√≥n Derecha: Caracter√≠sticas WebSocket -->
            <div style="display: flex; flex-direction: column; gap: 1.5rem;">
                <div>
                    <h3 style="font-size: 1.2rem; margin-bottom: 1rem; color: var(--uide-accent);">
                        <i class="fas fa-rocket"></i> Soluci√≥n WebSocket
                    </h3>
                    <div style="display: flex; flex-direction: column; gap: 0.8rem;">
                        <div
                            style="background: rgba(233, 171, 33, 0.15); padding: 1rem; border-radius: 8px; border-left: 4px solid #4ade80;">
                            <strong style="color: #4ade80;">‚úì Full-Duplex</strong>
                            <p style="margin: 0.5rem 0 0 0; font-size: 0.9rem;">Bidireccional: cliente ‚Üî servidor</p>
                        </div>
                        <div
                            style="background: rgba(233, 171, 33, 0.15); padding: 1rem; border-radius: 8px; border-left: 4px solid #4ade80;">
                            <strong style="color: #4ade80;">‚úì Persistente</strong>
                            <p style="margin: 0.5rem 0 0 0; font-size: 0.9rem;">Una conexi√≥n abierta continuamente</p>
                        </div>
                        <div
                            style="background: rgba(233, 171, 33, 0.15); padding: 1rem; border-radius: 8px; border-left: 4px solid #4ade80;">
                            <strong style="color: #4ade80;">‚úì Bajo Overhead</strong>
                            <p style="margin: 0.5rem 0 0 0; font-size: 0.9rem;">Solo 2 bytes por frame despu√©s del
                                handshake</p>
                        </div>
                        <div
                            style="background: rgba(233, 171, 33, 0.15); padding: 1rem; border-radius: 8px; border-left: 4px solid #4ade80;">
                            <strong style="color: #4ade80;">‚úì Tiempo Real</strong>
                            <p style="margin: 0.5rem 0 0 0; font-size: 0.9rem;">Latencia de 5-20ms vs 150-250ms con
                                polling</p>
                        </div>
                    </div>
                </div>

                <div
                    style="background: rgba(100, 150, 255, 0.1); padding: 1rem; border-radius: 8px; border-left: 4px solid #60a5fa;">
                    <p style="margin: 0; font-size: 0.9rem;">
                        <i class="fas fa-info-circle"></i> <strong>Casos de uso</strong>: Notificaciones, chat en vivo,
                        soporte real-time
                    </p>
                </div>
            </div>
        </div>
    </div>

    <!-- Slide 9: WebSockets Diagrama -->
    <div class="slide">
        <h2 style="margin-bottom: 1.5rem;"><i class="fas fa-exchange-alt"></i> WebSocket: Comunicaci√≥n Full-Duplex</h2>

        <div style="height: calc(100vh - 200px); display: flex; align-items: center; justify-content: center;">
            <div
                style="width: 95%; height: 100%; background: rgba(15, 20, 25, 0.6); border-radius: 8px; padding: 10px;">
                <iframe
                    src="https://mermaid.live/view#pako:eNqVVdtu2zgQ_ZUBsQ8OIKuSHFmOHvqwadHuBUWwSVug1aKgxbHNWCa9JOU4G6Tf3qEuvrRZb-oXifScOWeuemClFshyZvGfGlWJrySfG74qFNBvzY2TpVxz5eCykqgcArdQsP7wEadFoQa_clVqEAh_6lt-VrAf0ddoNmhasH-XQhuPvtblEp1HtJh3mrxqb9pRBC0yhziEt1wJu-BLhLc3N1fwfk1KBfbQDjB8-bKHvHl9Ay_ubGP9Ig5jktphcrjDqW25C3WplcLSSa3yndNCXWM53Ckc_oH3OWy325arZRgSV8ea70ggjmK4vpOuXEg1hyujnS51ZX-GvIvI0D2Y-XSQJFGQpGlAz7P2r9O5SkIgt7glp_skA1rHpxWWUnAYzOqqGop6XeH2rOd7OosP7n5NmgvGa7coWABOL1H5i98_3oRhWLDHPfyJxBzhv-ild1FbNL8Jfxkno_O0cbF3Qo2zazdUG8lhhcryW9yb_I9UW09taeQUPVlJje24v07iKDpPx9nk4kg0tVXfoC2d0k7OZMlLSuAxZxffU-FNeUVj0DCutHI6hzSKogMaVOIwyn35evnvatxwcIYrO0ND00hSBDrqAi74IfSEil66b6hGip3761e41lY6Db_EaXQU_KmCl02xpNg5HsbflernlfyFThrS8XwZc3RfmqTwZkzssxvuGBSA4L4NPlPP_t15OCjJftj8oI0mQRI9b9hGNGwSjUG_AMtu7E4FdllpizCjLYsw8OuXllt0RPZEUKdBB3H8t9APfgxuaQVv2pUIV7qqaEflfrxoHVfctT03-JoOk2jVGFK7DJOUDmcBWKkazwvkwgfrn2gspW5NRRXawj3ghljoTSraNsSnkA4CLZljBbZb_WGhWMDmRgqWO1NjwFZoVtwf2YOPg4q3wBUNk6-j4GbpPxGPhKGvySetVz3M6Hq-YPmMV5ZO9ZpK3H_CdiaUHDSXulaO5WnjgeUPbMvyJM3CUTwZZ8l4ko2TcRawe5afj8OL8UV2kaTjNMvS81H6GLB_G84onGTp4zfXIE52"
                    style="width: 720px; height: 100%; border: 0; border-radius: 8px;"></iframe>
            </div>
        </div>
    </div>

    <!-- Slide 10: WebSockets Simulaciones Interactivas -->
    <div class="slide">
        <h2 style="margin-bottom: 1rem;"><i class="fas fa-play-circle"></i> WebSocket: Simulaciones Interactivas</h2>

        <div style="display: grid; grid-template-columns: 30% 70%; gap: 1.5rem; height: calc(100vh - 180px);">
            <!-- Controles Izquierda -->
            <div style="display: flex; flex-direction: column; gap: 1rem;">
                <!-- Tabs de Simulaciones -->
                <div style="display: flex; flex-direction: column; gap: 0.5rem;">
                    <button class="ws-tab active" data-demo="handshake"
                        style="padding: 10px; background: var(--uide-accent); color: #0f1419; border: none; border-radius: 4px; font-size: 0.9rem; cursor: pointer; font-weight: 600;">
                        <i class="fas fa-handshake"></i> Handshake
                    </button>
                    <button class="ws-tab" data-demo="chat"
                        style="padding: 10px; background: rgba(255,255,255,0.1); color: #e2e8f0; border: none; border-radius: 4px; font-size: 0.9rem; cursor: pointer; font-weight: 600;">
                        <i class="fas fa-comments"></i> Chat
                    </button>
                    <button class="ws-tab" data-demo="latency"
                        style="padding: 10px; background: rgba(255,255,255,0.1); color: #e2e8f0; border: none; border-radius: 4px; font-size: 0.9rem; cursor: pointer; font-weight: 600;">
                        <i class="fas fa-tachometer-alt"></i> Latencia
                    </button>
                </div>

                <div style="text-align: center;">
                    <button id="startWsDemo"
                        style="padding: 12px 16px; background: var(--uide-accent); color: #0f1419; border: none; border-radius: 6px; font-weight: 600; font-size: 1rem; cursor: pointer; transition: all 0.3s; width: 100%;">
                        <i class="fas fa-play"></i> Iniciar Demo
                    </button>
                </div>

                <div id="wsControls" style="margin-top: 1rem; font-size: 0.9rem;">
                    <label style="color: #e2e8f0; display: block; margin-bottom: 0.5rem;">Mensajes: </label>
                    <input type="number" id="wsMessages" value="5" min="3" max="10"
                        style="width: 100%; padding: 8px; background: rgba(255,255,255,0.1); border: 1px solid var(--uide-accent); color: white; border-radius: 4px; font-size: 0.9rem;">
                </div>

                <div style="background: rgba(233, 171, 33, 0.1); padding: 1rem; border-radius: 8px; margin-top: auto;">
                    <p style="font-size: 0.85rem; margin: 0; color: #e2e8f0;">
                        <i class="fas fa-info-circle"></i> <strong>Haz clic en los botones</strong> para explorar cada
                        caracter√≠stica
                    </p>
                </div>
            </div>

            <!-- Visualizaci√≥n Derecha -->
            <div id="wsDemoContainer" style="display: flex; flex-direction: column; gap: 1rem; height: 100%;">
                <!-- Demo Handshake -->
                <div id="demoHandshake" class="ws-demo-content"
                    style="display: flex; flex-direction: column; gap: 1rem; height: 100%;">
                    <div
                        style="background: rgba(15, 20, 25, 0.6); border-radius: 8px; border: 2px solid #f87171; padding: 1rem; flex: 1; display: flex; flex-direction: column; max-height: 48%;">
                        <h3 style="text-align: center; color: #f87171; margin: 0 0 0.8rem 0; font-size: 0.95rem;">
                            <i class="fas fa-times-circle"></i> HTTP Polling - M√∫ltiples Conexiones
                        </h3>
                        <div
                            style="flex: 1; background: rgba(0,0,0,0.3); border-radius: 6px; padding: 0.8rem; position: relative; overflow: hidden; min-height: 0;">
                            <canvas id="pollingCanvas" style="display: block;"></canvas>
                        </div>
                        <div id="pollingInfo"
                            style="text-align: center; margin-top: 0.6rem; font-size: 0.8rem; font-weight: 600; color: #f87171;">
                            Conexiones: -</div>
                    </div>

                    <div
                        style="background: rgba(15, 20, 25, 0.6); border-radius: 8px; border: 2px solid #4ade80; padding: 1rem; flex: 1; display: flex; flex-direction: column; max-height: 48%;">
                        <h3 style="text-align: center; color: #4ade80; margin: 0 0 0.8rem 0; font-size: 0.95rem;">
                            <i class="fas fa-check-circle"></i> WebSocket - Conexi√≥n Persistente
                        </h3>
                        <div
                            style="flex: 1; background: rgba(0,0,0,0.3); border-radius: 6px; padding: 0.8rem; position: relative; overflow: hidden; min-height: 0;">
                            <canvas id="wsCanvas" style="display: block;"></canvas>
                        </div>
                        <div id="wsInfo"
                            style="text-align: center; margin-top: 0.6rem; font-size: 0.8rem; font-weight: 600; color: #4ade80;">
                            Conexiones: -</div>
                    </div>

                    <div
                        style="text-align: center; padding: 0.8rem; background: rgba(233, 171, 33, 0.1); border-radius: 6px; flex-shrink: 0;">
                        <div id="wsHandshakeResult"
                            style="font-size: 0.9rem; font-weight: 600; color: var(--uide-accent);">
                            Comparaci√≥n de rendimiento
                        </div>
                    </div>
                </div>

                <!-- Demo Chat -->
                <div id="demoChat" class="ws-demo-content"
                    style="display: none; flex-direction: column; gap: 1rem; height: 100%;">
                    <div
                        style="background: rgba(15, 20, 25, 0.6); border-radius: 8px; border: 2px solid #4ade80; padding: 1rem; flex: 1; display: flex; flex-direction: column;">
                        <h3 style="text-align: center; color: #4ade80; margin: 0 0 0.8rem 0; font-size: 0.95rem;">
                            <i class="fas fa-comments"></i> Chat en Tiempo Real - WebSocket
                        </h3>
                        <div
                            style="flex: 1; background: rgba(0,0,0,0.3); border-radius: 6px; padding: 1rem; overflow-y: auto;">
                            <canvas id="chatCanvas" style="display: block;"></canvas>
                        </div>
                        <div id="chatInfo"
                            style="text-align: center; margin-top: 0.6rem; font-size: 0.8rem; font-weight: 600; color: #4ade80;">
                            Mensajes: -</div>
                    </div>

                    <div
                        style="text-align: center; padding: 0.8rem; background: rgba(233, 171, 33, 0.1); border-radius: 6px; flex-shrink: 0;">
                        <div id="chatResult" style="font-size: 0.9rem; font-weight: 600; color: var(--uide-accent);">
                            Presiona "Iniciar Demo" para ver el chat
                        </div>
                    </div>
                </div>

                <!-- Demo Latencia -->
                <div id="demoLatency" class="ws-demo-content"
                    style="display: none; flex-direction: column; gap: 1rem; height: 100%;">
                    <div
                        style="background: rgba(15, 20, 25, 0.6); border-radius: 8px; border: 2px solid #4ade80; padding: 1rem; flex: 1; display: flex; flex-direction: column;">
                        <h3 style="text-align: center; color: #4ade80; margin: 0 0 0.8rem 0; font-size: 0.95rem;">
                            <i class="fas fa-tachometer-alt"></i> Comparaci√≥n de Latencia
                        </h3>
                        <div
                            style="flex: 1; background: rgba(0,0,0,0.3); border-radius: 6px; padding: 1rem; overflow: hidden;">
                            <canvas id="latencyCanvas" style="display: block;"></canvas>
                        </div>
                        <div id="latencyInfo"
                            style="text-align: center; margin-top: 0.6rem; font-size: 0.8rem; font-weight: 600; color: #4ade80;">
                            Latencia promedio: -</div>
                    </div>

                    <div
                        style="text-align: center; padding: 0.8rem; background: rgba(233, 171, 33, 0.1); border-radius: 6px; flex-shrink: 0;">
                        <div id="latencyResult" style="font-size: 0.9rem; font-weight: 600; color: var(--uide-accent);">
                            Presiona "Iniciar Demo" para medir latencia
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Slide 11: WebSocket C√≥digo -->
    <div class="slide">
        <h2 style="margin-bottom: 1rem;"><i class="fas fa-code"></i> WebSocket: Ejemplos de C√≥digo

            <!-- Tabs de c√≥digo -->
            <div class="code-tabs-container" style="margin: 0;">
                <div class="code-tabs-header">
                    <button class="code-tab-btn active" data-tab="ws-cliente">
                        <i class="fas fa-desktop"></i> Cliente
                    </button>
                    <button class="code-tab-btn" data-tab="ws-servidor">
                        <i class="fas fa-server"></i> Servidor
                    </button>
                    <button class="code-tab-btn" data-tab="ws-notificaciones">
                        <i class="fas fa-bell"></i> Notificaciones
                    </button>
                </div>

                <!-- Tab Cliente WebSocket -->
                <div class="code-tab-content active" data-tab="ws-cliente">
                    <div class="code-container" style="margin: 0; border: none; border-radius: 0;">
                        <div class="code-header">
                            <div class="code-title">
                                <i class="fas fa-desktop"></i> cliente-websocket.js
                            </div>
                            <span class="code-language">JavaScript</span>
                        </div>
                        <div class="code-content" style="max-height: 450px;">
                            <pre class="line-numbers"><code class="language-javascript">// Cliente WebSocket para el Banco de Loja
// Notificaciones de transferencias en tiempo real 

class WebSocketCliente {
  #ws = null;
  #config = {
    url: 'ws://localhost:8080',
    token: 'JWT_TOKEN_USUARIO',
    cuenta: 'CTA-00123456',
    reconnectDelay: 5000
  };

  constructor(config = {}) {
    this.#config = { ...this.#config, ...config };
    this.conectar();
  }

  conectar() {
    this.#ws = new WebSocket(this.#config.url);

    this.#ws.addEventListener('open', this.#onOpen.bind(this));
    this.#ws.addEventListener('message', this.#onMessage.bind(this));
    this.#ws.addEventListener('error', this.#onError.bind(this));
    this.#ws.addEventListener('close', this.#onClose.bind(this));
  }

  #onOpen() {
    console.log('Conectado al servidor del Banco de Loja');

    // Autenticar usuario
    this.enviar({
      tipo: 'autenticacion',
      token: this.#config.token,
      cuenta: this.#config.cuenta
    });
  }

  #onMessage(event) {
    const mensaje = JSON.parse(event.data);

    // Usar pattern matching con object destructuring
    const handlers = {
      transferencia_recibida: () => this.#handleTransferenciaRecibida(mensaje),
      transferencia_enviada: () => this.#handleTransferenciaEnviada(mensaje),
      alerta_seguridad: () => this.#handleAlertaSeguridad(mensaje)
    };

    handlers[mensaje.tipo]?.();
  }

  #handleTransferenciaRecibida(mensaje) {
    this.mostrarNotificacion({
      titulo: 'Transferencia Recibida',
      monto: mensaje.monto,
      origen: mensaje.cuenta_origen,
      fecha: new Date(mensaje.timestamp)
    });
    this.actualizarSaldo(mensaje.saldo_nuevo);
  }

  #handleTransferenciaEnviada(mensaje) {
    console.log(`Transferencia enviada: $${mensaje.monto}`);
  }

  #handleAlertaSeguridad(mensaje) {
    this.mostrarAlerta(mensaje.descripcion);
  }

  #onError(error) {
    console.error('Error WebSocket:', error);
    this.mostrarError('Error de conexi√≥n con el servidor');
  }

  #onClose() {
    console.log('Conexi√≥n cerrada');
    setTimeout(() => {
      console.log('Reintentando conexi√≥n...');
      this.conectar();
    }, this.#config.reconnectDelay);
  }

  enviar(datos) {
    if (this.#ws?.readyState === WebSocket.OPEN) {
      this.#ws.send(JSON.stringify(datos));
    }
  }

  async mostrarNotificacion(datos) {
    // Verificar permisos de notificaci√≥n
    const permission = await Notification.requestPermission();

    if (permission === 'granted') {
      const notif = new Notification(datos.titulo, {
        body: `Monto: $${datos.monto}\nDesde: ${datos.origen}`,
        icon: '/banco-logo.png'
      });

      // Reproducir sonido
      const audio = new Audio('/notificacion.mp3');
      await audio.play().catch(err => console.log('Audio blocked:', err));
    }
  }

  actualizarSaldo(nuevoSaldo) {
    // Implementaci√≥n de actualizaci√≥n de saldo
    console.log(`Nuevo saldo: $${nuevoSaldo}`);
  }

  mostrarAlerta(descripcion) {
    // Implementaci√≥n de alerta
    console.warn('Alerta de seguridad:', descripcion);
  }

  mostrarError(mensaje) {
    // Implementaci√≥n de error
    console.error(mensaje);
  }

  desconectar() {
    this.#ws?.close();
  }
}

// Uso
const cliente = new WebSocketCliente();</code></pre>
                        </div>
                    </div>
                </div>

                <!-- Tab Servidor WebSocket -->
                <div class="code-tab-content" data-tab="ws-servidor">
                    <div class="code-container" style="margin: 0; border: none; border-radius: 0;">
                        <div class="code-header">
                            <div class="code-title">
                                <i class="fas fa-server"></i> servidor-websocket.js
                            </div>
                            <span class="code-language">Node.js</span>
                        </div>
                        <div class="code-content" style="max-height: 450px;">
                            <pre class="line-numbers"><code class="language-javascript">// Servidor WebSocket para notificaciones del Banco de Loja 
import { WebSocketServer, WebSocket } from 'ws';
import jwt from 'jsonwebtoken';

class ServidorWebSocket {
  #wss = null;
  #clientesPorCuenta = new Map();
  #config = {
    port: 8080,
    jwtSecret: process.env.JWT_SECRET
  };

  constructor(config = {}) {
    this.#config = { ...this.#config, ...config };
    this.iniciar();
  }

  iniciar() {
    this.#wss = new WebSocketServer({ port: this.#config.port });

    this.#wss.on('connection', this.#handleConnection.bind(this));

    console.log(`Servidor WebSocket iniciado en puerto ${this.#config.port}`);
  }

  #handleConnection(ws) {
    console.log('Nueva conexi√≥n establecida');

    let cuentaAutenticada = null;

    ws.on('message', async (mensaje) => {
      try {
        const datos = JSON.parse(mensaje.toString());
        await this.#procesarMensaje(ws, datos, (cuenta) => {
          cuentaAutenticada = cuenta;
        });
      } catch (error) {
        this.#enviarError(ws, 'Error al procesar mensaje');
      }
    });

    ws.on('close', () => {
      if (cuentaAutenticada) {
        this.#clientesPorCuenta.delete(cuentaAutenticada);
        console.log(`Cliente desconectado: ${cuentaAutenticada}`);
      }
    });

    ws.on('error', (error) => {
      console.error('Error en WebSocket:', error);
    });
  }

  async #procesarMensaje(ws, datos, setCuenta) {
    const handlers = {
      autenticacion: async () => await this.#handleAutenticacion(ws, datos, setCuenta)
    };

    await handlers[datos.tipo]?.();
  }

  async #handleAutenticacion(ws, datos, setCuenta) {
    try {
      // Verificar token JWT
      const payload = jwt.verify(datos.token, this.#config.jwtSecret);

      // Registrar cliente
      this.#clientesPorCuenta.set(datos.cuenta, ws);
      setCuenta(datos.cuenta);

      // Confirmar autenticaci√≥n
      this.#enviar(ws, {
        tipo: 'autenticacion_exitosa',
        mensaje: 'Conectado al sistema de notificaciones'
      });

      console.log(`Cliente autenticado: ${datos.cuenta}`);
    } catch (error) {
      this.#enviarError(ws, 'Token inv√°lido');
      ws.close();
    }
  }

  #enviar(ws, datos) {
    if (ws.readyState === WebSocket.OPEN) {
      ws.send(JSON.stringify(datos));
    }
  }

  #enviarError(ws, mensaje) {
    this.#enviar(ws, {
      tipo: 'error',
      mensaje
    });
  }

  // M√©todo p√∫blico para notificar transferencias
  notificarTransferencia(cuentaDestino, datosTransferencia) {
    const cliente = this.#clientesPorCuenta.get(cuentaDestino);

    if (cliente?.readyState === WebSocket.OPEN) {
      this.#enviar(cliente, {
        tipo: 'transferencia_recibida',
        monto: datosTransferencia.monto,
        cuenta_origen: datosTransferencia.origen,
        concepto: datosTransferencia.concepto,
        timestamp: new Date().toISOString(),
        saldo_nuevo: datosTransferencia.saldoNuevo
      });
    }
  }

  cerrar() {
    this.#wss?.close();
  }
}

// Exportar clase
export default ServidorWebSocket;

// Uso
const servidor = new ServidorWebSocket();</code></pre>
                        </div>
                    </div>
                </div>

                <!-- Tab Notificaciones en Tiempo Real -->
                <div class="code-tab-content" data-tab="ws-notificaciones">
                    <div class="code-container" style="margin: 0; border: none; border-radius: 0;">
                        <div class="code-header">
                            <div class="code-title">
                                <i class="fas fa-bell"></i> sistema-notificaciones.js
                            </div>
                            <span class="code-language">Node.js</span>
                        </div>
                        <div class="code-content" style="max-height: 450px;">
                            <pre class="line-numbers"><code class="language-javascript">// Sistema de notificaciones del Banco de Loja 
// Integraci√≥n con API de transferencias
import ServidorWebSocket from './servidor-websocket.js';
import express from 'express';

class APITransferencias {
  #app = express();
  #servidorWS = null;
  #config = {
    port: 3000
  };

  constructor(servidorWS, config = {}) {
    this.#servidorWS = servidorWS;
    this.#config = { ...this.#config, ...config };
    this.#configurarMiddleware();
    this.#configurarRutas();
  }

  #configurarMiddleware() {
    this.#app.use(express.json());
  }

  #configurarRutas() {
    this.#app.post('/api/transferencias', this.#procesarTransferencia.bind(this));
  }

  async #procesarTransferencia(req, res) {
    const { cuenta_origen, cuenta_destino, monto, concepto } = req.body;

    try {
      // 1. Validar saldo disponible
      const saldoOrigen = await this.#obtenerSaldo(cuenta_origen);

      if (saldoOrigen < monto) {
        return res.status(400).json({
          error: 'Saldo insuficiente',
          saldo_disponible: saldoOrigen
        });
      }

      // 2. Ejecutar transferencia en base de datos
      const transaccion = await this.#ejecutarTransferencia({
        origen: cuenta_origen,
        destino: cuenta_destino,
        monto,
        concepto
      });

      // 3. Actualizar saldos de manera at√≥mica
      await Promise.all([
        this.#actualizarSaldo(cuenta_origen, -monto),
        this.#actualizarSaldo(cuenta_destino, monto)
      ]);

      // 4. Obtener nuevo saldo y notificar v√≠a WebSocket al destinatario
      const saldoNuevo = await this.#obtenerSaldo(cuenta_destino);

      this.#servidorWS.notificarTransferencia(cuenta_destino, {
        monto,
        origen: cuenta_origen,
        concepto,
        saldoNuevo
      });

      res.json({
        success: true,
        transaccion_id: transaccion.id,
        mensaje: 'Transferencia exitosa',
        timestamp: new Date().toISOString()
      });

    } catch (error) {
      console.error('Error en transferencia:', error);

      res.status(500).json({
        error: 'Error al procesar transferencia',
        detalle: error.message
      });
    }
  }

  async #obtenerSaldo(cuenta) {
    // Simulaci√≥n - en producci√≥n: consulta a base de datos
    return 5000.00;
  }

  async #ejecutarTransferencia(datos) {
    // Simulaci√≥n - en producci√≥n: transacci√≥n SQL
    return {
      id: `TRX-${Date.now()}`,
      ...datos,
      timestamp: new Date().toISOString()
    };
  }

  async #actualizarSaldo(cuenta, diferencia) {
    // Simulaci√≥n - en producci√≥n: UPDATE a base de datos
    console.log(`Actualizando saldo de ${cuenta}: ${diferencia}`);
  }

  iniciar() {
    this.#app.listen(this.#config.port, () => {
      console.log(`API REST en puerto ${this.#config.port}`);
    });
  }
}

// Uso
const servidorWS = new ServidorWebSocket();
const api = new APITransferencias(servidorWS);
api.iniciar();</code></pre>
                        </div>
                    </div>
                </div>
            </div>
    </div>
    </div>
    </div>

    <div
        style="text-align: center; margin-top: 1.5rem; padding: 1rem; background: rgba(233, 171, 33, 0.1); border-radius: 8px;">
        <p style="color: var(--uide-accent); font-size: 0.9rem; margin: 0;">
            <i class="fas fa-lightbulb"></i>
            <strong>WebSocket</strong> permite notificaciones instant√°neas sin polling.
            El cliente recibe eventos en tiempo real cuando hay cambios en el servidor.
        </p>
    </div>
    </div>

    <!-- Slide 12: gRPC Teor√≠a -->
    <div class="slide">
        <h2 style="margin-bottom: 1.5rem;"><i class="fas fa-rocket"></i> gRPC: Remote Procedure Call Moderno - Teor√≠a
        </h2>

        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem; height: calc(100vh - 250px);">
            <!-- Secci√≥n Izquierda: Concepto y Motivaci√≥n -->
            <div style="display: flex; flex-direction: column; gap: 1.5rem;">
                <div class="quote"
                    style="font-size: 0.95rem; padding: 15px; margin: 0; border-left: 4px solid var(--uide-accent);">
                    "Microsservicios de alta velocidad con overhead m√≠nimo"
                </div>

                <div>
                    <h3 style="font-size: 1.1rem; margin-bottom: 1rem; color: var(--uide-accent);">
                        <i class="fas fa-question-circle"></i> ¬øQu√© es gRPC?
                    </h3>
                    <p style="font-size: 0.9rem; line-height: 1.7; margin: 0; color: #e2e8f0;">
                        Framework RPC moderno de Google que usa <strong>HTTP/2</strong> y <strong>Protocol
                            Buffers</strong> para comunicaci√≥n ultra-r√°pida entre servicios.
                    </p>
                </div>

                <div style="display: flex; flex-direction: column; gap: 0.8rem;">
                    <h3 style="font-size: 1.1rem; margin-bottom: 0.5rem; color: var(--uide-accent);">
                        <i class="fas fa-check-circle"></i> Ventajas Clave
                    </h3>
                    <div
                        style="background: rgba(74, 222, 128, 0.15); padding: 0.8rem; border-radius: 8px; border-left: 4px solid #4ade80;">
                        <strong style="color: #4ade80;">‚úì Binario Compacto</strong>
                        <p style="margin: 0.3rem 0 0 0; font-size: 0.8rem; color: #cbd5e1;">60-70% menor que JSON</p>
                    </div>
                    <div
                        style="background: rgba(96, 165, 250, 0.15); padding: 0.8rem; border-radius: 8px; border-left: 4px solid #60a5fa;">
                        <strong style="color: #60a5fa;">‚úì Multiplexaci√≥n Nativa</strong>
                        <p style="margin: 0.3rem 0 0 0; font-size: 0.8rem; color: #cbd5e1;">N requests paralelos en 1
                            conexi√≥n</p>
                    </div>
                    <div
                        style="background: rgba(168, 85, 247, 0.15); padding: 0.8rem; border-radius: 8px; border-left: 4px solid #a855f7;">
                        <strong style="color: #a855f7;">‚úì Baja Latencia</strong>
                        <p style="margin: 0.3rem 0 0 0; font-size: 0.8rem; color: #cbd5e1;">Ideal para microsservicios
                        </p>
                    </div>
                </div>
            </div>

            <!-- Secci√≥n Derecha: Caracter√≠sticas T√©cnicas -->
            <div style="display: flex; flex-direction: column; gap: 1.5rem;">
                <div>
                    <h3 style="font-size: 1.1rem; margin-bottom: 1rem; color: var(--uide-accent);">
                        <i class="fas fa-cogs"></i> Caracter√≠sticas T√©cnicas
                    </h3>
                    <div
                        style="background: rgba(15, 20, 25, 0.6); border-radius: 8px; padding: 1rem; border: 1px solid rgba(255, 255, 255, 0.1);">
                        <p style="font-size: 0.85rem; margin: 0 0 0.8rem 0; color: #e2e8f0;">
                            <strong>Protocol Buffers (.proto):</strong> Define esquema agn√≥stico del lenguaje
                        </p>
                        <p style="font-size: 0.85rem; margin: 0 0 0.8rem 0; color: #e2e8f0;">
                            <strong>Generaci√≥n autom√°tica:</strong> Compiler genera stubs cliente/servidor
                        </p>
                        <p style="font-size: 0.85rem; margin: 0 0 0.8rem 0; color: #e2e8f0;">
                            <strong>Type-Safe:</strong> Validaci√≥n de tipos en compilaci√≥n
                        </p>
                        <p style="font-size: 0.85rem; margin: 0; color: #e2e8f0;">
                            <strong>Versionamiento:</strong> Evoluci√≥n segura de APIs
                        </p>
                    </div>
                </div>

                <div>
                    <h3 style="font-size: 1.1rem; margin-bottom: 1rem; color: var(--uide-accent);">
                        <i class="fas fa-network-wired"></i> Comparaci√≥n con Alternativas
                    </h3>
                    <div style="display: flex; flex-direction: column; gap: 0.6rem; font-size: 0.85rem;">
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 0.5rem;">
                            <div
                                style="background: rgba(248, 113, 113, 0.1); padding: 0.6rem; border-radius: 6px; border-left: 3px solid #f87171;">
                                <strong style="color: #f87171;">REST/JSON</strong>
                                <p style="margin: 0.3rem 0 0 0; font-size: 0.75rem; color: #cbd5e1;">Texto legible,
                                    mayor overhead</p>
                            </div>
                            <div
                                style="background: rgba(34, 197, 94, 0.1); padding: 0.6rem; border-radius: 6px; border-left: 3px solid #22c55e;">
                                <strong style="color: #22c55e;">gRPC</strong>
                                <p style="margin: 0.3rem 0 0 0; font-size: 0.75rem; color: #cbd5e1;">Binario compacto,
                                    ultra-r√°pido</p>
                            </div>
                        </div>
                    </div>
                </div>

                <div
                    style="background: rgba(233, 171, 33, 0.1); padding: 1rem; border-radius: 8px; border-left: 4px solid var(--uide-accent); margin-top: auto;">
                    <p style="margin: 0; font-size: 0.85rem; color: #e2e8f0;">
                        <i class="fas fa-lightbulb"></i> <strong>Ideal para:</strong> Microservicios internos de alto
                        rendimiento
                    </p>
                </div>
            </div>
        </div>
    </div>

    <!-- Slide 13: gRPC Diagrama -->
    <div class="slide">
        <h2 style="margin-bottom: 1.5rem;"><i class="fas fa-project-diagram"></i> gRPC: Arquitectura y Tipos de
            Streaming</h2>
        <div style="height: calc(100vh - 200px); display: flex; align-items: center; justify-content: center;">
            <div
                style="width: 95%; height: 100%; background: rgba(15, 20, 25, 0.6); border-radius: 8px; padding: 10px;">
                <iframe
                    src="https://mermaid.live/view#pako:eNqNVM1um0AQfpXRSpUSFWMwxrE5WEqdqq6StpbsXlp62MAabwu7dHeJklh-kb5DT32EvFhnATt2lETmAsPO9803Oz9rksiUkYho9rtiImEXnGaKFrEAfEqqDE94SYWBSc6ZMAyohpi0RhyLk_OyhHdUJBJSBlfyJz2NyTNoKUQLlYLd8od_AhaTGTz8ETyhzyHmTN0w1WDsN0-lguliMev2rHsD-CxRkbR-rSKngUWwF-ZqDkwbep2zhKd0C1UsMaCy65NeEDj-me8EwWlz8jrxpyo3vMyRXGTQgblRjBbaSqc5y6Xe8rf5tA7gRzCneSofD-3TknfG47db_g_vF9ClJe_q2j0WLcHHiwj8Q3QD6SC60xJF0PM8-HIJ62uaY1HwR-h53uZFGirSrcIggoWiQtMk4Xh5-nilpoEZhOnDSMHRgr-7rvvjRfCezDCCGVNLnh-vr1QS_dkhe3j8XQpaoBUTlBiTzYs0TKSNUX886TLf8xzkc_D9bJs18Z1d7Lb9Z5VeAeq3t3uz1zyt3PF4B5h9nU-hi32OE9TNZSbdUmSHWntH47W5y5l2E_2knv3XE_RDTDIMj5qj6ex8cokDNJFFqZiuRxU3yIrRlCn9hCFnSwNyCTu109oNFnaqUWJUMLOSaV1za-pkxWzNVsaUNgVa4bHi99T2aAS2kIcBFM9WdYSdvMMAJwXXhYREYnSBq2gvxcfO22LnMpfw8FekPGHaJmWXD7UsFFUoCWdeZ-i9Od27TOKQTPGUREZVzCEFUwW1Jllbp5gYm09MbBemVP2yG3CDGNyU36QstjAlq2xFoiXNNVpVmVKzXeg7FwzH1ERWwpAorBlItCa3JMI96Ab-cBD6Q6_vjwI8vMO_I3c0GA2DYOCFQb8_DDYOua9Deu7wLNz8B-cy860"
                    style="width: 720px; height: 100%; border: 0; border-radius: 8px;"></iframe>
            </div>
        </div>

    </div>

    <!-- Slide 14: gRPC Simulaciones -->
    <div class="slide">
        <h2 style="margin-bottom: 1rem;"><i class="fas fa-play-circle"></i> gRPC: Simulaciones Interactivas</h2>

        <div style="display: grid; grid-template-columns: 25% 75%; gap: 1.5rem; height: calc(100vh - 180px);">
            <!-- Controles Izquierda -->
            <div style="display: flex; flex-direction: column; gap: 1rem;">
                <!-- Tabs de Simulaciones -->
                <div style="display: flex; flex-direction: column; gap: 0.5rem;">
                    <button class="grpc-tab active" data-demo="rpc"
                        style="padding: 10px; background: var(--uide-accent); color: #0f1419; border: none; border-radius: 4px; font-size: 0.9rem; cursor: pointer; font-weight: 600;">
                        <i class="fas fa-arrows-alt-h"></i> RPC Flow
                    </button>
                    <button class="grpc-tab" data-demo="payload"
                        style="padding: 10px; background: rgba(255,255,255,0.1); color: #e2e8f0; border: none; border-radius: 4px; font-size: 0.9rem; cursor: pointer; font-weight: 600;">
                        <i class="fas fa-compress-alt"></i> JSON vs Protobuf
                    </button>
                </div>

                <div style="text-align: center;">
                    <button id="startGrpcDemo"
                        style="padding: 12px 16px; background: var(--uide-accent); color: #0f1419; border: none; border-radius: 6px; font-weight: 600; font-size: 1rem; cursor: pointer; transition: all 0.3s; width: 100%;">
                        <i class="fas fa-play"></i> Iniciar Demo
                    </button>
                </div>

                <div style="background: rgba(233, 171, 33, 0.1); padding: 1rem; border-radius: 8px; margin-top: auto;">
                    <p style="font-size: 0.85rem; margin: 0; color: #e2e8f0;">
                        <i class="fas fa-info-circle"></i> <strong>Haz clic en los botones</strong> para explorar
                        simulaciones de gRPC
                    </p>
                </div>
            </div>

            <!-- Visualizaci√≥n Derecha -->
            <div id="grpcDemoContainer" style="display: flex; flex-direction: column; gap: 1rem; height: 100%;">
                <!-- Demo RPC Flow -->
                <div id="demoRpc" class="grpc-demo-content"
                    style="display: flex; flex-direction: column; gap: 1rem; height: 100%;">
                    <div
                        style="background: rgba(15, 20, 25, 0.6); border-radius: 8px; border: 2px solid #4ade80; padding: 1rem; flex: 1; display: flex; flex-direction: column; min-height: 0;">
                        <h3
                            style="text-align: center; color: #4ade80; margin: 0 0 0.8rem 0; font-size: 0.95rem; flex-shrink: 0;">
                            <i class="fas fa-rocket"></i> gRPC Remote Procedure Call
                        </h3>
                        <div
                            style="flex: 1; background: rgba(0,0,0,0.3); border-radius: 6px; padding: 0.8rem; overflow: hidden; min-height: 0;">
                            <canvas id="rpcCanvas" style="display: block;"></canvas>
                        </div>
                        <div id="rpcInfo"
                            style="text-align: center; margin-top: 0.6rem; font-size: 0.8rem; font-weight: 600; color: #4ade80; flex-shrink: 0;">
                            Tiempo: -</div>
                    </div>

                    <div
                        style="text-align: center; padding: 0.8rem; background: rgba(233, 171, 33, 0.1); border-radius: 6px; flex-shrink: 0;">
                        <div id="rpcResult" style="font-size: 0.9rem; font-weight: 600; color: var(--uide-accent);">
                            Presiona "Iniciar Demo" para ver el flujo RPC
                        </div>
                    </div>
                </div>

                <!-- Demo Payload Comparison -->
                <div id="demoPayload" class="grpc-demo-content"
                    style="display: none; flex-direction: column; gap: 1rem; height: 100%;">
                    <div
                        style="background: rgba(15, 20, 25, 0.6); border-radius: 8px; border: 2px solid #60a5fa; padding: 1rem; flex: 1; display: flex; flex-direction: column; min-height: 0; max-height: 48%;">
                        <h3
                            style="text-align: center; color: #60a5fa; margin: 0 0 0.8rem 0; font-size: 0.95rem; flex-shrink: 0;">
                            <i class="fas fa-file-code"></i> JSON (Texto)
                        </h3>
                        <div
                            style="flex: 1; background: rgba(0,0,0,0.3); border-radius: 6px; padding: 0.8rem; overflow-y: auto; min-height: 0;">
                            <canvas id="jsonCanvas" style="display: block;"></canvas>
                        </div>
                        <div id="jsonSize"
                            style="text-align: center; margin-top: 0.6rem; font-size: 0.8rem; font-weight: 600; color: #60a5fa; flex-shrink: 0;">
                            Tama√±o: -</div>
                    </div>

                    <div
                        style="background: rgba(15, 20, 25, 0.6); border-radius: 8px; border: 2px solid #4ade80; padding: 1rem; flex: 1; display: flex; flex-direction: column; min-height: 0; max-height: 48%;">
                        <h3
                            style="text-align: center; color: #4ade80; margin: 0 0 0.8rem 0; font-size: 0.95rem; flex-shrink: 0;">
                            <i class="fas fa-file-binary"></i> Protobuf (Binario)
                        </h3>
                        <div
                            style="flex: 1; background: rgba(0,0,0,0.3); border-radius: 6px; padding: 0.8rem; overflow-y: auto; min-height: 0;">
                            <canvas id="protobufCanvas" style="display: block;"></canvas>
                        </div>
                        <div id="protobufSize"
                            style="text-align: center; margin-top: 0.6rem; font-size: 0.8rem; font-weight: 600; color: #4ade80; flex-shrink: 0;">
                            Tama√±o: -</div>
                    </div>

                    <div
                        style="text-align: center; padding: 0.8rem; background: rgba(233, 171, 33, 0.1); border-radius: 6px; flex-shrink: 0;">
                        <div id="payloadResult" style="font-size: 0.9rem; font-weight: 600; color: var(--uide-accent);">
                            Presiona "Iniciar Demo" para comparar tama√±os
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Slide 15: gRPC C√≥digo -->
    <div class="slide">
        <h2 style="margin-bottom: 1rem;"><i class="fas fa-code"></i> gRPC: Ejemplos de C√≥digo</h2>

        <!-- Tabs de c√≥digo -->
        <div class="code-tabs-container" style="margin: 0;">
            <div class="code-tabs-header">
                <button class="code-tab-btn active" data-tab="grpc-proto">
                    <i class="fas fa-file-contract"></i> .proto
                </button>
                <button class="code-tab-btn" data-tab="grpc-server">
                    <i class="fas fa-server"></i> Servidor
                </button>
                <button class="code-tab-btn" data-tab="grpc-client">
                    <i class="fas fa-desktop"></i> Cliente
                </button>
            </div>

            <!-- Tab .proto Definition -->
            <div class="code-tab-content active" data-tab="grpc-proto">
                <div class="code-container" style="margin: 0; border: none; border-radius: 0;">
                    <div class="code-header">
                        <div class="code-title">
                            <i class="fas fa-file-contract"></i> banco.proto
                        </div>
                        <span class="code-language">Protocol Buffers</span>
                    </div>
                    <div class="code-content" style="max-height: 450px;">
                        <pre class="line-numbers"><code class="language-protobuf">syntax = "proto3";

package banco.loja;

// Servicio de Transferencias del Banco de Loja
service TransferenciaService {
  // RPC unario: Una solicitud, una respuesta
  rpc TransferirFondos(TransferenciaRequest) returns (TransferenciaResponse);

  // RPC streaming del servidor: Una solicitud, m√∫ltiples respuestas
  rpc ConsultarMovimientos(ConsultaRequest) returns (stream Movimiento);

  // RPC streaming bidireccional: Cliente y servidor env√≠an streams
  rpc MonitorearTransacciones(stream MonitorRequest) returns (stream MonitorResponse);
}

// Mensaje de solicitud de transferencia
message TransferenciaRequest {
  string cuenta_origen = 1;
  string cuenta_destino = 2;
  double monto = 3;
  string concepto = 4;
  string referencia = 5;
}

// Mensaje de respuesta de transferencia
message TransferenciaResponse {
  bool exitoso = 1;
  string transaccion_id = 2;
  double saldo_disponible = 3;
  string mensaje = 4;
  int64 timestamp = 5;
}

// Mensaje de consulta de movimientos
message ConsultaRequest {
  string cuenta = 1;
  int64 fecha_inicio = 2;
  int64 fecha_fin = 3;
}

// Mensaje de movimiento individual
message Movimiento {
  string id = 1;
  string tipo = 2;  // "CREDITO" o "DEBITO"
  double monto = 3;
  string concepto = 4;
  int64 fecha = 5;
}

// Mensajes para monitoring en tiempo real
message MonitorRequest {
  string cuenta = 1;
}

message MonitorResponse {
  string evento = 1;
  string detalle = 2;
  int64 timestamp = 3;
}</code></pre>
                    </div>
                </div>
            </div>

            <!-- Tab Servidor gRPC -->
            <div class="code-tab-content" data-tab="grpc-server">
                <div class="code-container" style="margin: 0; border: none; border-radius: 0;">
                    <div class="code-header">
                        <div class="code-title">
                            <i class="fas fa-server"></i> servidor-grpc.js
                        </div>
                        <span class="code-language">Node.js ES2025</span>
                    </div>
                    <div class="code-content" style="max-height: 450px;">
                        <pre class="line-numbers"><code class="language-javascript">// Servidor gRPC del Banco de Loja 
import grpc from '@grpc/grpc-js';
import protoLoader from '@grpc/proto-loader';
import { fileURLToPath } from 'url';
import { dirname, join } from 'path';

const __filename = fileURLToPath(import.meta.url);
const __dirname = dirname(__filename);

class ServidorGRPC {
  #server = null;
  #proto = null;
  #config = {
    port: '0.0.0.0:50051',
    protoPath: join(__dirname, 'banco.proto')
  };

  constructor(config = {}) {
    this.#config = { ...this.#config, ...config };
    this.#cargarProto();
  }

  #cargarProto() {
    const packageDefinition = protoLoader.loadSync(this.#config.protoPath, {
      keepCase: true,
      longs: String,
      enums: String,
      defaults: true,
      oneofs: true
    });

    this.#proto = grpc.loadPackageDefinition(packageDefinition).banco.loja;
  }

  // 1. RPC Unario: TransferirFondos
  async #transferirFondos(call, callback) {
    const { cuenta_origen, cuenta_destino, monto, concepto } = call.request;

    console.log(`Transferencia: $${monto} de ${cuenta_origen} a ${cuenta_destino}`);

    try {
      const saldoDisponible = 5000.00;

      if (monto > saldoDisponible) {
        callback({
          code: grpc.status.FAILED_PRECONDITION,
          message: 'Saldo insuficiente'
        });
        return;
      }

      const response = {
        exitoso: true,
        transaccion_id: `TRX-${Date.now()}`,
        saldo_disponible: saldoDisponible - monto,
        mensaje: 'Transferencia procesada exitosamente',
        timestamp: Date.now()
      };

      callback(null, response);
    } catch (error) {
      callback({
        code: grpc.status.INTERNAL,
        message: error.message
      });
    }
  }

  // 2. RPC Streaming del Servidor: ConsultarMovimientos
  #consultarMovimientos(call) {
    const { cuenta, fecha_inicio, fecha_fin } = call.request;

    console.log(`Consultando movimientos de ${cuenta}`);

    const movimientos = [
      { id: 'MOV-001', tipo: 'CREDITO', monto: 1500.00, concepto: 'Dep√≥sito', fecha: Date.now() - 86400000 },
      { id: 'MOV-002', tipo: 'DEBITO', monto: 500.00, concepto: 'Retiro ATM', fecha: Date.now() - 43200000 },
      { id: 'MOV-003', tipo: 'CREDITO', monto: 2000.00, concepto: 'Transferencia recibida', fecha: Date.now() - 7200000 },
      { id: 'MOV-004', tipo: 'DEBITO', monto: 300.00, concepto: 'Pago servicios', fecha: Date.now() - 3600000 }
    ];

    // Enviar cada movimiento como stream
    movimientos.forEach((mov, index) => {
      setTimeout(() => {
        call.write(mov);
        if (index === movimientos.length - 1) {
          call.end();
        }
      }, index * 200);
    });
  }

  // 3. RPC Streaming Bidireccional: MonitorearTransacciones
  #monitorearTransacciones(call) {
    call.on('data', (request) => {
      console.log(`Monitoreando cuenta: ${request.cuenta}`);

      const eventos = ['INICIO_SESION', 'TRANSFERENCIA_ENVIADA', 'TRANSFERENCIA_RECIBIDA'];

      eventos.forEach((evento, index) => {
        setTimeout(() => {
          call.write({
            evento,
            detalle: `Evento de cuenta ${request.cuenta}`,
            timestamp: Date.now()
          });
        }, index * 1000);
      });
    });

    call.on('end', () => {
      call.end();
    });

    call.on('error', (error) => {
      console.error('Error en stream:', error);
    });
  }

  async iniciar() {
    this.#server = new grpc.Server();

    this.#server.addService(this.#proto.TransferenciaService.service, {
      TransferirFondos: this.#transferirFondos.bind(this),
      ConsultarMovimientos: this.#consultarMovimientos.bind(this),
      MonitorearTransacciones: this.#monitorearTransacciones.bind(this)
    });

    return new Promise((resolve, reject) => {
      this.#server.bindAsync(
        this.#config.port,
        grpc.ServerCredentials.createInsecure(),
        (err, port) => {
          if (err) {
            console.error('Error al iniciar servidor:', err);
            reject(err);
            return;
          }
          console.log(`Servidor gRPC escuchando en puerto ${port}`);
          this.#server.start();
          resolve(port);
        }
      );
    });
  }

  detener() {
    return new Promise((resolve) => {
      this.#server?.tryShutdown(() => {
        console.log('Servidor gRPC detenido');
        resolve();
      });
    });
  }
}

// Uso
const servidor = new ServidorGRPC();
await servidor.iniciar();</code></pre>
                    </div>
                </div>
            </div>

            <!-- Tab Cliente gRPC -->
            <div class="code-tab-content" data-tab="grpc-client">
                <div class="code-container" style="margin: 0; border: none; border-radius: 0;">
                    <div class="code-header">
                        <div class="code-title">
                            <i class="fas fa-desktop"></i> cliente-grpc.js
                        </div>
                        <span class="code-language">Node.js ES2025</span>
                    </div>
                    <div class="code-content" style="max-height: 450px;">
                        <pre class="line-numbers"><code class="language-javascript">// Cliente gRPC del Banco de Loja 
import grpc from '@grpc/grpc-js';
import protoLoader from '@grpc/proto-loader';
import { fileURLToPath } from 'url';
import { dirname, join } from 'path';

const __filename = fileURLToPath(import.meta.url);
const __dirname = dirname(__filename);

class ClienteGRPC {
  #client = null;
  #config = {
    serverUrl: 'localhost:50051',
    protoPath: join(__dirname, 'banco.proto')
  };

  constructor(config = {}) {
    this.#config = { ...this.#config, ...config };
    this.#conectar();
  }

  #conectar() {
    const packageDefinition = protoLoader.loadSync(this.#config.protoPath, {
      keepCase: true,
      longs: String,
      enums: String,
      defaults: true,
      oneofs: true
    });

    const bancoProto = grpc.loadPackageDefinition(packageDefinition).banco.loja;

    this.#client = new bancoProto.TransferenciaService(
      this.#config.serverUrl,
      grpc.credentials.createInsecure()
    );
  }

  // ===== EJEMPLO 1: RPC Unario =====
  async transferirFondos(datosTransferencia) {
    console.log('\n=== Realizando transferencia (RPC Unario) ===');

    return new Promise((resolve, reject) => {
      this.#client.TransferirFondos(datosTransferencia, (error, response) => {
        if (error) {
          console.error('Error en transferencia:', error.message);
          reject(error);
          return;
        }

        console.log('Transferencia exitosa:');
        console.log(`  ID: ${response.transaccion_id}`);
        console.log(`  Saldo disponible: $${response.saldo_disponible}`);
        console.log(`  Mensaje: ${response.mensaje}`);

        resolve(response);
      });
    });
  }

  // ===== EJEMPLO 2: RPC Streaming del Servidor =====
  async consultarMovimientos(consultaParams) {
    console.log('\n=== Consultando movimientos (Streaming del Servidor) ===');

    return new Promise((resolve, reject) => {
      const movimientos = [];
      const call = this.#client.ConsultarMovimientos(consultaParams);

      call.on('data', (movimiento) => {
        const signo = movimiento.tipo === 'CREDITO' ? '+' : '-';
        console.log(`${signo} $${movimiento.monto} - ${movimiento.concepto}`);
        movimientos.push(movimiento);
      });

      call.on('end', () => {
        console.log('Consulta de movimientos completada');
        resolve(movimientos);
      });

      call.on('error', (error) => {
        console.error('Error:', error.message);
        reject(error);
      });
    });
  }

  // ===== EJEMPLO 3: RPC Streaming Bidireccional =====
  monitorearTransacciones(cuenta, duracionMs = 5000) {
    console.log('\n=== Monitoreando transacciones ===');

    const call = this.#client.MonitorearTransacciones();

    call.on('data', (response) => {
      const fecha = new Date(parseInt(response.timestamp));
      console.log(`[${fecha.toISOString()}] ${response.evento}: ${response.detalle}`);
    });

    call.on('end', () => {
      console.log('Monitoreo finalizado');
    });

    call.on('error', (error) => {
      console.error('Error en monitoreo:', error.message);
    });

    call.write({ cuenta });

    setTimeout(() => {
      call.end();
    }, duracionMs);

    return call;
  }
}

// ===== USO DEL CLIENTE =====
const cliente = new ClienteGRPC();

// Ejemplo 1: Transferencia
await cliente.transferirFondos({
  cuenta_origen: 'CTA-00123456',
  cuenta_destino: 'CTA-00789012',
  monto: 1500.00,
  concepto: 'Pago de servicios',
  referencia: 'REF-001'
});

// Ejemplo 2: Consultar movimientos
const movimientos = await cliente.consultarMovimientos({
  cuenta: 'CTA-00123456',
  fecha_inicio: Date.now() - 30 * 86400000,
  fecha_fin: Date.now()
});

// Ejemplo 3: Monitorear transacciones
cliente.monitorearTransacciones('CTA-00123456', 5000);</code></pre>
                    </div>
                </div>
            </div>
        </div>

        <div
            style="text-align: center; margin-top: 1.5rem; padding: 1rem; background: rgba(233, 171, 33, 0.1); border-radius: 8px;">
            <p style="color: var(--uide-accent); font-size: 0.9rem; margin: 0;">
                <i class="fas fa-rocket"></i>
                <strong>gRPC</strong> combina HTTP/2 y Protocol Buffers para comunicaci√≥n ultra-r√°pida entre
                microsservicios
                con soporte para RPC unario, streaming del servidor, cliente y bidireccional.
            </p>
        </div>
    </div>
    </div>



    <!-- Slide 16: gRPC Limitaciones -->
    <div class="slide">
        <h2 style="margin-bottom: 0.8rem;"><i class="fas fa-exclamation-triangle"></i> gRPC: Limitaciones y
            Trade-offs</h2>

        <div
            style="display: grid; grid-template-columns: 40% 60%; gap: 20px; height: calc(100vh - 200px); max-height: 640px;">
            <!-- Columna Izquierda: Caracter√≠sticas -->
            <div style="display: flex; flex-direction: column; gap: 10px; height: 100%;">
                <div class="quote" style="font-size: 0.8rem; padding: 10px; margin: 0;">
                    "M√°s dependencias = m√°s actualizaciones frecuentes"
                </div>

                <div style="flex-shrink: 0;">
                    <h3 style="font-size: 0.95rem; margin-bottom: 6px;">Complejidad</h3>
                    <ul style="font-size: 0.8rem; line-height: 1.4; margin: 0; padding-left: 18px;">
                        <li><strong>Dependencias</strong>: Numerosas</li>
                        <li><strong>Actualizaciones</strong>: Frecuentes</li>
                        <li><strong>Acoplamiento</strong>: Fuerte</li>
                        <li><strong>Debugging</strong>: Complejo</li>
                    </ul>
                </div>

                <div
                    style="background: rgba(248, 113, 113, 0.1); padding: 8px; border-radius: 8px; border-left: 4px solid #f87171; flex-shrink: 0;">
                    <p style="font-size: 0.75rem; margin: 0;">
                        <i class="fas fa-exclamation-triangle"></i> HTTP/2 requerido
                    </p>
                </div>

                <!-- Pesta√±as de Demos -->
                <div style="display: flex; gap: 4px; flex-shrink: 0;">
                    <button class="grpc-limit-tab active" data-demo="dependencies"
                        style="flex: 1; padding: 6px; background: var(--uide-accent); color: #0f1419; border: none; border-radius: 4px; font-size: 0.7rem; cursor: pointer; font-weight: 600;">
                        Dependencias
                    </button>
                    <button class="grpc-limit-tab" data-demo="updates"
                        style="flex: 1; padding: 6px; background: rgba(255,255,255,0.1); color: #e2e8f0; border: none; border-radius: 4px; font-size: 0.7rem; cursor: pointer; font-weight: 600;">
                        Actualizaciones
                    </button>
                </div>

                <div style="text-align: center; margin-top: auto; flex-shrink: 0;">
                    <button id="startGrpcLimitDemo"
                        style="padding: 8px 12px; background: var(--uide-accent); color: #0f1419; border: none; border-radius: 6px; font-weight: 600; font-size: 0.85rem; cursor: pointer; transition: all 0.3s; width: 100%;">
                        <i class="fas fa-play"></i> Iniciar Demo
                    </button>
                </div>
            </div>

            <!-- Columna Derecha: Visualizaci√≥n -->
            <div id="grpcLimitDemoContainer" style="display: flex; flex-direction: column; gap: 12px; height: 100%;">
                <!-- Demo Dependencias -->
                <div id="demoDependencies" class="grpc-limit-demo-content"
                    style="display: flex; flex-direction: column; gap: 12px; height: 100%;">
                    <div
                        style="background: rgba(15, 20, 25, 0.6); border-radius: 8px; border: 2px solid #f87171; padding: 10px; flex: 1; display: flex; flex-direction: column;">
                        <h3 style="text-align: center; color: #f87171; margin: 0 0 8px 0; font-size: 0.9rem;">
                            <i class="fas fa-project-diagram"></i> Gr√°fico de Dependencias
                        </h3>
                        <div
                            style="flex: 1; background: rgba(0,0,0,0.3); border-radius: 6px; padding: 12px; overflow: hidden; height: 450px;">
                            <canvas id="dependenciesCanvas" style="display: block;"></canvas>
                        </div>
                        <div id="dependenciesInfo"
                            style="text-align: center; margin-top: 6px; font-size: 0.75rem; font-weight: 600; color: #f87171;">
                            Dependencias: -</div>
                    </div>

                    <div
                        style="text-align: center; padding: 8px; background: rgba(233, 171, 33, 0.1); border-radius: 6px; flex-shrink: 0;">
                        <div id="dependenciesResult"
                            style="font-size: 0.85rem; font-weight: 600; color: var(--uide-accent);">
                            Presiona "Iniciar Demo" para ver las dependencias
                        </div>
                    </div>
                </div>

                <!-- Demo Actualizaciones -->
                <div id="demoUpdates" class="grpc-limit-demo-content"
                    style="display: none; flex-direction: column; gap: 12px; height: 100%;">
                    <div
                        style="background: rgba(15, 20, 25, 0.6); border-radius: 8px; border: 2px solid #fbbf24; padding: 10px; flex: 1; display: flex; flex-direction: column;">
                        <h3 style="text-align: center; color: #fbbf24; margin: 0 0 8px 0; font-size: 0.9rem;">
                            <i class="fas fa-clock"></i> Timeline de Actualizaciones
                        </h3>
                        <div
                            style="flex: 1; background: rgba(0,0,0,0.3); border-radius: 6px; padding: 12px; overflow-y: auto; height: 450px;">
                            <canvas id="updatesCanvas" style="display: block;"></canvas>
                        </div>
                        <div id="updatesInfo"
                            style="text-align: center; margin-top: 6px; font-size: 0.75rem; font-weight: 600; color: #fbbf24;">
                            Frecuencia: -</div>
                    </div>

                    <div
                        style="text-align: center; padding: 8px; background: rgba(233, 171, 33, 0.1); border-radius: 6px; flex-shrink: 0;">
                        <div id="updatesResult"
                            style="font-size: 0.85rem; font-weight: 600; color: var(--uide-accent);">
                            Presiona "Iniciar Demo" para ver el timeline
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>



    <!-- Slide 8: JSON -->
    <div class="slide">
        <h2 style="margin-bottom: 0.8rem;"><i class="fas fa-file-code"></i> JSON: Formato de Serializaci√≥n Popular
        </h2>

        <div
            style="display: grid; grid-template-columns: 40% 60%; gap: 20px; height: calc(100vh - 200px); max-height: 640px;">
            <!-- Columna Izquierda: Caracter√≠sticas -->
            <div style="display: flex; flex-direction: column; gap: 10px; height: 100%;">
                <div class="quote" style="font-size: 0.8rem; padding: 10px; margin: 0;">
                    "API REST p√∫blica para partners del Banco de Loja"
                </div>

                <div style="flex-shrink: 0;">
                    <h3 style="font-size: 0.95rem; margin-bottom: 6px;">Ventajas</h3>
                    <ul style="font-size: 0.8rem; line-height: 1.4; margin: 0; padding-left: 18px;">
                        <li><strong>Legible</strong>: Human-readable</li>
                        <li><strong>Simple</strong>: F√°cil de usar</li>
                        <li><strong>Universal</strong>: Amplio soporte</li>
                        <li><strong>Compacto</strong>: M√°s que XML</li>
                    </ul>
                </div>

                <div
                    style="background: rgba(233, 171, 33, 0.1); padding: 8px; border-radius: 8px; border-left: 4px solid var(--uide-accent); flex-shrink: 0;">
                    <p style="font-size: 0.75rem; margin: 0;">
                        <i class="fas fa-info-circle"></i> API p√∫blica y app m√≥vil
                    </p>
                </div>

                <!-- Pesta√±as de Demos -->
                <div style="display: flex; gap: 4px; flex-shrink: 0;">
                    <button class="json-tab active" data-demo="editor"
                        style="flex: 1; padding: 6px; background: var(--uide-accent); color: #0f1419; border: none; border-radius: 4px; font-size: 0.7rem; cursor: pointer; font-weight: 600;">
                        Editor
                    </button>
                    <button class="json-tab" data-demo="validation"
                        style="flex: 1; padding: 6px; background: rgba(255,255,255,0.1); color: #e2e8f0; border: none; border-radius: 4px; font-size: 0.7rem; cursor: pointer; font-weight: 600;">
                        Validaci√≥n
                    </button>

                </div>

                <div style="text-align: center; margin-top: auto; flex-shrink: 0;">
                    <button id="startJsonDemo"
                        style="padding: 8px 12px; background: var(--uide-accent); color: #0f1419; border: none; border-radius: 6px; font-weight: 600; font-size: 0.85rem; cursor: pointer; transition: all 0.3s; width: 100%;">
                        <i class="fas fa-play"></i> Iniciar Demo
                    </button>
                </div>
            </div>

            <!-- Columna Derecha: Visualizaci√≥n -->
            <div id="jsonDemoContainer" style="display: flex; flex-direction: column; gap: 12px; height: 100%;">
                <!-- Demo Editor -->
                <div id="demoEditor" class="json-demo-content"
                    style="display: flex; flex-direction: column; gap: 12px; height: 100%;">
                    <div
                        style="background: rgba(15, 20, 25, 0.6); border-radius: 8px; border: 2px solid #60a5fa; padding: 10px; flex: 1; display: flex; flex-direction: column;">
                        <h3 style="text-align: center; color: #60a5fa; margin: 0 0 8px 0; font-size: 0.9rem;">
                            <i class="fas fa-code"></i> Editor JSON Interactivo
                        </h3>
                        <div
                            style="flex: 1; background: rgba(0,0,0,0.3); border-radius: 6px; padding: 12px; overflow-y: auto; height: 450px;">
                            <canvas id="jsonEditorCanvas" style="display: block;"></canvas>
                        </div>
                        <div id="jsonEditorInfo"
                            style="text-align: center; margin-top: 6px; font-size: 0.75rem; font-weight: 600; color: #60a5fa;">
                            Tama√±o: -</div>
                    </div>

                    <div
                        style="text-align: center; padding: 8px; background: rgba(233, 171, 33, 0.1); border-radius: 6px; flex-shrink: 0;">
                        <div id="jsonEditorResult"
                            style="font-size: 0.85rem; font-weight: 600; color: var(--uide-accent);">
                            Presiona "Iniciar Demo" para ver el editor
                        </div>
                    </div>
                </div>

                <!-- Demo Validaci√≥n -->
                <div id="demoValidation" class="json-demo-content"
                    style="display: none; flex-direction: column; gap: 12px; height: 100%;">
                    <div
                        style="background: rgba(15, 20, 25, 0.6); border-radius: 8px; border: 2px solid #f87171; padding: 10px; flex: 1; display: flex; flex-direction: column; max-height: 48%;">
                        <h3 style="text-align: center; color: #f87171; margin: 0 0 8px 0; font-size: 0.9rem;">
                            <i class="fas fa-times-circle"></i> JSON Inv√°lido
                        </h3>
                        <div
                            style="flex: 1; background: rgba(0,0,0,0.3); border-radius: 6px; padding: 12px; overflow-y: auto; height: 200px;">
                            <canvas id="jsonInvalidCanvas" style="display: block;"></canvas>
                        </div>
                        <div id="jsonInvalidInfo"
                            style="text-align: center; margin-top: 6px; font-size: 0.75rem; font-weight: 600; color: #f87171;">
                            Error: -</div>
                    </div>

                    <div
                        style="background: rgba(15, 20, 25, 0.6); border-radius: 8px; border: 2px solid #4ade80; padding: 10px; flex: 1; display: flex; flex-direction: column; max-height: 48%;">
                        <h3 style="text-align: center; color: #4ade80; margin: 0 0 8px 0; font-size: 0.9rem;">
                            <i class="fas fa-check-circle"></i> JSON V√°lido
                        </h3>
                        <div
                            style="flex: 1; background: rgba(0,0,0,0.3); border-radius: 6px; padding: 12px; overflow-y: auto; height: 200px;">
                            <canvas id="jsonValidCanvas" style="display: block;"></canvas>
                        </div>
                        <div id="jsonValidInfo"
                            style="text-align: center; margin-top: 6px; font-size: 0.75rem; font-weight: 600; color: #4ade80;">
                            Estado: -</div>
                    </div>

                    <div
                        style="text-align: center; padding: 8px; background: rgba(233, 171, 33, 0.1); border-radius: 6px; flex-shrink: 0;">
                        <div id="jsonValidationResult"
                            style="font-size: 0.85rem; font-weight: 600; color: var(--uide-accent);">
                            Presiona "Iniciar Demo" para ver la validaci√≥n
                        </div>
                    </div>
                </div>

                <!-- Demo C√≥digo -->
                <div id="demoCodigo" class="json-demo-content"
                    style="display: none; flex-direction: column; gap: 10px; height: 100%;">
                    <div class="code-subtabs-container"
                        style="display: flex; gap: 8px; padding: 8px; background: rgba(15, 20, 25, 0.4); border-radius: 8px;">
                        <button class="json-code-subtab active" data-subtab="schema"
                            style="flex: 1; padding: 8px 12px; background: var(--uide-accent); color: #0f1419; border: none; border-radius: 6px; font-size: 0.75rem; cursor: pointer; font-weight: 600; transition: all 0.2s;">
                            Schema
                        </button>
                        <button class="json-code-subtab" data-subtab="validador"
                            style="flex: 1; padding: 8px 12px; background: rgba(255,255,255,0.1); color: #e2e8f0; border: none; border-radius: 6px; font-size: 0.75rem; cursor: pointer; font-weight: 600; transition: all 0.2s;">
                            Validador
                        </button>
                        <button class="json-code-subtab" data-subtab="api"
                            style="flex: 1; padding: 8px 12px; background: rgba(255,255,255,0.1); color: #e2e8f0; border: none; border-radius: 6px; font-size: 0.75rem; cursor: pointer; font-weight: 600; transition: all 0.2s;">
                            API
                        </button>
                    </div>

                    <!-- Schema Definition -->
                    <div id="jsonCodeSchema" class="json-code-content" style="display: flex; flex: 1; min-height: 0;">
                        <div class="code-container"
                            style="flex: 1; overflow: hidden; display: flex; flex-direction: column;">
                            <div class="code-header">
                                <span class="code-filename">transaccion.schema.json</span>
                                <button class="code-copy-btn" onclick="copyCode(this)">
                                    <i class="fas fa-copy"></i> Copiar
                                </button>
                            </div>
                            <div style="flex: 1; overflow-y: auto;">
                                <pre style="margin: 0;"><code class="language-json">{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://bancodeloja.fin.ec/schemas/transaccion.json",
  "title": "Transacci√≥n Bancaria",
  "description": "Esquema de validaci√≥n para transacciones del Banco de Loja",
  "type": "object",
  "required": ["id", "tipo", "origen", "destino", "monto", "fecha"],
  "properties": {
    "id": {
      "type": "string",
      "pattern": "^TXN-[0-9]{10}$",
      "description": "Identificador √∫nico de transacci√≥n"
    },
    "tipo": {
      "type": "string",
      "enum": ["transferencia", "pago", "retiro", "deposito"],
      "description": "Tipo de operaci√≥n bancaria"
    },
    "origen": {
      "type": "object",
      "required": ["cuenta", "titular"],
      "properties": {
        "cuenta": {
          "type": "string",
          "pattern": "^[0-9]{10}$",
          "description": "N√∫mero de cuenta de 10 d√≠gitos"
        },
        "titular": {
          "type": "string",
          "minLength": 3,
          "maxLength": 100
        },
        "banco": {
          "type": "string",
          "default": "Banco de Loja"
        }
      }
    },
    "destino": {
      "type": "object",
      "required": ["cuenta", "titular"],
      "properties": {
        "cuenta": {
          "type": "string",
          "pattern": "^[0-9]{10}$"
        },
        "titular": {
          "type": "string",
          "minLength": 3,
          "maxLength": 100
        },
        "banco": {
          "type": "string"
        }
      }
    },
    "monto": {
      "type": "number",
      "minimum": 0.01,
      "maximum": 50000,
      "multipleOf": 0.01,
      "description": "Monto en USD, m√°ximo $50,000"
    },
    "fecha": {
      "type": "string",
      "format": "date-time",
      "description": "Fecha y hora en formato ISO 8601"
    },
    "descripcion": {
      "type": "string",
      "maxLength": 500
    },
    "metadata": {
      "type": "object",
      "properties": {
        "ip": {
          "type": "string",
          "format": "ipv4"
        },
        "dispositivo": {
          "type": "string"
        },
        "geolocalizacion": {
          "type": "object",
          "properties": {
            "lat": { "type": "number", "minimum": -90, "maximum": 90 },
            "lon": { "type": "number", "minimum": -180, "maximum": 180 }
          }
        }
      }
    }
  }
}</code></pre>
                            </div>
                        </div>
                    </div>

                    <!-- Validador -->
                    <div id="jsonCodeValidador" class="json-code-content"
                        style="display: none; flex: 1; min-height: 0;">
                        <div class="code-container"
                            style="flex: 1; overflow: hidden; display: flex; flex-direction: column;">
                            <div class="code-header">
                                <span class="code-filename">validador.js</span>
                                <button class="code-copy-btn" onclick="copyCode(this)">
                                    <i class="fas fa-copy"></i> Copiar
                                </button>
                            </div>
                            <div style="flex: 1; overflow-y: auto;">
                                <pre style="margin: 0;"><code class="language-javascript">import Ajv from 'ajv';
import addFormats from 'ajv-formats';
import { readFile } from 'fs/promises';

class ValidadorTransacciones {
  #ajv;
  #schema;
  #validador;

  constructor() {
    this.#ajv = new Ajv({
      allErrors: true,
      verbose: true,
      strict: false,
      coerceTypes: false
    });
    addFormats(this.#ajv);
  }

  async cargarSchema(rutaSchema) {
    const contenido = await readFile(rutaSchema, 'utf-8');
    this.#schema = JSON.parse(contenido);
    this.#validador = this.#ajv.compile(this.#schema);
    console.log('Schema cargado correctamente');
  }

  validar(transaccion) {
    const valido = this.#validador(transaccion);

    if (valido) {
      return {
        valido: true,
        mensaje: 'Transacci√≥n v√°lida'
      };
    }

    const errores = this.#validador.errors?.map(error => ({
      campo: error.instancePath || error.params?.missingProperty,
      tipo: error.keyword,
      mensaje: error.message,
      valorActual: error.data
    })) ?? [];

    return {
      valido: false,
      errores,
      mensaje: `Validaci√≥n fallida: ${errores.length} error(es) encontrado(s)`
    };
  }

  async validarLote(transacciones) {
    const resultados = {
      total: transacciones.length,
      validas: 0,
      invalidas: 0,
      detalles: []
    };

    for (const [index, transaccion] of transacciones.entries()) {
      const resultado = this.validar(transaccion);

      if (resultado.valido) {
        resultados.validas++;
      } else {
        resultados.invalidas++;
        resultados.detalles.push({
          indice: index,
          id: transaccion?.id ?? 'sin-id',
          errores: resultado.errores
        });
      }
    }

    return resultados;
  }
}

// Ejemplo de uso
const validador = new ValidadorTransacciones();
await validador.cargarSchema('./transaccion.schema.json');

// Transacci√≥n v√°lida
const transaccionValida = {
  id: 'TXN-1234567890',
  tipo: 'transferencia',
  origen: {
    cuenta: '1234567890',
    titular: 'Juan P√©rez'
  },
  destino: {
    cuenta: '0987654321',
    titular: 'Mar√≠a Garc√≠a',
    banco: 'Banco Pichincha'
  },
  monto: 150.50,
  fecha: new Date().toISOString(),
  descripcion: 'Pago de servicios'
};

const resultado1 = validador.validar(transaccionValida);
console.log('Resultado:', resultado1);

// Transacci√≥n inv√°lida
const transaccionInvalida = {
  id: 'TXN-123',
  tipo: 'hackeo',
  origen: { cuenta: '123', titular: 'X' },
  monto: -500
};

const resultado2 = validador.validar(transaccionInvalida);
console.log('Errores encontrados:', resultado2.errores?.length ?? 0);</code></pre>
                            </div>
                        </div>
                    </div>

                    <!-- API Integration -->
                    <div id="jsonCodeApi" class="json-code-content" style="display: none; flex: 1; min-height: 0;">
                        <div class="code-container"
                            style="flex: 1; overflow: hidden; display: flex; flex-direction: column;">
                            <div class="code-header">
                                <span class="code-filename">api-transacciones.js</span>
                                <button class="code-copy-btn" onclick="copyCode(this)">
                                    <i class="fas fa-copy"></i> Copiar
                                </button>
                            </div>
                            <div style="flex: 1; overflow-y: auto;">
                                <pre style="margin: 0;"><code class="language-javascript">import express from 'express';
import { ValidadorTransacciones } from './validador.js';

class APITransacciones {
  #app;
  #validador;
  #puerto;

  constructor(puerto = 3000) {
    this.#app = express();
    this.#validador = new ValidadorTransacciones();
    this.#puerto = puerto;

    this.#configurarMiddleware();
    this.#configurarRutas();
  }

  #configurarMiddleware() {
    this.#app.use(express.json());

    this.#app.use((err, req, res, next) => {
      if (err instanceof SyntaxError && err.status === 400) {
        return res.status(400).json({
          error: 'JSON inv√°lido',
          mensaje: err.message
        });
      }
      next();
    });
  }

  #configurarRutas() {
    this.#app.post('/api/transacciones', async (req, res) => {
      try {
        const resultado = this.#validador.validar(req.body);

        if (!resultado.valido) {
          return res.status(400).json({
            error: 'Validaci√≥n fallida',
            detalles: resultado.errores
          });
        }

        const transaccionProcesada = await this.#procesarTransaccion(req.body);

        res.status(201).json({
          mensaje: 'Transacci√≥n procesada exitosamente',
          id: transaccionProcesada.id,
          estado: 'completada',
          timestamp: new Date().toISOString()
        });
      } catch (error) {
        console.error('Error procesando transacci√≥n:', error);
        res.status(500).json({
          error: 'Error interno del servidor',
          mensaje: error?.message ?? 'Error desconocido'
        });
      }
    });

    this.#app.post('/api/transacciones/lote', async (req, res) => {
      try {
        const { transacciones } = req.body;

        if (!Array.isArray(transacciones)) {
          return res.status(400).json({
            error: 'El campo "transacciones" debe ser un array'
          });
        }

        const resultados = await this.#validador.validarLote(transacciones);

        res.json({
          mensaje: 'Validaci√≥n de lote completada',
          resumen: {
            total: resultados.total,
            validas: resultados.validas,
            invalidas: resultados.invalidas,
            tasa_exito: ((resultados.validas / resultados.total) * 100).toFixed(2) + '%'
          },
          errores: resultados.detalles
        });
      } catch (error) {
        res.status(500).json({
          error: 'Error procesando lote',
          mensaje: error?.message ?? 'Error desconocido'
        });
      }
    });

    this.#app.get('/api/schema', (req, res) => {
      res.json(this.#validador.obtenerSchema());
    });
  }

  async #procesarTransaccion(transaccion) {
    await new Promise(resolve => setTimeout(resolve, 100));

    return {
      ...transaccion,
      estado: 'completada',
      timestamp_procesamiento: new Date().toISOString()
    };
  }

  async iniciar() {
    await this.#validador.cargarSchema('./transaccion.schema.json');

    this.#app.listen(this.#puerto, () => {
      console.log(`API escuchando en puerto ${this.#puerto}`);
      console.log(`POST /api/transacciones - Procesar transacci√≥n`);
      console.log(`POST /api/transacciones/lote - Validar lote`);
      console.log(`GET  /api/schema - Obtener schema`);
    });
  }
}

// Iniciar servidor
const api = new APITransacciones(3000);
await api.iniciar();</code></pre>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts externos para JSON -->
    <script src="js/json-inline-demos.js"></script>


    <!-- Slide 9: Protobuf -->
    <div class="slide">
        <h2 style="margin-bottom: 0.8rem;"><i class="fas fa-cogs"></i> Protocol Buffers: Serializaci√≥n Eficiente
        </h2>

        <div
            style="display: grid; grid-template-columns: 40% 60%; gap: 20px; height: calc(100vh - 200px); max-height: 640px;">
            <!-- Columna Izquierda: Caracter√≠sticas -->
            <div style="display: flex; flex-direction: column; gap: 10px; height: 100%;">
                <div class="quote" style="font-size: 0.8rem; padding: 10px; margin: 0;">
                    "Esquemas de datos para transacciones bancarias"
                </div>

                <div style="flex-shrink: 0;">
                    <h3 style="font-size: 0.95rem; margin-bottom: 6px;">Caracter√≠sticas</h3>
                    <ul style="font-size: 0.8rem; line-height: 1.4; margin: 0; padding-left: 18px;">
                        <li><strong>Binario</strong>: Muy compacto</li>
                        <li><strong>R√°pido</strong>: Alta velocidad</li>
                        <li><strong>Multiplataforma</strong>: Varios lenguajes</li>
                        <li><strong>Evoluci√≥n</strong>: Sin ruptura</li>
                    </ul>
                </div>

                <div
                    style="background: rgba(233, 171, 33, 0.1); padding: 8px; border-radius: 8px; border-left: 4px solid var(--uide-accent); flex-shrink: 0;">
                    <p style="font-size: 0.75rem; margin: 0;">
                        <i class="fas fa-info-circle"></i> Field numbers = compatibilidad
                    </p>
                </div>

                <!-- Pesta√±as de Demos -->
                <div style="display: flex; gap: 4px; flex-shrink: 0;">
                    <button class="protobuf-tab active" data-demo="code"
                        style="flex: 1; padding: 6px; background: var(--uide-accent); color: #0f1419; border: none; border-radius: 4px; font-size: 0.7rem; cursor: pointer; font-weight: 600;">
                        C√≥digo
                    </button>
                    <button class="protobuf-tab" data-demo="evolution"
                        style="flex: 1; padding: 6px; background: rgba(255,255,255,0.1); color: #e2e8f0; border: none; border-radius: 4px; font-size: 0.7rem; cursor: pointer; font-weight: 600;">
                        Evoluci√≥n
                    </button>
                </div>

                <div style="text-align: center; margin-top: auto; flex-shrink: 0;">
                    <button id="startProtobufDemo"
                        style="padding: 8px 12px; background: var(--uide-accent); color: #0f1419; border: none; border-radius: 6px; font-weight: 600; font-size: 0.85rem; cursor: pointer; transition: all 0.3s; width: 100%;">
                        <i class="fas fa-play"></i> Iniciar Demo
                    </button>
                    <div id="protobufControls" style="margin-top: 6px; font-size: 0.75rem;">
                        <label style="color: #e2e8f0;">Lenguaje: </label>
                        <select id="protobufLang"
                            style="padding: 3px; background: rgba(255,255,255,0.1); border: 1px solid var(--uide-accent); color: white; border-radius: 4px; font-size: 0.75rem;">
                            <option value="python">Python</option>
                            <option value="java">Java</option>
                            <option value="go">Go</option>
                        </select>
                    </div>
                </div>
            </div>

            <!-- Columna Derecha: Visualizaci√≥n -->
            <div id="protobufDemoContainer" style="display: flex; flex-direction: column; gap: 12px; height: 100%;">
                <!-- Demo C√≥digo -->
                <div id="demoCode" class="protobuf-demo-content"
                    style="display: flex; flex-direction: column; gap: 12px; height: 100%;">
                    <div
                        style="background: rgba(15, 20, 25, 0.6); border-radius: 8px; border: 2px solid #a78bfa; padding: 10px; flex: 1; display: flex; flex-direction: column; max-height: 48%;">
                        <h3 style="text-align: center; color: #a78bfa; margin: 0 0 8px 0; font-size: 0.9rem;">
                            <i class="fas fa-file-code"></i> Definici√≥n .proto
                        </h3>
                        <div
                            style="flex: 1; background: rgba(0,0,0,0.3); border-radius: 6px; padding: 12px; overflow-y: auto; height: 200px;">
                            <canvas id="protoDefCanvas" style="display: block;"></canvas>
                        </div>
                        <div id="protoDefInfo"
                            style="text-align: center; margin-top: 6px; font-size: 0.75rem; font-weight: 600; color: #a78bfa;">
                            Archivo: user.proto</div>
                    </div>

                    <div
                        style="background: rgba(15, 20, 25, 0.6); border-radius: 8px; border: 2px solid #4ade80; padding: 10px; flex: 1; display: flex; flex-direction: column; max-height: 48%;">
                        <h3 style="text-align: center; color: #4ade80; margin: 0 0 8px 0; font-size: 0.9rem;">
                            <i class="fas fa-code"></i> C√≥digo Generado
                        </h3>
                        <div
                            style="flex: 1; background: rgba(0,0,0,0.3); border-radius: 6px; padding: 12px; overflow-y: auto; height: 200px;">
                            <canvas id="generatedCodeCanvas" style="display: block;"></canvas>
                        </div>
                        <div id="generatedCodeInfo"
                            style="text-align: center; margin-top: 6px; font-size: 0.75rem; font-weight: 600; color: #4ade80;">
                            Lenguaje: -</div>
                    </div>

                    <div
                        style="text-align: center; padding: 8px; background: rgba(233, 171, 33, 0.1); border-radius: 6px; flex-shrink: 0;">
                        <div id="protoCodeResult"
                            style="font-size: 0.85rem; font-weight: 600; color: var(--uide-accent);">
                            Presiona "Iniciar Demo" para ver la generaci√≥n de c√≥digo
                        </div>
                    </div>
                </div>

                <!-- Demo Evoluci√≥n -->
                <div id="demoEvolution" class="protobuf-demo-content"
                    style="display: none; flex-direction: column; gap: 12px; height: 100%;">
                    <div
                        style="background: rgba(15, 20, 25, 0.6); border-radius: 8px; border: 2px solid #4ade80; padding: 10px; flex: 1; display: flex; flex-direction: column;">
                        <h3 style="text-align: center; color: #4ade80; margin: 0 0 8px 0; font-size: 0.9rem;">
                            <i class="fas fa-code-branch"></i> Evoluci√≥n de Esquema
                        </h3>
                        <div
                            style="flex: 1; background: rgba(0,0,0,0.3); border-radius: 6px; padding: 12px; overflow-y: auto; height: 450px;">
                            <canvas id="evolutionCanvas" style="display: block;"></canvas>
                        </div>
                        <div id="evolutionInfo"
                            style="text-align: center; margin-top: 6px; font-size: 0.75rem; font-weight: 600; color: #4ade80;">
                            Versi√≥n: -</div>
                    </div>

                    <div
                        style="text-align: center; padding: 8px; background: rgba(233, 171, 33, 0.1); border-radius: 6px; flex-shrink: 0;">
                        <div id="evolutionResult"
                            style="font-size: 0.85rem; font-weight: 600; color: var(--uide-accent);">
                            Presiona "Iniciar Demo" para ver la evoluci√≥n
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts externos para Protobuf -->
    <script src="protobuf-inline-demos.js"></script>

    <!-- Slide 10: Protobuf C√≥digo -->
    <div class="slide">
        <h2 style="margin-bottom: 0.8rem;"><i class="fas fa-code"></i> Protobuf: Compilador y FieldMask</h2>

        <div
            style="display: grid; grid-template-columns: 40% 60%; gap: 20px; height: calc(100vh - 200px); max-height: 640px;">
            <!-- Columna Izquierda: Caracter√≠sticas -->
            <div style="display: flex; flex-direction: column; gap: 10px; height: 100%;">
                <div class="quote" style="font-size: 0.8rem; padding: 10px; margin: 0;">
                    "Generaci√≥n de c√≥digo para backend Python y sistemas legacy Java"
                </div>

                <div style="flex-shrink: 0;">
                    <h3 style="font-size: 0.95rem; margin-bottom: 6px;">Proceso</h3>
                    <ul style="font-size: 0.8rem; line-height: 1.4; margin: 0; padding-left: 18px;">
                        <li><strong>Definici√≥n</strong>: .proto</li>
                        <li><strong>Compilaci√≥n</strong>: protoc</li>
                        <li><strong>Generaci√≥n</strong>: Stubs</li>
                        <li><strong>Integraci√≥n</strong>: C√≥digo</li>
                    </ul>
                </div>

                <div
                    style="background: rgba(233, 171, 33, 0.1); padding: 8px; border-radius: 8px; border-left: 4px solid var(--uide-accent); flex-shrink: 0;">
                    <p style="font-size: 0.75rem; margin: 0;">
                        <i class="fas fa-info-circle"></i> Optimiza respuestas m√≥viles
                    </p>
                </div>

                <!-- Pesta√±as de Demos -->
                <div style="display: flex; gap: 4px; flex-shrink: 0;">
                    <button class="protoc-tab active" data-demo="compiler"
                        style="flex: 1; padding: 6px; background: var(--uide-accent); color: #0f1419; border: none; border-radius: 4px; font-size: 0.7rem; cursor: pointer; font-weight: 600;">
                        Compilador
                    </button>
                    <button class="protoc-tab" data-demo="fieldmask"
                        style="flex: 1; padding: 6px; background: rgba(255,255,255,0.1); color: #e2e8f0; border: none; border-radius: 4px; font-size: 0.7rem; cursor: pointer; font-weight: 600;">
                        FieldMask
                    </button>
                </div>

                <div style="text-align: center; margin-top: auto; flex-shrink: 0;">
                    <button id="startProtocDemo"
                        style="padding: 8px 12px; background: var(--uide-accent); color: #0f1419; border: none; border-radius: 6px; font-weight: 600; font-size: 0.85rem; cursor: pointer; transition: all 0.3s; width: 100%;">
                        <i class="fas fa-play"></i> Iniciar Demo
                    </button>
                </div>
            </div>

            <!-- Columna Derecha: Visualizaci√≥n -->
            <div id="protocDemoContainer" style="display: flex; flex-direction: column; gap: 12px; height: 100%;">
                <!-- Demo Compilador -->
                <div id="demoCompiler" class="protoc-demo-content"
                    style="display: flex; flex-direction: column; gap: 12px; height: 100%;">
                    <div
                        style="background: rgba(15, 20, 25, 0.6); border-radius: 8px; border: 2px solid #4ade80; padding: 10px; flex: 1; display: flex; flex-direction: column;">
                        <h3 style="text-align: center; color: #4ade80; margin: 0 0 8px 0; font-size: 0.9rem;">
                            <i class="fas fa-cogs"></i> Flujo del Compilador protoc
                        </h3>
                        <div
                            style="flex: 1; background: rgba(0,0,0,0.3); border-radius: 6px; padding: 12px; overflow: hidden; height: 450px;">
                            <canvas id="compilerFlowCanvas" style="display: block;"></canvas>
                        </div>
                        <div id="compilerFlowInfo"
                            style="text-align: center; margin-top: 6px; font-size: 0.75rem; font-weight: 600; color: #4ade80;">
                            Paso: -</div>
                    </div>

                    <div
                        style="text-align: center; padding: 8px; background: rgba(233, 171, 33, 0.1); border-radius: 6px; flex-shrink: 0;">
                        <div id="compilerFlowResult"
                            style="font-size: 0.85rem; font-weight: 600; color: var(--uide-accent);">
                            Presiona "Iniciar Demo" para ver el flujo de compilaci√≥n
                        </div>
                    </div>
                </div>

                <!-- Demo FieldMask -->
                <div id="demoFieldmask" class="protoc-demo-content"
                    style="display: none; flex-direction: column; gap: 12px; height: 100%;">
                    <div
                        style="background: rgba(15, 20, 25, 0.6); border-radius: 8px; border: 2px solid #60a5fa; padding: 10px; flex: 1; display: flex; flex-direction: column; min-height: 0;">
                        <h3
                            style="text-align: center; color: #60a5fa; margin: 0 0 8px 0; font-size: 0.9rem; flex-shrink: 0;">
                            <i class="fas fa-filter"></i> FieldMask Interactivo
                        </h3>
                        <div
                            style="flex: 1; background: rgba(0,0,0,0.3); border-radius: 6px; padding: 12px; overflow-y: auto; min-height: 0; display: flex; flex-direction: column;">
                            <div style="margin-bottom: 15px; flex-shrink: 0;">
                                <p style="color: #e2e8f0; font-size: 0.85rem; margin-bottom: 10px;">
                                    <strong>Selecciona los campos que deseas recibir:</strong>
                                </p>
                                <div id="fieldMaskCheckboxes"
                                    style="display: grid; grid-template-columns: 1fr 1fr; gap: 6px;">
                                    <label
                                        style="color: #ffffff; font-size: 0.8rem; cursor: pointer; display: flex; align-items: center; gap: 6px;">
                                        <input type="checkbox" class="field-checkbox" value="id" checked
                                            style="width: 14px; height: 14px; cursor: pointer;">
                                        <span>id</span>
                                    </label>
                                    <label
                                        style="color: #ffffff; font-size: 0.8rem; cursor: pointer; display: flex; align-items: center; gap: 6px;">
                                        <input type="checkbox" class="field-checkbox" value="name" checked
                                            style="width: 14px; height: 14px; cursor: pointer;">
                                        <span>name</span>
                                    </label>
                                    <label
                                        style="color: #ffffff; font-size: 0.8rem; cursor: pointer; display: flex; align-items: center; gap: 6px;">
                                        <input type="checkbox" class="field-checkbox" value="email"
                                            style="width: 14px; height: 14px; cursor: pointer;">
                                        <span>email</span>
                                    </label>
                                    <label
                                        style="color: #ffffff; font-size: 0.8rem; cursor: pointer; display: flex; align-items: center; gap: 6px;">
                                        <input type="checkbox" class="field-checkbox" value="age"
                                            style="width: 14px; height: 14px; cursor: pointer;">
                                        <span>age</span>
                                    </label>
                                    <label
                                        style="color: #ffffff; font-size: 0.8rem; cursor: pointer; display: flex; align-items: center; gap: 6px;">
                                        <input type="checkbox" class="field-checkbox" value="roles"
                                            style="width: 14px; height: 14px; cursor: pointer;">
                                        <span>roles</span>
                                    </label>
                                    <label
                                        style="color: #ffffff; font-size: 0.8rem; cursor: pointer; display: flex; align-items: center; gap: 6px;">
                                        <input type="checkbox" class="field-checkbox" value="metadata.created"
                                            style="width: 14px; height: 14px; cursor: pointer;">
                                        <span>metadata.created</span>
                                    </label>
                                    <label
                                        style="color: #ffffff; font-size: 0.8rem; cursor: pointer; display: flex; align-items: center; gap: 6px; grid-column: span 2;">
                                        <input type="checkbox" class="field-checkbox" value="metadata.lastLogin"
                                            style="width: 14px; height: 14px; cursor: pointer;">
                                        <span>metadata.lastLogin</span>
                                    </label>
                                </div>
                            </div>
                            <div style="flex: 1; min-height: 0; position: relative;">
                                <canvas id="fieldMaskCanvas" style="display: block; width: 100%;"></canvas>
                            </div>
                        </div>
                        <div id="fieldMaskInfo"
                            style="text-align: center; margin-top: 6px; font-size: 0.75rem; font-weight: 600; color: #60a5fa; flex-shrink: 0;">
                            Campos seleccionados: -</div>
                    </div>

                    <div
                        style="text-align: center; padding: 8px; background: rgba(233, 171, 33, 0.1); border-radius: 6px; flex-shrink: 0;">
                        <div id="fieldMaskResult"
                            style="font-size: 0.85rem; font-weight: 600; color: var(--uide-accent);">
                            Presiona "Iniciar Demo" para aplicar FieldMask
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ===== PROTOC SIMULACIONES =====
        let currentProtocDemo = 'compiler';

        document.addEventListener('DOMContentLoaded', function () {
            // Tabs de demos Protoc
            const protocTabs = document.querySelectorAll('.protoc-tab');
            protocTabs.forEach(tab => {
                tab.addEventListener('click', function () {
                    const demoType = this.getAttribute('data-demo');
                    switchProtocDemo(demoType);
                });
            });

            // Bot√≥n iniciar demo
            const startProtocDemo = document.getElementById('startProtocDemo');
            if (startProtocDemo) {
                startProtocDemo.addEventListener('click', function () {
                    if (currentProtocDemo === 'compiler') {
                        runCompilerFlowDemo();
                    } else if (currentProtocDemo === 'fieldmask') {
                        runFieldMaskDemo();
                    }
                });
            }

            // Checkboxes de FieldMask - actualizar autom√°ticamente
            const checkboxes = document.querySelectorAll('.field-checkbox');
            checkboxes.forEach(cb => {
                cb.addEventListener('change', function () {
                    if (currentProtocDemo === 'fieldmask') {
                        runFieldMaskDemo();
                    }
                });
            });
        });

        // ===== DEMO 1: FLUJO DEL COMPILADOR ANIMADO =====
        function runCompilerFlowDemo() {
            const canvas = document.getElementById('compilerFlowCanvas');
            if (!canvas) return;

            const { width, height } = getCanvasDimensions(canvas, 24);
            const ctx = setupHighDPICanvas(canvas, width, height);
            ctx.clearRect(0, 0, width, height);

            const steps = [
                {
                    name: '‚ñ≠ user.proto',
                    desc: 'Definici√≥n del esquema',
                    color: '#a78bfa',
                    x: width / 2,
                    y: 60
                },
                {
                    name: '‚öô protoc',
                    desc: 'Compilador Protocol Buffers',
                    color: '#fbbf24',
                    x: width / 2,
                    y: 180
                },
                {
                    name: '‚óà user_pb2.py',
                    desc: 'C√≥digo Python',
                    color: '#60a5fa',
                    x: width / 2 - 150,
                    y: 320
                },
                {
                    name: '‚óâ User.java',
                    desc: 'C√≥digo Java',
                    color: '#f472b6',
                    x: width / 2,
                    y: 320
                },
                {
                    name: 'üî∑ user.pb.go',
                    desc: 'C√≥digo Go',
                    color: '#22c55e',
                    x: width / 2 + 150,
                    y: 320
                }
            ];

            let currentStep = 0;

            const interval = setInterval(() => {
                if (currentStep >= steps.length) {
                    clearInterval(interval);

                    // Dibujar flechas finales
                    ctx.strokeStyle = '#4ade80';
                    ctx.lineWidth = 3;
                    ctx.setLineDash([]);

                    // user.proto ‚Üí protoc
                    drawArrow(ctx, steps[0].x, steps[0].y + 40, steps[1].x, steps[1].y - 40, '#4ade80');

                    // protoc ‚Üí outputs
                    drawArrow(ctx, steps[1].x, steps[1].y + 40, steps[2].x, steps[2].y - 40, '#60a5fa');
                    drawArrow(ctx, steps[1].x, steps[1].y + 40, steps[3].x, steps[3].y - 40, '#f472b6');
                    drawArrow(ctx, steps[1].x, steps[1].y + 40, steps[4].x, steps[4].y - 40, '#22c55e');

                    document.getElementById('compilerFlowInfo').textContent =
                        `‚úÖ Compilaci√≥n completa | 3 lenguajes generados`;
                    document.getElementById('compilerFlowResult').innerHTML =
                        `<i class="fas fa-magic"></i> protoc genera <strong>c√≥digo type-safe</strong> autom√°ticamente para m√∫ltiples lenguajes`;
                    return;
                }

                const step = steps[currentStep];

                // Dibujar nodo
                ctx.fillStyle = step.color;
                ctx.beginPath();
                ctx.roundRect(step.x - 80, step.y - 30, 160, 60, 10);
                ctx.fill();

                // Borde
                ctx.strokeStyle = '#ffffff';
                ctx.lineWidth = 2;
                ctx.stroke();

                // Nombre
                ctx.fillStyle = '#ffffff';
                ctx.font = 'bold 14px Arial';
                ctx.textAlign = 'center';
                ctx.fillText(step.name, step.x, step.y - 5);

                // Descripci√≥n
                ctx.font = '10px Arial';
                ctx.fillText(step.desc, step.x, step.y + 12);

                // Dibujar flecha desde el paso anterior
                if (currentStep > 0) {
                    const prevStep = steps[currentStep - 1];
                    if (currentStep === 1) {
                        // user.proto ‚Üí protoc
                        drawArrow(ctx, prevStep.x, prevStep.y + 40, step.x, step.y - 40, '#4ade80');
                    } else if (currentStep >= 2) {
                        // protoc ‚Üí outputs
                        drawArrow(ctx, steps[1].x, steps[1].y + 40, step.x, step.y - 40, step.color);
                    }
                }

                currentStep++;

                document.getElementById('compilerFlowInfo').textContent =
                    `‚öôÔ∏è Paso ${currentStep}/${steps.length} | Generando c√≥digo...`;
            }, 600);
        }

        function drawArrow(ctx, x1, y1, x2, y2, color) {
            ctx.strokeStyle = color;
            ctx.lineWidth = 3;
            ctx.setLineDash([]);

            // L√≠nea
            ctx.beginPath();
            ctx.moveTo(x1, y1);
            ctx.lineTo(x2, y2);
            ctx.stroke();

            // Punta de flecha
            const angle = Math.atan2(y2 - y1, x2 - x1);
            const arrowSize = 12;

            ctx.fillStyle = color;
            ctx.beginPath();
            ctx.moveTo(x2, y2);
            ctx.lineTo(
                x2 - arrowSize * Math.cos(angle - Math.PI / 6),
                y2 - arrowSize * Math.sin(angle - Math.PI / 6)
            );
            ctx.lineTo(
                x2 - arrowSize * Math.cos(angle + Math.PI / 6),
                y2 - arrowSize * Math.sin(angle + Math.PI / 6)
            );
            ctx.closePath();
            ctx.fill();
        }

        function switchProtocDemo(demoType) {
            currentProtocDemo = demoType;

            // Actualizar tabs
            document.querySelectorAll('.protoc-tab').forEach(tab => {
                if (tab.getAttribute('data-demo') === demoType) {
                    tab.style.background = 'var(--uide-accent)';
                    tab.style.color = '#0f1419';
                } else {
                    tab.style.background = 'rgba(255,255,255,0.1)';
                    tab.style.color = '#e2e8f0';
                }
            });

            // Mostrar/ocultar contenido
            document.querySelectorAll('.protoc-demo-content').forEach(content => {
                content.style.display = 'none';
            });

            const activeDemo = document.getElementById(`demo${demoType.charAt(0).toUpperCase() + demoType.slice(1)}`);
            if (activeDemo) {
                activeDemo.style.display = 'flex';
            }

            // Mostrar/ocultar bot√≥n seg√∫n demo
            const applyBtn = document.getElementById('applyFieldMask');
            if (applyBtn) {
                applyBtn.style.display = demoType === 'fieldmask' ? 'block' : 'none';
            }

            // Renderizar Mermaid si es la demo del compilador
            if (demoType === 'compiler') {
                setTimeout(() => {
                    const mermaidDiv = document.querySelector('#demoCompiler .mermaid');
                    if (mermaidDiv && !mermaidDiv.getAttribute('data-processed')) {
                        mermaid.init(undefined, mermaidDiv);
                    }
                }, 100);
            }
        }

        // ===== DEMO 2: FIELDMASK INTERACTIVO =====
        function runFieldMaskDemo() {
            const canvas = document.getElementById('fieldMaskCanvas');
            if (!canvas) return;

            const { width, height } = getCanvasDimensions(canvas, 10);
            const ctx = setupHighDPICanvas(canvas, width, height);
            ctx.clearRect(0, 0, width, height);

            // Obtener campos seleccionados
            const checkboxes = document.querySelectorAll('.field-checkbox');
            const selectedFields = [];
            checkboxes.forEach(cb => {
                if (cb.checked) {
                    selectedFields.push(cb.value);
                }
            });

            // Objeto completo
            const fullUser = {
                id: 12345,
                name: "Carlos Jim√©nez",
                email: "carlos.jimenez@example.com",
                age: 35,
                roles: ["customer", "premium"],
                metadata: {
                    created: "2024-01-15",
                    lastLogin: "2024-11-08"
                }
            };

            // Objeto filtrado
            const filteredUser = {};
            selectedFields.forEach(field => {
                if (field.includes('.')) {
                    const parts = field.split('.');
                    if (!filteredUser[parts[0]]) filteredUser[parts[0]] = {};
                    filteredUser[parts[0]][parts[1]] = fullUser[parts[0]][parts[1]];
                } else {
                    filteredUser[field] = fullUser[field];
                }
            });

            // Dibujar request
            ctx.fillStyle = '#1e1e1e';
            ctx.fillRect(0, 0, width, 90);
            ctx.strokeStyle = '#60a5fa';
            ctx.lineWidth = 2;
            ctx.strokeRect(0, 0, width, 90);

            ctx.fillStyle = '#60a5fa';
            ctx.font = 'bold 11px Arial';
            ctx.textAlign = 'left';
            ctx.fillText('üì§ Request con FieldMask:', 10, 15);

            ctx.fillStyle = '#ffffff';
            ctx.font = '9px monospace';
            ctx.fillText('{', 10, 30);
            ctx.fillText('  "fieldMask": "' + selectedFields.join(',') + '",', 10, 45);
            ctx.fillText('  "userId": 12345', 10, 60);
            ctx.fillText('}', 10, 75);

            // Dibujar response
            ctx.fillStyle = '#1e1e1e';
            ctx.fillRect(0, 100, width, 100);
            ctx.strokeStyle = '#4ade80';
            ctx.lineWidth = 2;
            ctx.strokeRect(0, 100, width, 100);

            ctx.fillStyle = '#4ade80';
            ctx.font = 'bold 11px Arial';
            ctx.fillText('üì• Response (solo campos solicitados):', 10, 115);

            ctx.fillStyle = '#ffffff';
            ctx.font = '9px monospace';
            const responseJson = JSON.stringify(filteredUser, null, 2);
            const lines = responseJson.split('\n').slice(0, 5);
            lines.forEach((line, i) => {
                ctx.fillText(line, 10, 130 + i * 12);
            });
            if (responseJson.split('\n').length > 5) {
                ctx.fillStyle = '#94a3b8';
                ctx.fillText('...', 10, 130 + 5 * 12);
            }

            // Calcular ahorro
            const fullSize = JSON.stringify(fullUser).length;
            const filteredSize = JSON.stringify(filteredUser).length;
            const savings = ((fullSize - filteredSize) / fullSize * 100).toFixed(0);

            document.getElementById('fieldMaskInfo').textContent =
                `‚úÖ ${selectedFields.length} campos | Ahorro: ${savings}% (${fullSize - filteredSize} bytes)`;
            document.getElementById('fieldMaskResult').innerHTML =
                `<i class="fas fa-filter"></i> FieldMask reduce payload en <strong>${savings}%</strong> enviando solo campos necesarios`;
        }
    </script>

    <!-- Slide 11: MessagePack -->
    <div class="slide">
        <h2 style="margin-bottom: 0.8rem;"><i class="fas fa-box"></i> MessagePack: El Punto Medio</h2>

        <div
            style="display: grid; grid-template-columns: 40% 60%; gap: 20px; height: calc(100vh - 200px); max-height: 640px;">
            <!-- Columna Izquierda: Caracter√≠sticas -->
            <div style="display: flex; flex-direction: column; gap: 10px; height: 100%;">
                <div class="quote" style="font-size: 0.8rem; padding: 10px; margin: 0;">
                    "Cache de sesiones en Redis para autenticaci√≥n r√°pida"
                </div>

                <div style="flex-shrink: 0;">
                    <h3 style="font-size: 0.95rem; margin-bottom: 6px;">Posicionamiento</h3>
                    <ul style="font-size: 0.8rem; line-height: 1.4; margin: 0; padding-left: 18px;">
                        <li><strong>Binario</strong>: M√°s eficiente que JSON</li>
                        <li><strong>Simple</strong>: M√°s f√°cil que Protobuf</li>
                        <li><strong>Sin esquema</strong>: No requiere .proto</li>
                        <li><strong>Multiplataforma</strong>: Amplio soporte</li>
                    </ul>
                </div>

                <div
                    style="background: rgba(233, 171, 33, 0.1); padding: 8px; border-radius: 8px; border-left: 4px solid var(--uide-accent); flex-shrink: 0;">
                    <p style="font-size: 0.75rem; margin: 0;">
                        <i class="fas fa-info-circle"></i> Cache Redis y colas de mensajes
                    </p>
                </div>

                <!-- Pesta√±as de Demos -->
                <div style="display: flex; gap: 4px; flex-shrink: 0;">
                    <button class="msgpack-tab active" data-demo="radar"
                        style="flex: 1; padding: 6px; background: var(--uide-accent); color: #0f1419; border: none; border-radius: 4px; font-size: 0.7rem; cursor: pointer; font-weight: 600;">
                        Comparaci√≥n
                    </button>
                    <button class="msgpack-tab" data-demo="usecases"
                        style="flex: 1; padding: 6px; background: rgba(255,255,255,0.1); color: #e2e8f0; border: none; border-radius: 4px; font-size: 0.7rem; cursor: pointer; font-weight: 600;">
                        Casos de Uso
                    </button>
                </div>

                <div style="text-align: center; margin-top: auto; flex-shrink: 0;">
                    <button id="startMsgPackDemo"
                        style="padding: 8px 12px; background: var(--uide-accent); color: #0f1419; border: none; border-radius: 6px; font-weight: 600; font-size: 0.85rem; cursor: pointer; transition: all 0.3s; width: 100%;">
                        <i class="fas fa-play"></i> Iniciar Demo
                    </button>
                </div>
            </div>

            <!-- Columna Derecha: Visualizaci√≥n -->
            <div id="msgpackDemoContainer" style="display: flex; flex-direction: column; gap: 12px; height: 100%;">
                <!-- Demo Radar -->
                <div id="demoRadar" class="msgpack-demo-content"
                    style="display: flex; flex-direction: column; gap: 12px; height: 100%;">
                    <div
                        style="background: rgba(15, 20, 25, 0.6); border-radius: 8px; border: 2px solid #fbbf24; padding: 10px; flex: 1; display: flex; flex-direction: column;">
                        <h3 style="text-align: center; color: #fbbf24; margin: 0 0 8px 0; font-size: 0.9rem;">
                            <i class="fas fa-chart-radar"></i> Gr√°fico de Radar Comparativo
                        </h3>
                        <div
                            style="flex: 1; background: rgba(0,0,0,0.3); border-radius: 6px; padding: 12px; overflow: hidden; height: 300px;">
                            <canvas id="radarCanvas" style="display: block;"></canvas>
                        </div>
                        <div id="radarInfo"
                            style="text-align: center; margin-top: 6px; font-size: 0.75rem; font-weight: 600; color: #fbbf24;">
                            Tecnolog√≠as: -</div>
                    </div>

                    <div
                        style="text-align: center; padding: 8px; background: rgba(233, 171, 33, 0.1); border-radius: 6px; flex-shrink: 0;">
                        <div id="radarResult" style="font-size: 0.85rem; font-weight: 600; color: var(--uide-accent);">
                            Comparaci√≥n de rendimiento HTTP/1.1 vs HTTP/2
                        </div>
                    </div>
                </div>

                <!-- Demo Casos de Uso -->
                <div id="demoUsecases" class="msgpack-demo-content"
                    style="display: none; flex-direction: column; gap: 12px; height: 100%;">
                    <div
                        style="background: rgba(15, 20, 25, 0.6); border-radius: 8px; border: 2px solid #4ade80; padding: 10px; flex: 1; display: flex; flex-direction: column;">
                        <h3 style="text-align: center; color: #4ade80; margin: 0 0 8px 0; font-size: 0.9rem;">
                            <i class="fas fa-sitemap"></i> Casos de Uso por Tecnolog√≠a
                        </h3>
                        <div
                            style="flex: 1; background: rgba(0,0,0,0.3); border-radius: 6px; padding: 12px; overflow-y: auto; height: 450px;">
                            <canvas id="usecasesCanvas" style="display: block;"></canvas>
                        </div>
                        <div id="usecasesInfo"
                            style="text-align: center; margin-top: 6px; font-size: 0.75rem; font-weight: 600; color: #4ade80;">
                            Casos de uso: -</div>
                    </div>

                    <div
                        style="text-align: center; padding: 8px; background: rgba(233, 171, 33, 0.1); border-radius: 6px; flex-shrink: 0;">
                        <div id="usecasesResult"
                            style="font-size: 0.85rem; font-weight: 600; color: var(--uide-accent);">
                            Presiona "Iniciar Demo" para ver los casos de uso
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ===== MESSAGEPACK SIMULACIONES =====
        let currentMsgPackDemo = 'radar';

        document.addEventListener('DOMContentLoaded', function () {
            // Tabs de demos MessagePack
            const msgpackTabs = document.querySelectorAll('.msgpack-tab');
            msgpackTabs.forEach(tab => {
                tab.addEventListener('click', function () {
                    const demoType = this.getAttribute('data-demo');
                    switchMsgPackDemo(demoType);
                });
            });

            // Bot√≥n iniciar demo MessagePack
            const startMsgPackDemo = document.getElementById('startMsgPackDemo');
            if (startMsgPackDemo) {
                startMsgPackDemo.addEventListener('click', function () {
                    if (currentMsgPackDemo === 'radar') {
                        runRadarDemo();
                    } else if (currentMsgPackDemo === 'usecases') {
                        runUseCasesDemo();
                    }
                });
            }
        });

        function switchMsgPackDemo(demoType) {
            currentMsgPackDemo = demoType;

            // Actualizar tabs
            document.querySelectorAll('.msgpack-tab').forEach(tab => {
                if (tab.getAttribute('data-demo') === demoType) {
                    tab.style.background = 'var(--uide-accent)';
                    tab.style.color = '#0f1419';
                } else {
                    tab.style.background = 'rgba(255,255,255,0.1)';
                    tab.style.color = '#e2e8f0';
                }
            });

            // Mostrar/ocultar contenido
            document.querySelectorAll('.msgpack-demo-content').forEach(content => {
                content.style.display = 'none';
            });

            const activeDemo = document.getElementById(`demo${demoType.charAt(0).toUpperCase() + demoType.slice(1)}`);
            if (activeDemo) {
                activeDemo.style.display = 'flex';
            }
        }

        // ===== DEMO 1: GR√ÅFICO DE RADAR COMPARATIVO =====
        function runRadarDemo() {
            const canvas = document.getElementById('radarCanvas');
            if (!canvas) return;

            const { width, height } = getCanvasDimensions(canvas, 24);
            const ctx = setupHighDPICanvas(canvas, width, height);
            ctx.clearRect(0, 0, width, height);

            const centerX = width / 2;
            const centerY = height / 2;
            const radius = Math.min(width, height) / 2 - 60;

            const axes = [
                { name: 'Velocidad', angle: -Math.PI / 2 },
                { name: 'Tama√±o', angle: -Math.PI / 2 + (2 * Math.PI / 5) },
                { name: 'Complejidad', angle: -Math.PI / 2 + (4 * Math.PI / 5) },
                { name: 'Interop', angle: -Math.PI / 2 + (6 * Math.PI / 5) },
                { name: 'Madurez', angle: -Math.PI / 2 + (8 * Math.PI / 5) }
            ];

            const technologies = [
                {
                    name: 'JSON',
                    color: '#60a5fa',
                    values: [0.6, 0.6, 1.0, 1.0, 1.0] // Velocidad, Tama√±o, Complejidad, Interop, Madurez
                },
                {
                    name: 'Protobuf',
                    color: '#22c55e',
                    values: [1.0, 1.0, 0.4, 0.6, 0.8]
                },
                {
                    name: 'MessagePack',
                    color: '#fbbf24',
                    values: [0.8, 0.8, 0.8, 0.7, 0.7]
                }
            ];

            // Dibujar ejes y c√≠rculos conc√©ntricos
            for (let i = 1; i <= 5; i++) {
                const r = (radius * i) / 5;
                ctx.strokeStyle = '#94a3b8' + (i === 5 ? 'ff' : '33');
                ctx.lineWidth = i === 5 ? 2 : 1;
                ctx.beginPath();
                ctx.arc(centerX, centerY, r, 0, Math.PI * 2);
                ctx.stroke();
            }

            // Dibujar ejes
            axes.forEach((axis, i) => {
                const x = centerX + radius * Math.cos(axis.angle);
                const y = centerY + radius * Math.sin(axis.angle);

                ctx.strokeStyle = '#94a3b8';
                ctx.lineWidth = 2;
                ctx.beginPath();
                ctx.moveTo(centerX, centerY);
                ctx.lineTo(x, y);
                ctx.stroke();

                // Etiquetas
                const labelX = centerX + (radius + 30) * Math.cos(axis.angle);
                const labelY = centerY + (radius + 30) * Math.sin(axis.angle);

                ctx.fillStyle = '#ffffff';
                ctx.font = 'bold 11px Arial';
                ctx.textAlign = 'center';
                ctx.fillText(axis.name, labelX, labelY);
            });

            // Animar tecnolog√≠as
            let currentTech = 0;
            let progress = 0;

            const interval = setInterval(() => {
                if (currentTech >= technologies.length) {
                    clearInterval(interval);
                    document.getElementById('radarInfo').textContent =
                        `‚ñä 3 tecnolog√≠as comparadas en 5 dimensiones`;
                    document.getElementById('radarResult').innerHTML =
                        `<i class="fas fa-balance-scale"></i> MessagePack es el <strong>punto medio ideal</strong> entre velocidad y simplicidad`;
                    return;
                }

                progress += 0.05;
                if (progress > 1) {
                    progress = 1;
                }

                const tech = technologies[currentTech];

                // Dibujar pol√≠gono
                ctx.fillStyle = tech.color + '40';
                ctx.strokeStyle = tech.color;
                ctx.lineWidth = 3;
                ctx.beginPath();

                axes.forEach((axis, i) => {
                    const value = tech.values[i] * progress;
                    const r = radius * value;
                    const x = centerX + r * Math.cos(axis.angle);
                    const y = centerY + r * Math.sin(axis.angle);

                    if (i === 0) {
                        ctx.moveTo(x, y);
                    } else {
                        ctx.lineTo(x, y);
                    }

                    // Puntos
                    ctx.fillStyle = tech.color;
                    ctx.beginPath();
                    ctx.arc(x, y, 5, 0, Math.PI * 2);
                    ctx.fill();
                });

                ctx.closePath();
                ctx.fill();
                ctx.stroke();

                // Leyenda
                const legendY = 20 + currentTech * 20;
                ctx.fillStyle = tech.color;
                ctx.fillRect(20, legendY, 15, 15);
                ctx.fillStyle = '#ffffff';
                ctx.font = 'bold 11px Arial';
                ctx.textAlign = 'left';
                ctx.fillText(tech.name, 40, legendY + 11);

                if (progress >= 1) {
                    currentTech++;
                    progress = 0;
                }

                document.getElementById('radarInfo').textContent =
                    `‚ñä Dibujando ${tech.name}... (${currentTech + 1}/3)`;
            }, 30);
        }

        // ===== DEMO 2: CASOS DE USO =====
        function runUseCasesDemo() {
            const canvas = document.getElementById('usecasesCanvas');
            if (!canvas) return;

            const { width, height } = getCanvasDimensions(canvas, 24);
            const ctx = setupHighDPICanvas(canvas, width, height);
            ctx.clearRect(0, 0, width, height);

            const useCases = [
                {
                    tech: 'JSON',
                    color: '#60a5fa',
                    cases: [
                        '‚óâ API REST para partners',
                        '‚ñØ App m√≥vil Banco de Loja',
                        'üîß Configuraci√≥n de servicios',
                        'üìù Logs y auditor√≠a'
                    ],
                    y: 30
                },
                {
                    tech: 'Protobuf',
                    color: '#22c55e',
                    cases: [
                        '‚ö° Microsservicios internos',
                        '‚ñ≤ Procesamiento transacciones',
                        '‚óâ Eventos entre servicios',
                        '‚ä† Datos sensibles encriptados'
                    ],
                    y: 180
                },
                {
                    tech: 'MessagePack',
                    color: '#fbbf24',
                    cases: [
                        '‚ñ£ Cache de sesiones (Redis)',
                        '‚óà Cola de transacciones',
                        '‚âà Balance velocidad/simplicidad',
                        '‚Üª Sincronizacion de datos'
                    ],
                    y: 330
                }
            ];

            let currentCase = 0;

            const interval = setInterval(() => {
                if (currentCase >= useCases.length) {
                    clearInterval(interval);
                    document.getElementById('usecasesInfo').textContent =
                        `‚úÖ 3 tecnolog√≠as | 12 casos de uso`;
                    document.getElementById('usecasesResult').innerHTML =
                        `<i class="fas fa-lightbulb"></i> Cada tecnolog√≠a tiene su <strong>caso de uso ideal</strong> seg√∫n requisitos`;
                    return;
                }

                const useCase = useCases[currentCase];

                // T√≠tulo de la tecnolog√≠a
                ctx.fillStyle = useCase.color;
                ctx.fillRect(10, useCase.y, width - 20, 40);
                ctx.fillStyle = '#ffffff';
                ctx.font = 'bold 16px Arial';
                ctx.textAlign = 'center';
                ctx.fillText(useCase.tech, width / 2, useCase.y + 25);

                // Casos de uso
                useCase.cases.forEach((caseText, i) => {
                    const y = useCase.y + 55 + i * 22;

                    // Bullet point
                    ctx.fillStyle = useCase.color;
                    ctx.beginPath();
                    ctx.arc(25, y - 5, 4, 0, Math.PI * 2);
                    ctx.fill();

                    // Texto
                    ctx.fillStyle = '#ffffff';
                    ctx.font = '11px Arial';
                    ctx.textAlign = 'left';
                    ctx.fillText(caseText, 40, y);
                });

                currentCase++;

                document.getElementById('usecasesInfo').textContent =
                    `üìã Mostrando casos de uso (${currentCase}/3)`;
            }, 800);
        }
    </script>

    <!-- Slide 17: XML Fundamentos -->
    <div class="slide">
        <h2 style="margin-bottom: 0.8rem;"><i class="fas fa-code"></i> XML: Verbosidad y Overhead</h2>

        <div
            style="display: grid; grid-template-columns: 40% 60%; gap: 20px; height: calc(100vh - 200px); max-height: 640px;">
            <!-- Columna Izquierda: Caracter√≠sticas -->
            <div style="display: flex; flex-direction: column; gap: 10px; height: 100%;">
                <div class="quote" style="font-size: 0.8rem; padding: 10px; margin: 0;">
                    "Integraci√≥n con SRI para facturas electr√≥nicas y reportes"
                </div>

                <div style="flex-shrink: 0;">
                    <h3 style="font-size: 0.95rem; margin-bottom: 6px;">Costos</h3>
                    <ul style="font-size: 0.8rem; line-height: 1.4; margin: 0; padding-left: 18px;">
                        <li><strong>Verbosidad</strong>: Tags duplicados</li>
                        <li><strong>Overhead</strong>: 2-3x m√°s grande</li>
                        <li><strong>Parsing</strong>: Costoso</li>
                        <li><strong>Metadatos</strong>: Informaci√≥n extra</li>
                    </ul>
                </div>

                <div
                    style="background: rgba(248, 113, 113, 0.1); padding: 8px; border-radius: 8px; border-left: 4px solid #f87171; flex-shrink: 0;">
                    <p style="font-size: 0.75rem; margin: 0;">
                        <i class="fas fa-exclamation-triangle"></i> Legacy pero a√∫n usado
                    </p>
                </div>

                <!-- Pesta√±as de Demos -->
                <div style="display: flex; gap: 4px; flex-shrink: 0;">
                    <button class="xml-tab active" data-demo="overhead"
                        style="flex: 1; padding: 6px; background: var(--uide-accent); color: #0f1419; border: none; border-radius: 4px; font-size: 0.7rem; cursor: pointer; font-weight: 600;">
                        Overhead
                    </button>
                    <button class="xml-tab" data-demo="dom"
                        style="flex: 1; padding: 6px; background: rgba(255,255,255,0.1); color: #e2e8f0; border: none; border-radius: 4px; font-size: 0.7rem; cursor: pointer; font-weight: 600;">
                        √Årbol DOM
                    </button>
                </div>

                <div style="text-align: center; margin-top: auto; flex-shrink: 0;">
                    <button id="startXmlDemo"
                        style="padding: 8px 12px; background: var(--uide-accent); color: #0f1419; border: none; border-radius: 6px; font-weight: 600; font-size: 0.85rem; cursor: pointer; transition: all 0.3s; width: 100%;">
                        <i class="fas fa-play"></i> Iniciar Demo
                    </button>
                </div>
            </div>

            <!-- Columna Derecha: Visualizaci√≥n -->
            <div id="xmlDemoContainer" style="display: flex; flex-direction: column; gap: 12px; height: 100%;">
                <!-- Demo Overhead -->
                <div id="demoOverhead" class="xml-demo-content"
                    style="display: flex; flex-direction: column; gap: 12px; height: 100%;">
                    <div
                        style="background: rgba(15, 20, 25, 0.6); border-radius: 8px; border: 2px solid #f87171; padding: 10px; flex: 1; display: flex; flex-direction: column;">
                        <h3 style="text-align: center; color: #f87171; margin: 0 0 8px 0; font-size: 0.9rem;">
                            <i class="fas fa-chart-bar"></i> Comparaci√≥n de Tama√±os
                        </h3>
                        <div
                            style="flex: 1; background: rgba(0,0,0,0.3); border-radius: 6px; padding: 12px; overflow-y: auto; height: 450px;">
                            <canvas id="overheadCanvas" style="display: block;"></canvas>
                        </div>
                        <div id="overheadInfo"
                            style="text-align: center; margin-top: 6px; font-size: 0.75rem; font-weight: 600; color: #f87171;">
                            Tama√±os: -</div>
                    </div>

                    <div
                        style="text-align: center; padding: 8px; background: rgba(233, 171, 33, 0.1); border-radius: 6px; flex-shrink: 0;">
                        <div id="overheadResult"
                            style="font-size: 0.85rem; font-weight: 600; color: var(--uide-accent);">
                            Presiona "Iniciar Demo" para ver el overhead
                        </div>
                    </div>
                </div>

                <!-- Demo √Årbol DOM -->
                <div id="demoDom" class="xml-demo-content"
                    style="display: none; flex-direction: column; gap: 12px; height: 100%;">
                    <div
                        style="background: rgba(15, 20, 25, 0.6); border-radius: 8px; border: 2px solid #60a5fa; padding: 10px; flex: 1; display: flex; flex-direction: column;">
                        <h3 style="text-align: center; color: #60a5fa; margin: 0 0 8px 0; font-size: 0.9rem;">
                            <i class="fas fa-sitemap"></i> √Årbol DOM de XML
                        </h3>
                        <div
                            style="flex: 1; background: rgba(0,0,0,0.3); border-radius: 6px; padding: 12px; overflow: hidden; height: 450px;">
                            <canvas id="domCanvas" style="display: block;"></canvas>
                        </div>
                        <div id="domInfo"
                            style="text-align: center; margin-top: 6px; font-size: 0.75rem; font-weight: 600; color: #60a5fa;">
                            Nodos: -</div>
                    </div>

                    <div
                        style="text-align: center; padding: 8px; background: rgba(233, 171, 33, 0.1); border-radius: 6px; flex-shrink: 0;">
                        <div id="domResult" style="font-size: 0.85rem; font-weight: 600; color: var(--uide-accent);">
                            Presiona "Iniciar Demo" para ver el √°rbol DOM
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ===== XML SIMULACIONES =====
        let currentXmlDemo = 'overhead';

        document.addEventListener('DOMContentLoaded', function () {
            // Tabs de demos XML
            const xmlTabs = document.querySelectorAll('.xml-tab');
            xmlTabs.forEach(tab => {
                tab.addEventListener('click', function () {
                    const demoType = this.getAttribute('data-demo');
                    switchXmlDemo(demoType);
                });
            });

            // Bot√≥n iniciar demo XML
            const startXmlDemo = document.getElementById('startXmlDemo');
            if (startXmlDemo) {
                startXmlDemo.addEventListener('click', function () {
                    if (currentXmlDemo === 'overhead') {
                        runOverheadDemo();
                    } else if (currentXmlDemo === 'dom') {
                        runDomTreeDemo();
                    }
                });
            }
        });

        function switchXmlDemo(demoType) {
            currentXmlDemo = demoType;

            // Actualizar tabs
            document.querySelectorAll('.xml-tab').forEach(tab => {
                if (tab.getAttribute('data-demo') === demoType) {
                    tab.style.background = 'var(--uide-accent)';
                    tab.style.color = '#0f1419';
                } else {
                    tab.style.background = 'rgba(255,255,255,0.1)';
                    tab.style.color = '#e2e8f0';
                }
            });

            // Mostrar/ocultar contenido
            document.querySelectorAll('.xml-demo-content').forEach(content => {
                content.style.display = 'none';
            });

            const activeDemo = document.getElementById(`demo${demoType.charAt(0).toUpperCase() + demoType.slice(1)}`);
            if (activeDemo) {
                activeDemo.style.display = 'flex';
            }
        }

        // ===== DEMO 1: OVERHEAD VISUAL =====
        function runOverheadDemo() {
            const canvas = document.getElementById('overheadCanvas');
            if (!canvas) return;

            const { width, height } = getCanvasDimensions(canvas, 24);
            const ctx = setupHighDPICanvas(canvas, width, height);
            ctx.clearRect(0, 0, width, height);

            const formats = [
                {
                    name: 'JSON',
                    color: '#60a5fa',
                    size: 150,
                    content: '{"transaction": {"id": "TRX001", "amount": 150}}',
                    useful: 35,
                    metadata: 115
                },
                {
                    name: 'XML',
                    color: '#f87171',
                    size: 280,
                    content: '<?xml version="1.0"?>\n<transaccion>\n  <id>TRX001</id>\n  <monto>150</monto>\n</transaccion>',
                    useful: 35,
                    metadata: 245
                },
                {
                    name: 'Protobuf',
                    color: '#22c55e',
                    size: 45,
                    content: '[binario: 08 01 12 03 96 01]',
                    useful: 35,
                    metadata: 10
                }
            ];

            let currentFormat = 0;

            const interval = setInterval(() => {
                if (currentFormat >= formats.length) {
                    clearInterval(interval);

                    // Mostrar comparaci√≥n final
                    const xmlOverhead = ((formats[1].size - formats[0].size) / formats[0].size * 100).toFixed(0);
                    const protobufSavings = ((formats[1].size - formats[2].size) / formats[1].size * 100).toFixed(0);

                    document.getElementById('overheadInfo').textContent =
                        `‚ñä JSON: 150B | XML: 280B (+${xmlOverhead}%) | Protobuf: 45B`;
                    document.getElementById('overheadResult').innerHTML =
                        `<i class="fas fa-exclamation-triangle"></i> XML tiene <strong>${xmlOverhead}% m√°s overhead</strong> que JSON y <strong>${protobufSavings}% m√°s</strong> que Protobuf`;
                    return;
                }

                const format = formats[currentFormat];
                const y = 30 + currentFormat * 140;

                // T√≠tulo
                ctx.fillStyle = format.color;
                ctx.font = 'bold 14px Arial';
                ctx.textAlign = 'left';
                ctx.fillText(`${format.name} (${format.size} bytes)`, 20, y);

                // C√≥digo
                ctx.fillStyle = '#1e1e1e';
                ctx.fillRect(20, y + 10, width - 40, 60);
                ctx.strokeStyle = format.color;
                ctx.lineWidth = 2;
                ctx.strokeRect(20, y + 10, width - 40, 60);

                ctx.fillStyle = '#e2e8f0';
                ctx.font = '9px monospace';
                ctx.textAlign = 'left';
                const lines = format.content.split('\n');
                lines.forEach((line, i) => {
                    ctx.fillText(line.substring(0, 60), 25, y + 28 + i * 12);
                });

                // Gr√°fico de barras (datos √∫tiles vs metadata)
                const barY = y + 80;
                const maxWidth = width - 100;
                const usefulWidth = (maxWidth * format.useful) / format.size;
                const metadataWidth = (maxWidth * format.metadata) / format.size;

                // Datos √∫tiles (verde)
                ctx.fillStyle = '#22c55e';
                ctx.fillRect(50, barY, usefulWidth, 25);

                // Metadata (rojo)
                ctx.fillStyle = '#f87171';
                ctx.fillRect(50 + usefulWidth, barY, metadataWidth, 25);

                // Etiquetas
                ctx.fillStyle = '#ffffff';
                ctx.font = '10px Arial';
                ctx.textAlign = 'left';
                ctx.fillText(`Datos: ${format.useful}B`, 50, barY - 5);
                ctx.fillText(`Metadata: ${format.metadata}B`, 50 + usefulWidth + 5, barY - 5);

                // Porcentaje de overhead
                const overheadPct = ((format.metadata / format.size) * 100).toFixed(0);
                ctx.fillStyle = format.color;
                ctx.font = 'bold 11px Arial';
                ctx.textAlign = 'right';
                ctx.fillText(`${overheadPct}% overhead`, width - 20, barY + 17);

                currentFormat++;

                document.getElementById('overheadInfo').textContent =
                    `‚ñä Analizando ${format.name}... (${currentFormat}/3)`;
            }, 1000);
        }

        // ===== DEMO 2: √ÅRBOL DOM =====
        function runDomTreeDemo() {
            const canvas = document.getElementById('domCanvas');
            if (!canvas) return;

            const { width, height } = getCanvasDimensions(canvas, 24);
            const ctx = setupHighDPICanvas(canvas, width, height);
            ctx.clearRect(0, 0, width, height);

            const tree = {
                name: 'factura',
                color: '#a78bfa',
                x: width / 2,
                y: 50,
                children: [
                    {
                        name: 'transaccion',
                        color: '#60a5fa',
                        x: width / 2,
                        y: 150,
                        children: [
                            {
                                name: 'id',
                                color: '#22c55e',
                                x: width / 2 - 100,
                                y: 250,
                                value: 'TRX001'
                            },
                            {
                                name: 'monto',
                                color: '#22c55e',
                                x: width / 2 + 100,
                                y: 250,
                                value: '$150'
                            }
                        ]
                    }
                ]
            };

            let currentLevel = 0;
            const maxLevel = 3;

            const interval = setInterval(() => {
                if (currentLevel >= maxLevel) {
                    clearInterval(interval);
                    document.getElementById('domInfo').textContent =
                        `üå≥ 5 nodos | 3 niveles de profundidad`;
                    document.getElementById('domResult').innerHTML =
                        `<i class="fas fa-sitemap"></i> XML se parsea en un <strong>√°rbol DOM</strong> que consume memoria y tiempo de procesamiento`;
                    return;
                }

                // Dibujar nodos seg√∫n el nivel
                if (currentLevel === 0) {
                    // Ra√≠z
                    drawNode(ctx, tree.name, tree.x, tree.y, tree.color);
                } else if (currentLevel === 1) {
                    // user
                    const child = tree.children[0];
                    drawArrow(ctx, tree.x, tree.y + 30, child.x, child.y - 30, '#94a3b8');
                    drawNode(ctx, child.name, child.x, child.y, child.color);
                } else if (currentLevel === 2) {
                    // id y name
                    const parent = tree.children[0];
                    parent.children.forEach(child => {
                        drawArrow(ctx, parent.x, parent.y + 30, child.x, child.y - 30, '#94a3b8');
                        drawNode(ctx, child.name, child.x, child.y, child.color);

                        // Valor
                        ctx.fillStyle = '#fbbf24';
                        ctx.fillRect(child.x - 40, child.y + 40, 80, 30);
                        ctx.strokeStyle = '#fbbf24';
                        ctx.lineWidth = 2;
                        ctx.strokeRect(child.x - 40, child.y + 40, 80, 30);

                        ctx.fillStyle = '#ffffff';
                        ctx.font = 'bold 12px Arial';
                        ctx.textAlign = 'center';
                        ctx.fillText(child.value, child.x, child.y + 60);

                        // L√≠nea al valor
                        ctx.strokeStyle = '#94a3b8';
                        ctx.lineWidth = 2;
                        ctx.beginPath();
                        ctx.moveTo(child.x, child.y + 30);
                        ctx.lineTo(child.x, child.y + 40);
                        ctx.stroke();
                    });
                }

                currentLevel++;

                document.getElementById('domInfo').textContent =
                    `üå≥ Construyendo √°rbol... Nivel ${currentLevel}/${maxLevel}`;
            }, 800);
        }

        function drawNode(ctx, text, x, y, color) {
            ctx.fillStyle = color;
            ctx.fillRect(x - 50, y - 20, 100, 40);
            ctx.strokeStyle = '#ffffff';
            ctx.lineWidth = 2;
            ctx.strokeRect(x - 50, y - 20, 100, 40);

            ctx.fillStyle = '#ffffff';
            ctx.font = 'bold 12px Arial';
            ctx.textAlign = 'center';
            ctx.fillText(text, x, y + 5);
        }
    </script>

    <!-- Slide 18: XML Herramientas -->
    <div class="slide">
        <h2 style="margin-bottom: 0.8rem;"><i class="fas fa-tools"></i> XML: XPath Interactivo</h2>

        <div
            style="display: grid; grid-template-columns: 40% 60%; gap: 20px; height: calc(100vh - 200px); max-height: 640px;">
            <!-- Columna Izquierda: Selectores -->
            <div style="display: flex; flex-direction: column; gap: 10px; height: 100%;">
                <div class="quote" style="font-size: 0.8rem; padding: 10px; margin: 0;">
                    "Consultar transacciones del SRI con XPath"
                </div>

                <div style="flex-shrink: 0;">
                    <h3 style="font-size: 0.95rem; margin-bottom: 6px;">Selectores XPath</h3>
                    <select id="xpathSelector"
                        style="width: 100%; padding: 8px; background: rgba(255,255,255,0.1); border: 1px solid var(--uide-accent); color: white; border-radius: 4px; font-size: 0.85rem; margin-bottom: 10px;">
                        <option value="//transaccion">Todas las transacciones</option>
                        <option value="//transaccion[@tipo='transferencia']">Solo transferencias</option>
                        <option value="//transaccion[monto>1000]">Montos > $1000</option>
                        <option value="//transaccion[@banco='Pichincha']">Al Banco Pichincha</option>
                        <option value="//cliente/nombre">Nombres de clientes</option>
                        <option value="//transaccion/fecha">Todas las fechas</option>
                    </select>
                </div>

                <div
                    style="background: rgba(233, 171, 33, 0.1); padding: 8px; border-radius: 8px; border-left: 4px solid var(--uide-accent); flex-shrink: 0;">
                    <p style="font-size: 0.75rem; margin: 0;">
                        <i class="fas fa-info-circle"></i> Herramienta para auditor√≠a
                    </p>
                </div>

                <div
                    style="flex: 1; background: rgba(15, 20, 25, 0.6); border-radius: 8px; padding: 10px; overflow-y: auto;">
                    <h3 style="font-size: 0.9rem; margin-bottom: 8px; color: #fbbf24;">üìã Resultado</h3>
                    <div id="xpathResult"
                        style="font-family: monospace; font-size: 0.75rem; color: #4ade80; line-height: 1.6;">
                        Selecciona una consulta XPath...
                    </div>
                </div>

                <div style="text-align: center; margin-top: auto; flex-shrink: 0;">
                    <button id="executeXPath"
                        style="padding: 8px 12px; background: var(--uide-accent); color: #0f1419; border: none; border-radius: 6px; font-weight: 600; font-size: 0.85rem; cursor: pointer; transition: all 0.3s; width: 100%;">
                        <i class="fas fa-play"></i> Ejecutar Consulta
                    </button>
                </div>
            </div>

            <!-- Columna Derecha: Documento XML -->
            <div style="display: flex; flex-direction: column; gap: 12px; height: 100%;">
                <div
                    style="background: rgba(15, 20, 25, 0.6); border-radius: 8px; border: 2px solid #60a5fa; padding: 10px; flex: 1; display: flex; flex-direction: column;">
                    <h3 style="text-align: center; color: #60a5fa; margin: 0 0 8px 0; font-size: 0.9rem;">
                        <i class="fas fa-file-code"></i> Documento XML - Transacciones Banco de Loja
                    </h3>
                    <div
                        style="flex: 1; background: rgba(0,0,0,0.3); border-radius: 6px; padding: 12px; overflow-y: auto; height: 450px;">
                        <canvas id="xpathCanvas" style="display: block;"></canvas>
                    </div>
                    <div id="xpathInfo"
                        style="text-align: center; margin-top: 6px; font-size: 0.75rem; font-weight: 600; color: #60a5fa;">
                        Elementos resaltados: -</div>
                </div>

                <div
                    style="text-align: center; padding: 8px; background: rgba(233, 171, 33, 0.1); border-radius: 6px; flex-shrink: 0;">
                    <div id="xpathSummary" style="font-size: 0.85rem; font-weight: 600; color: var(--uide-accent);">
                        XPath permite consultas precisas sobre documentos XML
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ===== XPATH INTERACTIVO =====
        const xmlDocument = `<?xml version="1.0" encoding="UTF-8"?>
<transacciones>
  <transaccion tipo="transferencia" banco="Pichincha">
    <id>TRX-001</id>
    <cliente><nombre>Mar√≠a S√°nchez</nombre></cliente>
    <monto>1500.00</monto>
    <fecha>2024-11-08</fecha>
  </transaccion>
  <transaccion tipo="pago" banco="Produbanco">
    <id>TRX-002</id>
    <cliente><nombre>Carlos Jim√©nez</nombre></cliente>
    <monto>450.00</monto>
    <fecha>2024-11-08</fecha>
  </transaccion>
  <transaccion tipo="transferencia" banco="Guayaquil">
    <id>TRX-003</id>
    <cliente><nombre>Ana Torres</nombre></cliente>
    <monto>2300.00</monto>
    <fecha>2024-11-09</fecha>
  </transaccion>
  <transaccion tipo="transferencia" banco="Pichincha">
    <id>TRX-004</id>
    <cliente><nombre>Luis Morales</nombre></cliente>
    <monto>800.00</monto>
    <fecha>2024-11-09</fecha>
  </transaccion>
</transacciones>`;

        document.addEventListener('DOMContentLoaded', function () {
            const executeBtn = document.getElementById('executeXPath');
            const selector = document.getElementById('xpathSelector');

            if (executeBtn) {
                executeBtn.addEventListener('click', runXPathDemo);
            }

            if (selector) {
                selector.addEventListener('change', runXPathDemo);
            }

            // Dibujar XML inicial
            setTimeout(() => drawXMLDocument(), 500);
        });

        function drawXMLDocument(highlightedLines = []) {
            const canvas = document.getElementById('xpathCanvas');
            if (!canvas) return;

            const { width, height } = getCanvasDimensions(canvas, 24);
            const ctx = setupHighDPICanvas(canvas, width, height);
            ctx.clearRect(0, 0, width, height);

            const lines = xmlDocument.split('\n');
            const lineHeight = 14;
            let y = 15;

            lines.forEach((line, i) => {
                // Fondo para l√≠neas resaltadas
                if (highlightedLines.includes(i)) {
                    ctx.fillStyle = 'rgba(74, 222, 128, 0.2)';
                    ctx.fillRect(0, y - 12, width, lineHeight);
                }

                // Texto
                ctx.fillStyle = highlightedLines.includes(i) ? '#4ade80' : '#e2e8f0';
                ctx.font = '9px monospace';
                ctx.textAlign = 'left';
                ctx.fillText(line, 10, y);

                y += lineHeight;
            });
        }

        function runXPathDemo() {
            const selector = document.getElementById('xpathSelector').value;
            const resultDiv = document.getElementById('xpathResult');
            const infoDiv = document.getElementById('xpathInfo');
            const summaryDiv = document.getElementById('xpathSummary');

            let result = '';
            let highlightedLines = [];
            let count = 0;

            switch (selector) {
                case '//transaccion':
                    result = 'Encontradas 4 transacciones:\n';
                    result += '‚Ä¢ TRX-001 (Mar√≠a S√°nchez)\n';
                    result += '‚Ä¢ TRX-002 (Carlos Jim√©nez)\n';
                    result += '‚Ä¢ TRX-003 (Ana Torres)\n';
                    result += '‚Ä¢ TRX-004 (Luis Morales)';
                    highlightedLines = [2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23];
                    count = 4;
                    break;

                case '//transaccion[@tipo=\'transferencia\']':
                    result = 'Encontradas 3 transferencias:\n';
                    result += '‚Ä¢ TRX-001 ‚Üí Pichincha ($1500)\n';
                    result += '‚Ä¢ TRX-003 ‚Üí Guayaquil ($2300)\n';
                    result += '‚Ä¢ TRX-004 ‚Üí Pichincha ($800)';
                    highlightedLines = [2, 3, 4, 5, 6, 7, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23];
                    count = 3;
                    break;

                case '//transaccion[monto>1000]':
                    result = 'Encontradas 2 transacciones > $1000:\n';
                    result += '‚Ä¢ TRX-001: $1500.00\n';
                    result += '‚Ä¢ TRX-003: $2300.00\n';
                    result += '\n‚ö†Ô∏è Transacciones sospechosas para auditor√≠a';
                    highlightedLines = [2, 3, 4, 5, 6, 7, 13, 14, 15, 16, 17];
                    count = 2;
                    break;

                case '//transaccion[@banco=\'Pichincha\']':
                    result = 'Encontradas 2 transacciones al Pichincha:\n';
                    result += '‚Ä¢ TRX-001: Mar√≠a S√°nchez ($1500)\n';
                    result += '‚Ä¢ TRX-004: Luis Morales ($800)';
                    highlightedLines = [2, 3, 4, 5, 6, 7, 19, 20, 21, 22, 23];
                    count = 2;
                    break;

                case '//cliente/nombre':
                    result = 'Encontrados 4 nombres:\n';
                    result += '‚Ä¢ Mar√≠a S√°nchez\n';
                    result += '‚Ä¢ Carlos Jim√©nez\n';
                    result += '‚Ä¢ Ana Torres\n';
                    result += '‚Ä¢ Luis Morales';
                    highlightedLines = [4, 10, 15, 21];
                    count = 4;
                    break;

                case '//transaccion/fecha':
                    result = 'Encontradas 4 fechas:\n';
                    result += '‚Ä¢ 2024-11-08 (2 transacciones)\n';
                    result += '‚Ä¢ 2024-11-09 (2 transacciones)';
                    highlightedLines = [6, 12, 17, 23];
                    count = 4;
                    break;
            }

            resultDiv.innerHTML = result.replace(/\n/g, '<br>');
            infoDiv.textContent = `‚úÖ ${count} elementos resaltados`;
            summaryDiv.innerHTML = `<i class="fas fa-search"></i> XPath: <strong>${selector}</strong> encontr√≥ ${count} resultado(s)`;

            drawXMLDocument(highlightedLines);
        }
    </script>

    <!-- Slide 19: XML Empresarial -->
    <div class="slide">
        <h2 style="margin-bottom: 0.8rem;"><i class="fas fa-building"></i> XML: SOAP y Sistemas Legacy</h2>

        <div
            style="display: grid; grid-template-columns: 40% 60%; gap: 20px; height: calc(100vh - 200px); max-height: 640px;">
            <!-- Columna Izquierda: Info -->
            <div style="display: flex; flex-direction: column; gap: 10px; height: 100%;">
                <div class="quote" style="font-size: 0.8rem; padding: 10px; margin: 0;">
                    "Integraci√≥n con IESS y BCE mediante SOAP"
                </div>

                <div style="flex-shrink: 0;">
                    <h3 style="font-size: 0.95rem; margin-bottom: 6px;">Casos de Uso Ecuador</h3>
                    <ul style="font-size: 0.8rem; line-height: 1.6; margin: 0; padding-left: 18px;">
                        <li>‚ñ† <strong>BCE</strong>: Tasas de inter√©s</li>
                        <li>üíº <strong>IESS</strong>: Verificaci√≥n aportes</li>
                        <li>‚ñä <strong>SRI</strong>: Facturas electr√≥nicas</li>
                        <li>üèõÔ∏è <strong>Superintendencia</strong>: Reportes</li>
                    </ul>
                </div>

                <div
                    style="background: rgba(248, 113, 113, 0.1); padding: 8px; border-radius: 8px; border-left: 4px solid #f87171; flex-shrink: 0;">
                    <p style="font-size: 0.75rem; margin: 0;">
                        <i class="fas fa-exclamation-triangle"></i> Legacy pero obligatorio
                    </p>
                </div>

                <div
                    style="flex: 1; background: rgba(15, 20, 25, 0.6); border-radius: 8px; padding: 10px; overflow-y: auto;">
                    <h3 style="font-size: 0.9rem; margin-bottom: 8px; color: #60a5fa;">üìã REST vs SOAP</h3>
                    <table style="width: 100%; font-size: 0.75rem; color: #e2e8f0;">
                        <tr style="border-bottom: 1px solid rgba(255,255,255,0.1);">
                            <td style="padding: 6px; font-weight: bold;">Formato</td>
                            <td style="padding: 6px;">JSON</td>
                            <td style="padding: 6px;">XML</td>
                        </tr>
                        <tr style="border-bottom: 1px solid rgba(255,255,255,0.1);">
                            <td style="padding: 6px; font-weight: bold;">Protocolo</td>
                            <td style="padding: 6px;">HTTP</td>
                            <td style="padding: 6px;">HTTP/SMTP</td>
                        </tr>
                        <tr style="border-bottom: 1px solid rgba(255,255,255,0.1);">
                            <td style="padding: 6px; font-weight: bold;">Contrato</td>
                            <td style="padding: 6px;">OpenAPI</td>
                            <td style="padding: 6px;">WSDL</td>
                        </tr>
                        <tr>
                            <td style="padding: 6px; font-weight: bold;">Uso</td>
                            <td style="padding: 6px; color: #4ade80;">Moderno</td>
                            <td style="padding: 6px; color: #f87171;">Legacy</td>
                        </tr>
                    </table>
                </div>

                <div style="text-align: center; margin-top: auto; flex-shrink: 0;">
                    <button id="startSoapDemo"
                        style="padding: 8px 12px; background: var(--uide-accent); color: #0f1419; border: none; border-radius: 6px; font-weight: 600; font-size: 0.85rem; cursor: pointer; transition: all 0.3s; width: 100%;">
                        <i class="fas fa-play"></i> Ver Flujo SOAP
                    </button>
                </div>
            </div>

            <!-- Columna Derecha: Diagrama SOAP -->
            <div style="display: flex; flex-direction: column; gap: 12px; height: 100%;">
                <div
                    style="background: rgba(15, 20, 25, 0.6); border-radius: 8px; border: 2px solid #fbbf24; padding: 10px; flex: 1; display: flex; flex-direction: column;">
                    <h3 style="text-align: center; color: #fbbf24; margin: 0 0 8px 0; font-size: 0.9rem;">
                        <i class="fas fa-sitemap"></i> Arquitectura SOAP - Consulta al IESS
                    </h3>
                    <div
                        style="flex: 1; background: rgba(0,0,0,0.3); border-radius: 6px; padding: 12px; overflow: hidden; height: 450px;">
                        <canvas id="soapCanvas" style="display: block;"></canvas>
                    </div>
                    <div id="soapInfo"
                        style="text-align: center; margin-top: 6px; font-size: 0.75rem; font-weight: 600; color: #fbbf24;">
                        Paso: -</div>
                </div>

                <div
                    style="text-align: center; padding: 8px; background: rgba(233, 171, 33, 0.1); border-radius: 6px; flex-shrink: 0;">
                    <div id="soapResult" style="font-size: 0.85rem; font-weight: 600; color: var(--uide-accent);">
                        SOAP/XML usado en integraciones gubernamentales obligatorias
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ===== SOAP DEMO =====
        document.addEventListener('DOMContentLoaded', function () {
            const startSoapBtn = document.getElementById('startSoapDemo');
            if (startSoapBtn) {
                startSoapBtn.addEventListener('click', runSoapDemo);
            }
        });

        function runSoapDemo() {
            const canvas = document.getElementById('soapCanvas');
            if (!canvas) return;

            const { width, height } = getCanvasDimensions(canvas, 24);
            const ctx = setupHighDPICanvas(canvas, width, height);
            ctx.clearRect(0, 0, width, height);

            const steps = [
                {
                    name: 'Banco de Loja',
                    desc: 'Cliente SOAP',
                    color: '#60a5fa',
                    x: 80,
                    y: 60
                },
                {
                    name: 'SOAP Request',
                    desc: 'XML Envelope',
                    color: '#fbbf24',
                    x: width / 2,
                    y: 140
                },
                {
                    name: 'WSDL Contract',
                    desc: 'Definici√≥n servicio',
                    color: '#a78bfa',
                    x: width / 2,
                    y: 220
                },
                {
                    name: 'IESS Server',
                    desc: 'Servicio Web',
                    color: '#f472b6',
                    x: width - 80,
                    y: 60
                },
                {
                    name: 'SOAP Response',
                    desc: 'Datos aportes',
                    color: '#4ade80',
                    x: width / 2,
                    y: 320
                }
            ];

            let currentStep = 0;

            const interval = setInterval(() => {
                if (currentStep >= steps.length) {
                    clearInterval(interval);

                    // Dibujar flechas finales
                    drawArrow(ctx, steps[0].x + 60, steps[0].y, steps[1].x - 60, steps[1].y, '#fbbf24');
                    drawArrow(ctx, steps[1].x, steps[1].y + 30, steps[2].x, steps[2].y - 30, '#a78bfa');
                    drawArrow(ctx, steps[2].x + 60, steps[2].y, steps[3].x - 60, steps[3].y + 40, '#f472b6');
                    drawArrow(ctx, steps[3].x - 60, steps[3].y + 60, steps[4].x + 60, steps[4].y - 30, '#4ade80');
                    drawArrow(ctx, steps[4].x - 60, steps[4].y, steps[0].x + 60, steps[0].y + 40, '#22c55e');

                    document.getElementById('soapInfo').textContent =
                        `‚úÖ Flujo completo | SOAP + WSDL + XML`;
                    document.getElementById('soapResult').innerHTML =
                        `<i class="fas fa-building"></i> SOAP es <strong>obligatorio</strong> para integraciones con entidades gubernamentales en Ecuador`;
                    return;
                }

                const step = steps[currentStep];

                // Dibujar nodo
                ctx.fillStyle = step.color;
                ctx.beginPath();
                ctx.roundRect(step.x - 70, step.y - 25, 140, 50, 10);
                ctx.fill();

                ctx.strokeStyle = '#ffffff';
                ctx.lineWidth = 2;
                ctx.stroke();

                // Nombre
                ctx.fillStyle = '#ffffff';
                ctx.font = 'bold 12px Arial';
                ctx.textAlign = 'center';
                ctx.fillText(step.name, step.x, step.y - 5);

                // Descripci√≥n
                ctx.font = '10px Arial';
                ctx.fillText(step.desc, step.x, step.y + 12);

                currentStep++;

                document.getElementById('soapInfo').textContent =
                    `‚öôÔ∏è Paso ${currentStep}/${steps.length} | Construyendo flujo...`;
            }, 600);
        }
    </script>

    <!-- Slide 20: Comparaci√≥n -->
    <div class="slide">
        <h2><i class="fas fa-balance-scale"></i> Comparaci√≥n de Tecnolog√≠as</h2>
        <table>
            <thead>
                <tr>
                    <th>Tecnolog√≠a</th>
                    <th>Velocidad</th>
                    <th>Tama√±o</th>
                    <th>Complejidad</th>
                    <th>Interoperabilidad</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>gRPC/Protobuf</strong></td>
                    <td><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i
                            class="fas fa-star"></i><i class="fas fa-star"></i></td>
                    <td><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i
                            class="fas fa-star"></i><i class="fas fa-star"></i></td>
                    <td><i class="fas fa-star"></i><i class="fas fa-star"></i></td>
                    <td><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i></td>
                </tr>
                <tr>
                    <td><strong>HTTP/2</strong></td>
                    <td><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i
                            class="fas fa-star"></i></td>
                    <td><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i
                            class="fas fa-star"></i></td>
                    <td><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i></td>
                    <td><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i
                            class="fas fa-star"></i></td>
                </tr>
                <tr>
                    <td><strong>WebSockets</strong></td>
                    <td><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i
                            class="fas fa-star"></i></td>
                    <td><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i></td>
                    <td><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i></td>
                    <td><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i></td>
                </tr>
                <tr>
                    <td><strong>JSON</strong></td>
                    <td><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i></td>
                    <td><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i></td>
                    <td><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i
                            class="fas fa-star"></i><i class="fas fa-star"></i></td>
                    <td><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i
                            class="fas fa-star"></i><i class="fas fa-star"></i></td>
                </tr>
                <tr>
                    <td><strong>XML</strong></td>
                    <td><i class="fas fa-star"></i><i class="fas fa-star"></i></td>
                    <td><i class="fas fa-star"></i><i class="fas fa-star"></i></td>
                    <td><i class="fas fa-star"></i><i class="fas fa-star"></i></td>
                    <td><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i
                            class="fas fa-star"></i><i class="fas fa-star"></i></td>
                </tr>
            </tbody>
        </table>
    </div>

    <!-- Slide 21: Criterios de Selecci√≥n y Casos de Uso -->
    <div class="slide">
        <h2><i class="fas fa-check-circle"></i> Criterios de Selecci√≥n: Casos de Uso</h2>
        <div class="content-grid">
            <div class="feature-card">
                <h3><i class="fas fa-server"></i> Microsservicios Internos</h3>
                <p><strong>Recomendaci√≥n</strong>: gRPC + Protobuf</p>
                <p><strong>Raz√≥n</strong>: M√°ximo rendimiento, latencia cr√≠tica, control de dependencias</p>
            </div>
            <div class="feature-card">
                <h3><i class="fas fa-globe"></i> APIs P√∫blicas</h3>
                <p><strong>Recomendaci√≥n</strong>: JSON + HTTP/REST</p>
                <p><strong>Raz√≥n</strong>: Simplicidad, adopci√≥n masiva, desarrollo √°gil</p>
            </div>
            <div class="feature-card">
                <h3><i class="fas fa-clock"></i> Tiempo Real</h3>
                <p><strong>Recomendaci√≥n</strong>: WebSockets</p>
                <p><strong>Raz√≥n</strong>: Conexi√≥n persistente bidireccional, streaming eficiente</p>
            </div>
            <div class="feature-card">
                <h3><i class="fas fa-building"></i> Integraci√≥n Empresarial</h3>
                <p><strong>Recomendaci√≥n</strong>: XML</p>
                <p><strong>Raz√≥n</strong>: Est√°ndares establecidos, herramientas maduras, interoperabilidad</p>
            </div>
            <div class="feature-card">
                <h3><i class="fas fa-cogs"></i> Sistemas en Evoluci√≥n</h3>
                <p><strong>Recomendaci√≥n</strong>: Protobuf</p>
                <p><strong>Raz√≥n</strong>: Versionado sin ruptura, evoluci√≥n r√°pida</p>
            </div>
            <div class="feature-card">
                <h3><i class="fas fa-balance-scale"></i> Balance Eficiencia/Simplicidad</h3>
                <p><strong>Recomendaci√≥n</strong>: MessagePack</p>
                <p><strong>Raz√≥n</strong>: M√°s eficiente que JSON, m√°s simple que Protobuf</p>
            </div>
        </div>
    </div>

    <!-- Slide 22: Actividades -->
    <div class="slide">
        <h2><i class="fas fa-clipboard-check"></i> Actividades Calificadas - Semana 3</h2>
        <div class="content-grid">
            <div class="feature-card">
                <h3><i class="fas fa-poll"></i> Gesti√≥n de Aprendizaje</h3>
                <p style="color: var(--uide-accent); font-weight: 600; margin-bottom: 1rem;">GA-1.1 (1%)</p>
                <p><strong>Sondeo: ¬øcu√°ndo usar HTTP/2, WS, gRPC?</strong></p>
                <p style="margin-top: 1rem; font-size: 0.95rem;">Evaluaci√≥n diagn√≥stica sobre criterios de selecci√≥n
                    de protocolos</p>
            </div>
            <div class="feature-card">
                <h3><i class="fas fa-flask"></i> Pr√°ctico Experimental</h3>
                <p style="color: var(--uide-accent); font-weight: 600; margin-bottom: 1rem;">PE-1.3 (2.25%)</p>
                <p><strong>Lab: Servicio Eco Multi-formato</strong></p>
                <ul style="margin-top: 1rem; font-size: 0.95rem;">
                    <li>Servicio Node.js con JSON y Protobuf</li>
                    <li>Testing y comparaci√≥n de performance</li>
                </ul>
            </div>
            <div class="feature-card">
                <h3><i class="fas fa-file-alt"></i> Trabajo Aut√≥nomo</h3>
                <p style="color: var(--uide-accent); font-weight: 600; margin-bottom: 1rem;">TA-1.3 (2.25%)</p>
                <p><strong>Postman Collection + Script Cliente</strong></p>
                <ul style="margin-top: 1rem; font-size: 0.95rem;">
                    <li>Colecci√≥n con tests automatizados</li>
                    <li>Script consumiendo API p√∫blica</li>
                </ul>
            </div>
        </div>
    </div>

    <!-- Slide 23: S√≠ntesis y Reflexiones -->
    <div class="slide title-slide">
        <h1><i class="fas fa-lightbulb"></i> Arquitectura Banco de Loja: S√≠ntesis</h1>
        <div class="quote">
            "Sistema bancario moderno con integraci√≥n legacy - Un caso real ecuatoriano"
        </div>

        <div
            style="margin-top: 1.5rem; background: rgba(15, 20, 25, 0.6); border-radius: 12px; padding: 20px; border: 2px solid var(--uide-accent);">
            <h3 style="color: var(--uide-accent); margin-bottom: 1rem; text-align: center;">
                <i class="fas fa-sitemap"></i> Stack Tecnol√≥gico Completo
            </h3>

            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 1.5rem;">
                <div
                    style="background: rgba(96, 165, 250, 0.1); padding: 12px; border-radius: 8px; border-left: 4px solid #60a5fa;">
                    <h4 style="color: #60a5fa; margin-bottom: 8px; font-size: 0.95rem;">‚ñØ Capa de Presentaci√≥n</h4>
                    <p style="font-size: 0.85rem; margin: 0;">
                        <strong>HTTP/2 + JSON</strong><br>
                        App m√≥vil con multiplexaci√≥n<br>
                        <span style="color: #94a3b8;">Dashboard, transacciones, notificaciones</span>
                    </p>
                </div>

                <div
                    style="background: rgba(74, 222, 128, 0.1); padding: 12px; border-radius: 8px; border-left: 4px solid #4ade80;">
                    <h4 style="color: #4ade80; margin-bottom: 8px; font-size: 0.95rem;">‚ö° Tiempo Real</h4>
                    <p style="font-size: 0.85rem; margin: 0;">
                        <strong>WebSockets</strong><br>
                        Notificaciones y soporte en vivo<br>
                        <span style="color: #94a3b8;">Alertas de transacciones, chat</span>
                    </p>
                </div>

                <div
                    style="background: rgba(34, 197, 94, 0.1); padding: 12px; border-radius: 8px; border-left: 4px solid #22c55e;">
                    <h4 style="color: #22c55e; margin-bottom: 8px; font-size: 0.95rem;">‚ñ≤ Microsservicios</h4>
                    <p style="font-size: 0.85rem; margin: 0;">
                        <strong>gRPC + Protobuf</strong><br>
                        Comunicaci√≥n interna de alta velocidad<br>
                        <span style="color: #94a3b8;">Cuentas, transacciones, reportes</span>
                    </p>
                </div>

                <div
                    style="background: rgba(251, 191, 36, 0.1); padding: 12px; border-radius: 8px; border-left: 4px solid #fbbf24;">
                    <h4 style="color: #fbbf24; margin-bottom: 8px; font-size: 0.95rem;">‚ñ£ Cache y Colas</h4>
                    <p style="font-size: 0.85rem; margin: 0;">
                        <strong>MessagePack + Redis</strong><br>
                        Sesiones y transacciones pendientes<br>
                        <span style="color: #94a3b8;">Autenticaci√≥n r√°pida, queues</span>
                    </p>
                </div>
            </div>

            <div
                style="background: rgba(248, 113, 113, 0.1); padding: 12px; border-radius: 8px; border-left: 4px solid #f87171;">
                <h4 style="color: #f87171; margin-bottom: 8px; font-size: 0.95rem;">üèõÔ∏è Integraciones Legacy</h4>
                <p style="font-size: 0.85rem; margin: 0;">
                    <strong>SOAP + XML</strong><br>
                    SRI (facturas), IESS (aportes), BCE (tasas), Superintendencia (reportes)<br>
                    <span style="color: #94a3b8;">‚ö†Ô∏è Obligatorio por regulaci√≥n ecuatoriana</span>
                </p>
            </div>
        </div>

        <div style="margin-top: 1.5rem; background: rgba(233, 171, 33, 0.1); padding: 15px; border-radius: 10px;">
            <h3 style="color: var(--uide-accent); margin-bottom: 10px; text-align: center;">
                <i class="fas fa-check-circle"></i> Reglas de Oro
            </h3>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; font-size: 0.85rem;">
                <div>‚úÖ HTTP/2 para app m√≥vil</div>
                <div>‚úÖ WebSockets solo para notificaciones</div>
                <div>‚úÖ gRPC entre microsservicios</div>
                <div>‚úÖ JSON para APIs p√∫blicas</div>
                <div>‚ö†Ô∏è XML/SOAP cuando sea obligatorio</div>
                <div>‚ñ£ MessagePack para cache</div>
            </div>
        </div>

        <div style="margin-top: 1rem; text-align: center; font-style: italic; color: #e2e8f0; font-size: 0.95rem;">
            <i class="fas fa-graduation-cap"></i> Cada tecnolog√≠a tiene su lugar en una arquitectura moderna
        </div>
    </div>

    <!-- Slide 24: Referencias Bibliogr√°ficas -->
    <div class="slide">
        <h2><i class="fas fa-book"></i> Referencias Bibliogr√°ficas</h2>
        <div style="max-width: 1000px; margin: 0 auto;">
            <h3 style="margin-bottom: 1.5rem;">Bibliograf√≠a B√°sica</h3>
            <ul style="font-size: 1rem; line-height: 1.8; margin-bottom: 2rem;">
                <li><strong>Beynon-Davies, P. (2018).</strong> <em>Sistemas de Bases de Datos</em>. Editorial
                    Revert√©. <a href="https://www.proquest.com/books/sistemas-de-bases-datos/docview/2590135108/se-2"
                        style="color: var(--uide-accent);" target="_blank">Enlace</a></li>
            </ul>

            <h3 style="margin-bottom: 1.5rem;">Bibliograf√≠a Complementaria</h3>
            <ul style="font-size: 0.95rem; line-height: 1.7;">
                <li><strong>Tanenbaum, A. S., & Van Steen, M. (2023).</strong> <em>Distributed Systems: Principles
                        and Paradigms</em> (3rd ed.). Pearson. <a
                        href="https://alex-nguyen.github.io/vinhtngu/CSCourses/Spring2020/CS5352/Distributed_Systems_3-200225.pdf"
                        style="color: var(--uide-accent);" target="_blank">Enlace</a></li>
                <li><strong>Newman, S. (2021).</strong> <em>Building Microservices: Designing Fine-Grained
                        Systems</em> (2nd ed.). O'Reilly Media. <a
                        href="https://www.oreilly.com/library/view/building-microservices-2nd/9781492034018/"
                        style="color: var(--uide-accent);" target="_blank">Enlace</a></li>
                <li><strong>Kleppmann, M. (2023).</strong> <em>Designing Data-Intensive Applications: The Big Ideas
                        Behind Reliable, Scalable, and Maintainable Systems</em> (2nd ed.). O'Reilly Media. <a
                        href="https://www.oreilly.com/library/view/designing-data-intensive-applications/9781098119058/"
                        style="color: var(--uide-accent);" target="_blank">Enlace</a></li>
            </ul>

            <h3 style="margin-bottom: 1.5rem; margin-top: 2rem;">Fuente ASU</h3>
            <ul style="font-size: 0.95rem; line-height: 1.7;">
                <li><strong>Arizona State University. (2024).</strong> <em>CSE445 (Distributed Software
                        Development)</em>. Computer Science and Engineering Program. Online</li>
                <li><strong>Arizona State University. (2024).</strong> <em>Master Class: A Practitioner's Guide to
                        Generative AI</em> - April 2024</li>
            </ul>
        </div>
    </div>
    </div>

    <!-- Navigation Controls -->
    <div class="nav-controls">
        <button class="nav-btn" id="prevBtn"><i class="fas fa-chevron-left"></i></button>
        <button class="nav-btn" id="nextBtn"><i class="fas fa-chevron-right"></i></button>
    </div>

    <!-- Slide Counter -->
    <div class="slide-counter">
        <span id="currentSlide">1</span> / <span id="totalSlides">20</span>
    </div>

    <!-- Progress Bar -->
    <div class="progress-bar" id="progressBar"></div>

    <!-- External JavaScript -->
    <script src="js/grpc-limitations-demos.js"></script>
    <script src="presentacion.js"></script>

    <!-- JavaScript para Sistema de C√≥digo -->
    <script>
        // ===== INICIALIZACI√ìN DE PRISM.JS =====
        document.addEventListener('DOMContentLoaded', () => {
            // Inicializar Prism en todos los bloques de c√≥digo
            Prism.highlightAll();

            // ===== TABS DE C√ìDIGO =====
            const setupCodeTabs = () => {
                console.log('setupCodeTabs function called.');
                const tabContainers = document.querySelectorAll('.code-tabs-container');
                console.log('Found tab containers:', tabContainers.length);

                tabContainers.forEach(container => {
                    const tabButtons = container.querySelectorAll('.code-tab-btn');
                    const tabContents = container.querySelectorAll('.code-tab-content');
                    console.log('Container:', container, 'Buttons:', tabButtons.length, 'Contents:', tabContents.length);

                    tabButtons.forEach(button => {
                        button.addEventListener('click', () => {
                            const targetTab = button.getAttribute('data-tab');
                            console.log('Tab button clicked:', targetTab);

                            // Remover clase active de todos los botones y contenidos
                            tabButtons.forEach(btn => btn.classList.remove('active'));
                            tabContents.forEach(content => content.classList.remove('active'));

                            // Agregar clase active al bot√≥n clickeado
                            button.classList.add('active');

                            // Mostrar el contenido correspondiente
                            const targetContent = container.querySelector(`.code-tab-content[data-tab="${targetTab}"]`);
                            if (targetContent) {
                                targetContent.classList.add('active');
                                console.log('Activated tab content for:', targetTab);

                                // Re-highlight del c√≥digo cuando se muestra la tab
                                setTimeout(() => {
                                    const codeBlocks = targetContent.querySelectorAll('code[class*="language-"]');
                                    codeBlocks.forEach(block => {
                                        Prism.highlightElement(block);
                                    });
                                    console.log('Re-highlighted code for:', targetTab);
                                }, 10);
                            }
                        });
                    });
                });
            };

            // Inicializar tabs
            setupCodeTabs();

            // ===== BOTONES DE COPIAR C√ìDIGO =====
            const setupCopyButtons = () => {
                const copyButtons = document.querySelectorAll('.copy-code-btn');

                copyButtons.forEach(button => {
                    button.addEventListener('click', () => {
                        const codeContainer = button.closest('.code-container');
                        const codeBlock = codeContainer.querySelector('code');
                        const codeText = codeBlock.textContent;

                        // Copiar al portapapeles
                        navigator.clipboard.writeText(codeText).then(() => {
                            // Cambiar apariencia del bot√≥n
                            const originalHTML = button.innerHTML;
                            button.innerHTML = '<i class="fas fa-check"></i> Copiado!';
                            button.classList.add('copied');

                            // Restaurar despu√©s de 2 segundos
                            setTimeout(() => {
                                button.innerHTML = originalHTML;
                                button.classList.remove('copied');
                            }, 2000);
                        }).catch(err => {
                            console.error('Error al copiar:', err);
                            button.innerHTML = '<i class="fas fa-times"></i> Error';
                            setTimeout(() => {
                                button.innerHTML = '<i class="fas fa-copy"></i> Copiar';
                            }, 2000);
                        });
                    });
                });
            };

            // Inicializar botones de copiar
            setupCopyButtons();

            // ===== RE-HIGHLIGHT AL CAMBIAR DE SLIDE =====
            // Escuchar cambios de slide para re-highlight
            const observer = new MutationObserver((mutations) => {
                mutations.forEach((mutation) => {
                    if (mutation.type === 'attributes' && mutation.attributeName === 'class') {
                        const slide = mutation.target;
                        if (slide.classList.contains('active')) {
                            // Re-highlight c√≥digo en el slide activo
                            setTimeout(() => {
                                const codeBlocks = slide.querySelectorAll('code[class*="language-"]');
                                codeBlocks.forEach(block => {
                                    Prism.highlightElement(block);
                                });
                            }, 100);
                        }
                    }
                });
            });

            // Observar todos los slides
            const slides = document.querySelectorAll('.slide');
            slides.forEach(slide => {
                observer.observe(slide, {
                    attributes: true,
                    attributeFilter: ['class']
                });
            });

            // Highlight inicial del primer slide
            setTimeout(() => {
                Prism.highlightAll();
            }, 500);
        });
    </script>
</body>

</html>